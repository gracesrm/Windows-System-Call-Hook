#include "util.h"

VOID hook_ssdt_entries_7()
{
	disable_cr0();
	
	oldNtCreateThread = (NTCREATETHREAD)SYSTEMSERVICE(CREATETHREAD_7_INDEX); (NTCREATETHREAD)SYSTEMSERVICE(CREATETHREAD_7_INDEX) = newNtCreateThread;
	oldNtCreateThreadEx = (NTCREATETHREADEX)SYSTEMSERVICE(CREATETHREADEX_7_INDEX); (NTCREATETHREADEX)SYSTEMSERVICE(CREATETHREADEX_7_INDEX) = newNtCreateThreadEx;
	oldNtSetContextThread = (NTSETCONTEXTTHREAD)SYSTEMSERVICE(SETCONTEXTTHREAD_7_INDEX); (NTSETCONTEXTTHREAD)SYSTEMSERVICE(SETCONTEXTTHREAD_7_INDEX) = newNtSetContextThread;
	oldNtCreateProcess = (NTCREATEPROCESS)SYSTEMSERVICE(CREATEPROCESS_7_INDEX); (NTCREATEPROCESS)SYSTEMSERVICE(CREATEPROCESS_7_INDEX) = newNtCreateProcess;
	oldNtCreateProcessEx = (NTCREATEPROCESSEX)SYSTEMSERVICE(CREATEPROCESSEX_7_INDEX); (NTCREATEPROCESSEX)SYSTEMSERVICE(CREATEPROCESSEX_7_INDEX) = newNtCreateProcessEx;
	oldNtCreateUserProcess = (NTCREATEUSERPROCESS)SYSTEMSERVICE(CREATEUSERPROCESS_7_INDEX); (NTCREATEUSERPROCESS)SYSTEMSERVICE(CREATEUSERPROCESS_7_INDEX) = newNtCreateUserProcess;
	oldNtQueueApcThread = (NTQUEUEAPCTHREAD)SYSTEMSERVICE(QUEUEAPCTHREAD_7_INDEX); (NTQUEUEAPCTHREAD)SYSTEMSERVICE(QUEUEAPCTHREAD_7_INDEX) = newNtQueueApcThread;
	oldNtSystemDebugControl = (NTSYSTEMDEBUGCONTROL)SYSTEMSERVICE(SYSTEMDEBUGCONTROL_7_INDEX); (NTSYSTEMDEBUGCONTROL)SYSTEMSERVICE(SYSTEMDEBUGCONTROL_7_INDEX) = newNtSystemDebugControl;
	oldNtMapViewOfSection = (NTMAPVIEWOFSECTION)SYSTEMSERVICE(MAPVIEWOFSECTION_7_INDEX); (NTMAPVIEWOFSECTION)SYSTEMSERVICE(MAPVIEWOFSECTION_7_INDEX) = newNtMapViewOfSection;
	oldNtOpenProcess = (NTOPENPROCESS)SYSTEMSERVICE(OPENPROCESS_7_INDEX); (NTOPENPROCESS)SYSTEMSERVICE(OPENPROCESS_7_INDEX) = newNtOpenProcess;
	oldNtCreateProcess = (NTCREATEPROCESS)SYSTEMSERVICE(CREATEPROCESS_7_INDEX); (NTCREATEPROCESS)SYSTEMSERVICE(CREATEPROCESS_7_INDEX) = newNtCreateProcess;
	oldNtCreateProcessEx = (NTCREATEPROCESSEX)SYSTEMSERVICE(CREATEPROCESSEX_7_INDEX); (NTCREATEPROCESSEX)SYSTEMSERVICE(CREATEPROCESSEX_7_INDEX) = newNtCreateProcessEx;
	oldNtOpenThread = (NTOPENTHREAD)SYSTEMSERVICE(OPENTHREAD_7_INDEX); (NTOPENTHREAD)SYSTEMSERVICE(OPENTHREAD_7_INDEX) = newNtOpenThread;
	oldNtQuerySystemInformation = (NTQUERYSYSTEMINFORMATION)SYSTEMSERVICE(QUERYSYSTEMINFORMATION_7_INDEX); (NTQUERYSYSTEMINFORMATION)SYSTEMSERVICE(QUERYSYSTEMINFORMATION_7_INDEX) = newNtQuerySystemInformation;
	oldNtSetInformationFile = (NTSETINFORMATIONFILE)SYSTEMSERVICE(SETINFORMATIONFILE_7_INDEX); (NTSETINFORMATIONFILE)SYSTEMSERVICE(SETINFORMATIONFILE_7_INDEX) = newNtSetInformationFile;
	oldNtQueryInformationFile = (NTQUERYINFORMATIONFILE)SYSTEMSERVICE(QUERYINFORMATIONFILE_7_INDEX); (NTQUERYINFORMATIONFILE)SYSTEMSERVICE(QUERYINFORMATIONFILE_7_INDEX) = newNtQueryInformationFile;
	oldNtCreateMutant = (NTCREATEMUTANT)SYSTEMSERVICE(CREATEMUTANT_7_INDEX); (NTCREATEMUTANT)SYSTEMSERVICE(CREATEMUTANT_7_INDEX) = newNtCreateMutant;
	oldNtDeviceIoControlFile = (NTDEVICEIOCONTROLFILE)SYSTEMSERVICE(DEVICEIOCONTROLFILE_7_INDEX); (NTDEVICEIOCONTROLFILE)SYSTEMSERVICE(DEVICEIOCONTROLFILE_7_INDEX) = newNtDeviceIoControlFile;
	oldNtTerminateProcess = (NTTERMINATEPROCESS)SYSTEMSERVICE(TERMINATEPROCESS_7_INDEX); (NTTERMINATEPROCESS)SYSTEMSERVICE(TERMINATEPROCESS_7_INDEX) = newNtTerminateProcess;
	oldNtDelayExecution = (NTDELAYEXECUTION)SYSTEMSERVICE(DELAYEXECUTION_7_INDEX); (NTDELAYEXECUTION)SYSTEMSERVICE(DELAYEXECUTION_7_INDEX) = newNtDelayExecution;
	oldNtQueryValueKey = (NTQUERYVALUEKEY)SYSTEMSERVICE(QUERYVALUEKEY_7_INDEX); (NTQUERYVALUEKEY)SYSTEMSERVICE(QUERYVALUEKEY_7_INDEX) = newNtQueryValueKey;
	oldNtQueryAttributesFile = (NTQUERYATTRIBUTESFILE)SYSTEMSERVICE(QUERYATTRIBUTESFILE_7_INDEX); (NTQUERYATTRIBUTESFILE)SYSTEMSERVICE(QUERYATTRIBUTESFILE_7_INDEX) = newNtQueryAttributesFile;
	oldNtResumeThread = (NTRESUMETHREAD)SYSTEMSERVICE(RESUMETHREAD_7_INDEX); (NTRESUMETHREAD)SYSTEMSERVICE(RESUMETHREAD_7_INDEX) = newNtResumeThread;
	oldNtCreateSection = (NTCREATESECTION)SYSTEMSERVICE(CREATESECTION_7_INDEX); (NTCREATESECTION)SYSTEMSERVICE(CREATESECTION_7_INDEX) = newNtCreateSection;
	oldNtLoadDriver = (NTLOADDRIVER)SYSTEMSERVICE(LOADDRIVER_7_INDEX); (NTLOADDRIVER)SYSTEMSERVICE(LOADDRIVER_7_INDEX) = newNtLoadDriver; 
	oldNtNotifyChangeMultipleKeys = (NTNOTIFYCHANGEMULTIPLEKEYS)SYSTEMSERVICE(NOTIFYCHANGEMULTIPLEKEYS_7_INDEX); (NTNOTIFYCHANGEMULTIPLEKEYS)SYSTEMSERVICE(NOTIFYCHANGEMULTIPLEKEYS_7_INDEX) = newNtNotifyChangeMultipleKeys;
	oldNtQueryMultipleValueKey = (NTQUERYMULTIPLEVALUEKEY)SYSTEMSERVICE(QUERYMULTIPLEVALUEKEY_7_INDEX); (NTQUERYMULTIPLEVALUEKEY)SYSTEMSERVICE(QUERYMULTIPLEVALUEKEY_7_INDEX) = newNtQueryMultipleValueKey;
	oldNtQueryObject = (NTQUERYOBJECT)SYSTEMSERVICE(QUERYOBJECT_7_INDEX); (NTQUERYOBJECT)SYSTEMSERVICE(QUERYOBJECT_7_INDEX) = newNtQueryObject;
	oldNtRenameKey = (NTRENAMEKEY)SYSTEMSERVICE(RENAMEKEY_7_INDEX); (NTRENAMEKEY)SYSTEMSERVICE(RENAMEKEY_7_INDEX) = newNtRenameKey;
	oldNtSetInformationKey = (NTSETINFORMATIONKEY)SYSTEMSERVICE(SETINFORMATIONKEY_7_INDEX); (NTSETINFORMATIONKEY)SYSTEMSERVICE(SETINFORMATIONKEY_7_INDEX) = newNtSetInformationKey;
	oldNtAllocateLocallyUniqueId = (NTALLOCATELOCALLYUNIQUEID)SYSTEMSERVICE(ALLOCATELOCALLYUNIQUEID_7_INDEX); (NTALLOCATELOCALLYUNIQUEID)SYSTEMSERVICE(ALLOCATELOCALLYUNIQUEID_7_INDEX) = newNtAllocateLocallyUniqueId;
	oldNtCreateDirectoryObject = (NTCREATEDIRECTORYOBJECT)SYSTEMSERVICE(CREATEDIRECTORYOBJECT_7_INDEX); (NTCREATEDIRECTORYOBJECT)SYSTEMSERVICE(CREATEDIRECTORYOBJECT_7_INDEX) = newNtCreateDirectoryObject;
	oldNtCreateKey = (NTCREATEKEY)SYSTEMSERVICE(CREATEKEY_7_INDEX); (NTCREATEKEY)SYSTEMSERVICE(CREATEKEY_7_INDEX) = newNtCreateKey;
	oldNtCreateKeyTransacted = (NTCREATEKEYTRANSACTED)SYSTEMSERVICE(CREATEKEYTRANSACTED_7_INDEX); (NTCREATEKEYTRANSACTED)SYSTEMSERVICE(CREATEKEYTRANSACTED_7_INDEX) = newNtCreateKeyTransacted;
	oldNtSetQuotaInformationFile = (NTSETQUOTAINFORMATIONFILE)SYSTEMSERVICE(SETQUOTAINFORMATIONFILE_7_INDEX); (NTSETQUOTAINFORMATIONFILE)SYSTEMSERVICE(SETQUOTAINFORMATIONFILE_7_INDEX) = newNtSetQuotaInformationFile;
	oldNtSetSecurityObject = (NTSETSECURITYOBJECT)SYSTEMSERVICE(SETSECURITYOBJECT_7_INDEX); (NTSETSECURITYOBJECT)SYSTEMSERVICE(SETSECURITYOBJECT_7_INDEX) = newNtSetSecurityObject;
	oldNtSetValueKey = (NTSETVALUEKEY)SYSTEMSERVICE(SETVALUEKEY_7_INDEX); (NTSETVALUEKEY)SYSTEMSERVICE(SETVALUEKEY_7_INDEX) = newNtSetValueKey;
	oldNtSetVolumeInformationFile = (NTSETVOLUMEINFORMATIONFILE)SYSTEMSERVICE(SETVOLUMEINFORMATIONFILE_7_INDEX); (NTSETVOLUMEINFORMATIONFILE)SYSTEMSERVICE(SETVOLUMEINFORMATIONFILE_7_INDEX) = newNtSetVolumeInformationFile;
	oldNtUnloadDriver = (NTUNLOADDRIVER)SYSTEMSERVICE(UNLOADDRIVER_7_INDEX); (NTUNLOADDRIVER)SYSTEMSERVICE(UNLOADDRIVER_7_INDEX) = newNtUnloadDriver;
	oldNtUnlockFile = (NTUNLOCKFILE)SYSTEMSERVICE(UNLOCKFILE_7_INDEX); (NTUNLOCKFILE)SYSTEMSERVICE(UNLOCKFILE_7_INDEX) = newNtUnlockFile;
	oldNtUnmapViewOfSection = (NTUNMAPVIEWOFSECTION)SYSTEMSERVICE(UNMAPVIEWOFSECTION_7_INDEX); (NTUNMAPVIEWOFSECTION)SYSTEMSERVICE(UNMAPVIEWOFSECTION_7_INDEX) = newNtUnmapViewOfSection;
	oldNtWaitForSingleObject = (NTWAITFORSINGLEOBJECT)SYSTEMSERVICE(WAITFORSINGLEOBJECT_7_INDEX); (NTWAITFORSINGLEOBJECT)SYSTEMSERVICE(WAITFORSINGLEOBJECT_7_INDEX) = newNtWaitForSingleObject;
	oldNtFlushInstructionCache = (NTFLUSHINSTRUCTIONCACHE)SYSTEMSERVICE(FLUSHINSTRUCTIONCACHE_7_INDEX); (NTFLUSHINSTRUCTIONCACHE)SYSTEMSERVICE(FLUSHINSTRUCTIONCACHE_7_INDEX) = newNtFlushInstructionCache;
	oldNtQueryInformationProcess = (NTQUERYINFORMATIONPROCESS)SYSTEMSERVICE(QUERYINFORMATIONPROCESS_7_INDEX); (NTQUERYINFORMATIONPROCESS)SYSTEMSERVICE(QUERYINFORMATIONPROCESS_7_INDEX) = newNtQueryInformationProcess;
	oldNtSetInformationProcess = (NTSETINFORMATIONPROCESS)SYSTEMSERVICE(SETINFORMATIONPROCESS_7_INDEX); (NTSETINFORMATIONPROCESS)SYSTEMSERVICE(SETINFORMATIONPROCESS_7_INDEX) = newNtSetInformationProcess;
 	oldNtAlertThread = (NTALERTTHREAD)SYSTEMSERVICE(ALERTTHREAD_7_INDEX); (NTALERTTHREAD)SYSTEMSERVICE(ALERTTHREAD_7_INDEX) = newNtAlertThread;
	oldNtCallbackReturn = (NTCALLBACKRETURN)SYSTEMSERVICE(CALLBACKRETURN_7_INDEX); (NTCALLBACKRETURN)SYSTEMSERVICE(CALLBACKRETURN_7_INDEX) = newNtCallbackReturn;	
	oldNtGetContextThread = (NTGETCONTEXTTHREAD)SYSTEMSERVICE(GETCONTEXTTHREAD_7_INDEX); (NTGETCONTEXTTHREAD)SYSTEMSERVICE(GETCONTEXTTHREAD_7_INDEX) = newNtGetContextThread;	
	oldNtAlertResumeThread = (NTALERTRESUMETHREAD)SYSTEMSERVICE(ALERTRESUMETHREAD_7_INDEX); (NTALERTRESUMETHREAD)SYSTEMSERVICE(ALERTRESUMETHREAD_7_INDEX) = newNtAlertResumeThread;
	oldNtContinue = (NTCONTINUE)SYSTEMSERVICE(CONTINUE_7_INDEX); (NTCONTINUE)SYSTEMSERVICE(CONTINUE_7_INDEX) = newNtContinue;
	oldNtImpersonateThread = (NTIMPERSONATETHREAD)SYSTEMSERVICE(IMPERSONATETHREAD_7_INDEX); (NTIMPERSONATETHREAD)SYSTEMSERVICE(IMPERSONATETHREAD_7_INDEX) = newNtImpersonateThread;
	oldNtRegisterThreadTerminatePort = (NTREGISTERTHREADTERMINATEPORT)SYSTEMSERVICE(REGISTERTHREADTERMINATEPORT_7_INDEX); (NTREGISTERTHREADTERMINATEPORT)SYSTEMSERVICE(REGISTERTHREADTERMINATEPORT_7_INDEX) = newNtRegisterThreadTerminatePort;	
	oldNtSuspendThread = (NTSUSPENDTHREAD)SYSTEMSERVICE(SUSPENDTHREAD_7_INDEX); (NTSUSPENDTHREAD)SYSTEMSERVICE(SUSPENDTHREAD_7_INDEX) = newNtSuspendThread;	
	oldNtTerminateThread = (NTTERMINATETHREAD)SYSTEMSERVICE(TERMINATETHREAD_7_INDEX); (NTTERMINATETHREAD)SYSTEMSERVICE(TERMINATETHREAD_7_INDEX) = newNtTerminateThread;	
	oldNtOpenMutant = (NTOPENMUTANT)SYSTEMSERVICE(OPENMUTANT_7_INDEX); (NTOPENMUTANT)SYSTEMSERVICE(OPENMUTANT_7_INDEX) = newNtOpenMutant;	
	oldNtQueryMutant = (NTQUERYMUTANT)SYSTEMSERVICE(QUERYMUTANT_7_INDEX); (NTQUERYMUTANT)SYSTEMSERVICE(QUERYMUTANT_7_INDEX) = newNtQueryMutant;	
	oldNtReleaseMutant = (NTRELEASEMUTANT)SYSTEMSERVICE(RELEASEMUTANT_7_INDEX); (NTRELEASEMUTANT)SYSTEMSERVICE(RELEASEMUTANT_7_INDEX) = newNtReleaseMutant;	
	oldNtSetTimerResolution = (NTSETTIMERRESOLUTION)SYSTEMSERVICE(SETTIMERRESOLUTION_7_INDEX); (NTSETTIMERRESOLUTION)SYSTEMSERVICE(SETTIMERRESOLUTION_7_INDEX) = newNtSetTimerResolution;	
	oldNtSetSystemTime = (NTSETSYSTEMTIME)SYSTEMSERVICE(SETSYSTEMTIME_7_INDEX); (NTSETSYSTEMTIME)SYSTEMSERVICE(SETSYSTEMTIME_7_INDEX) = newNtSetSystemTime;	
	oldNtQueryTimerResolution = (NTQUERYTIMERRESOLUTION)SYSTEMSERVICE(QUERYTIMERRESOLUTION_7_INDEX); (NTQUERYTIMERRESOLUTION)SYSTEMSERVICE(QUERYTIMERRESOLUTION_7_INDEX) = newNtQueryTimerResolution;	
	oldNtQuerySystemTime = (NTQUERYSYSTEMTIME)SYSTEMSERVICE(QUERYSYSTEMTIME_7_INDEX); (NTQUERYSYSTEMTIME)SYSTEMSERVICE(QUERYSYSTEMTIME_7_INDEX) = newNtQuerySystemTime;
	oldNtQueryPerformanceCounter = (NTQUERYPERFORMANCECOUNTER)SYSTEMSERVICE(QUERYPERFORMANCECOUNTER_7_INDEX); (NTQUERYPERFORMANCECOUNTER)SYSTEMSERVICE(QUERYPERFORMANCECOUNTER_7_INDEX) = newNtQueryPerformanceCounter;
	oldNtLockFile = (NTLOCKFILE)SYSTEMSERVICE(LOCKFILE_7_INDEX); (NTLOCKFILE)SYSTEMSERVICE(LOCKFILE_7_INDEX) = newNtLockFile;
	oldNtOpenEvent = (NTOPENEVENT)SYSTEMSERVICE(OPENEVENT_7_INDEX); (NTOPENEVENT)SYSTEMSERVICE(OPENEVENT_7_INDEX) = newNtOpenEvent;
	oldNtQueryInformationThread = (NTQUERYINFORMATIONTHREAD)SYSTEMSERVICE(QUERYINFORMATIONTHREAD_7_INDEX); (NTQUERYINFORMATIONTHREAD)SYSTEMSERVICE(QUERYINFORMATIONTHREAD_7_INDEX) = newNtQueryInformationThread;             
	oldNtQueryDirectoryFile = (NTQUERYDIRECTORYFILE)SYSTEMSERVICE(QUERYDIRECTORYFILE_7_INDEX); (NTQUERYDIRECTORYFILE)SYSTEMSERVICE(QUERYDIRECTORYFILE_7_INDEX) = newNtQueryDirectoryFile;              
	oldNtQueryEaFile = (NTQUERYEAFILE)SYSTEMSERVICE(QUERYEAFILE_7_INDEX); (NTQUERYEAFILE)SYSTEMSERVICE(QUERYEAFILE_7_INDEX) = newNtQueryEaFile;             
	oldNtSetInformationThread = (NTSETINFORMATIONTHREAD)SYSTEMSERVICE(SETINFORMATIONTHREAD_7_INDEX); (NTSETINFORMATIONTHREAD)SYSTEMSERVICE(SETINFORMATIONTHREAD_7_INDEX) = newNtSetInformationThread;
    oldNtAccessCheckByTypeAndAuditAlarm = (NTACCESSCHECKBYTYPEANDAUDITALARM)SYSTEMSERVICE(ACCESSCHECKBYTYPEANDAUDITALARM_7_INDEX); (NTACCESSCHECKBYTYPEANDAUDITALARM)SYSTEMSERVICE(ACCESSCHECKBYTYPEANDAUDITALARM_7_INDEX) = newNtAccessCheckByTypeAndAuditAlarm;
	oldNtCreateEvent = (NTCREATEEVENT)SYSTEMSERVICE(CREATEEVENT_7_INDEX); (NTCREATEEVENT)SYSTEMSERVICE(CREATEEVENT_7_INDEX) = newNtCreateEvent;
	oldNtFlushVirtualMemory = (NTFLUSHVIRTUALMEMORY)SYSTEMSERVICE(FLUSHVIRTUALMEMORY_7_INDEX); (NTFLUSHVIRTUALMEMORY)SYSTEMSERVICE(FLUSHVIRTUALMEMORY_7_INDEX) = newNtFlushVirtualMemory;
	oldNtFreeVirtualMemory = (NTFREEVIRTUALMEMORY)SYSTEMSERVICE(FREEVIRTUALMEMORY_7_INDEX); (NTFREEVIRTUALMEMORY)SYSTEMSERVICE(FREEVIRTUALMEMORY_7_INDEX) = newNtFreeVirtualMemory;
	oldNtLockVirtualMemory = (NTLOCKVIRTUALMEMORY)SYSTEMSERVICE(LOCKVIRTUALMEMORY_7_INDEX); (NTLOCKVIRTUALMEMORY)SYSTEMSERVICE(LOCKVIRTUALMEMORY_7_INDEX) = newNtLockVirtualMemory;
	oldNtProtectVirtualMemory = (NTPROTECTVIRTUALMEMORY)SYSTEMSERVICE(PROTECTVIRTUALMEMORY_7_INDEX); (NTPROTECTVIRTUALMEMORY)SYSTEMSERVICE(PROTECTVIRTUALMEMORY_7_INDEX) = newNtProtectVirtualMemory;
	oldNtUnlockVirtualMemory = (NTUNLOCKVIRTUALMEMORY)SYSTEMSERVICE(UNLOCKVIRTUALMEMORY_7_INDEX); (NTUNLOCKVIRTUALMEMORY)SYSTEMSERVICE(UNLOCKVIRTUALMEMORY_7_INDEX) = newNtUnlockVirtualMemory;
	oldNtReadVirtualMemory = (NTREADVIRTUALMEMORY)SYSTEMSERVICE(READVIRTUALMEMORY_7_INDEX); (NTREADVIRTUALMEMORY)SYSTEMSERVICE(READVIRTUALMEMORY_7_INDEX) = newNtReadVirtualMemory;
	oldNtWriteVirtualMemory = (NTWRITEVIRTUALMEMORY)SYSTEMSERVICE(WRITEVIRTUALMEMORY_7_INDEX); (NTWRITEVIRTUALMEMORY)SYSTEMSERVICE(WRITEVIRTUALMEMORY_7_INDEX) = newNtWriteVirtualMemory;
	oldNtCreateFile = (NTCREATEFILE)SYSTEMSERVICE(CREATEFILE_7_INDEX); (NTCREATEFILE)SYSTEMSERVICE(CREATEFILE_7_INDEX) = newNtCreateFile;
	oldNtOpenFile = (NTOPENFILE)SYSTEMSERVICE(OPENFILE_7_INDEX); (NTOPENFILE)SYSTEMSERVICE(OPENFILE_7_INDEX) = newNtOpenFile;
	oldNtReadFile = (NTREADFILE)SYSTEMSERVICE(READFILE_7_INDEX); (NTREADFILE)SYSTEMSERVICE(READFILE_7_INDEX) = newNtReadFile;
	oldNtDeleteFile = (NTDELETEFILE)SYSTEMSERVICE(DELETEFILE_7_INDEX); (NTDELETEFILE)SYSTEMSERVICE(DELETEFILE_7_INDEX) = newNtDeleteFile;
	oldNtClose = (NTCLOSE)SYSTEMSERVICE(CLOSE_7_INDEX); (NTCLOSE)SYSTEMSERVICE(CLOSE_7_INDEX) = newNtClose;
	/*oldNtWriteRequestData = (NTWRITEREQUESTDATA)SYSTEMSERVICE(WRITEREQUESTDATA_7_INDEX); (NTWRITEREQUESTDATA)SYSTEMSERVICE(WRITEREQUESTDATA_7_INDEX) = newNtWriteRequestData;
	oldNtCreatePort = (NTCREATEPORT)SYSTEMSERVICE(CREATEPORT_7_INDEX); (NTCREATEPORT)SYSTEMSERVICE(CREATEPORT_7_INDEX) = newNtCreatePort;
	oldNtImpersonateClientOfPort = (NTIMPERSONATECLIENTOFPORT)SYSTEMSERVICE(IMPERSONATECLIENTOFPORT_7_INDEX); (NTIMPERSONATECLIENTOFPORT)SYSTEMSERVICE(IMPERSONATECLIENTOFPORT_7_INDEX) = newNtImpersonateClientOfPort;
	oldNtListenPort = (NTLISTENPORT)SYSTEMSERVICE(LISTENPORT_7_INDEX); (NTLISTENPORT)SYSTEMSERVICE(LISTENPORT_7_INDEX) = newNtListenPort;
	oldNtQueryInformationPort = (NTQUERYINFORMATIONPORT)SYSTEMSERVICE(QUERYINFORMATIONPORT_7_INDEX); (NTQUERYINFORMATIONPORT)SYSTEMSERVICE(QUERYINFORMATIONPORT_7_INDEX) = newNtQueryInformationPort;
	oldNtRequestPort = (NTREQUESTPORT)SYSTEMSERVICE(REQUESTPORT_7_INDEX); (NTREQUESTPORT)SYSTEMSERVICE(REQUESTPORT_7_INDEX) = newNtRequestPort;
	oldNtAlpcAcceptConnectPort = (NTALPCACCEPTCONNECTPORT)SYSTEMSERVICE(ALPCACCEPTCONNECTPORT_7_INDEX); (NTALPCACCEPTCONNECTPORT)SYSTEMSERVICE(ALPCACCEPTCONNECTPORT_7_INDEX) = newNtAlpcAcceptConnectPort;
	oldNtAlpcConnectPort = (NTALPCCONNECTPORT)SYSTEMSERVICE(ALPCCONNECTPORT_7_INDEX); (NTALPCCONNECTPORT)SYSTEMSERVICE(ALPCCONNECTPORT_7_INDEX) = newNtAlpcConnectPort;
	oldNtAlpcDisconnectPort = (NTALPCDISCONNECTPORT)SYSTEMSERVICE(ALPCDISCONNECTPORT_7_INDEX); (NTALPCDISCONNECTPORT)SYSTEMSERVICE(ALPCDISCONNECTPORT_7_INDEX) = newNtAlpcDisconnectPort;
	oldNtAlpcCreatePort = (NTALPCCREATEPORT)SYSTEMSERVICE(ALPCCREATEPORT_7_INDEX); (NTALPCCREATEPORT)SYSTEMSERVICE(ALPCCREATEPORT_7_INDEX) = newNtAlpcCreatePort;
	oldNtAlpcCreatePortSection = (NTALPCCREATEPORTSECTION)SYSTEMSERVICE(ALPCCREATEPORTSECTION_7_INDEX); (NTALPCCREATEPORTSECTION)SYSTEMSERVICE(ALPCCREATEPORTSECTION_7_INDEX) = newNtAlpcCreatePortSection;
	oldNtAlpcDeleteResourceReserve = (NTALPCDELETERESOURCERESERVE)SYSTEMSERVICE(ALPCDELETERESOURCERESERVE_7_INDEX); (NTALPCDELETERESOURCERESERVE)SYSTEMSERVICE(ALPCDELETERESOURCERESERVE_7_INDEX) = newNtAlpcDeleteResourceReserve;
	oldNtReplyWaitReceivePortEx = (NTREPLYWAITRECEIVEPORTEX)SYSTEMSERVICE(REPLYWAITRECEIVEPORTEX_7_INDEX); (NTREPLYWAITRECEIVEPORTEX)SYSTEMSERVICE(REPLYWAITRECEIVEPORTEX_7_INDEX) = newNtReplyWaitReceivePortEx;
	oldNtPrivilegeCheck = (NTPRIVILEGECHECK)SYSTEMSERVICE(PRIVILEGECHECK_7_INDEX); (NTPRIVILEGECHECK)SYSTEMSERVICE(PRIVILEGECHECK_7_INDEX) = newNtPrivilegeCheck;
	oldNtAlpcOpenSenderProcess = (NTALPCOPENSENDERPROCESS)SYSTEMSERVICE(ALPCOPENSENDERPROCESS_7_INDEX); (NTALPCOPENSENDERPROCESS)SYSTEMSERVICE(ALPCOPENSENDERPROCESS_7_INDEX) = newNtAlpcOpenSenderProcess;
	oldNtAlpcQueryInformation = (NTALPCQUERYINFORMATION)SYSTEMSERVICE(ALPCQUERYINFORMATION_7_INDEX); (NTALPCQUERYINFORMATION)SYSTEMSERVICE(ALPCQUERYINFORMATION_7_INDEX) = newNtAlpcQueryInformation;
	oldNtAreMappedFilesTheSame = (NTAREMAPPEDFILESTHESAME)SYSTEMSERVICE(AREMAPPEDFILESTHESAME_7_INDEX); (NTAREMAPPEDFILESTHESAME)SYSTEMSERVICE(AREMAPPEDFILESTHESAME_7_INDEX) = newNtAreMappedFilesTheSame;
	oldNtAssignProcessToJobObject = (NTASSIGNPROCESSTOJOBOBJECT)SYSTEMSERVICE(ASSIGNPROCESSTOJOBOBJECT_7_INDEX); (NTASSIGNPROCESSTOJOBOBJECT)SYSTEMSERVICE(ASSIGNPROCESSTOJOBOBJECT_7_INDEX) = newNtAssignProcessToJobObject;
	oldNtCancelSynchronousIoFile = (NTCANCELSYNCHRONOUSIOFILE)SYSTEMSERVICE(CANCELSYNCHRONOUSIOFILE_7_INDEX); (NTCANCELSYNCHRONOUSIOFILE)SYSTEMSERVICE(CANCELSYNCHRONOUSIOFILE_7_INDEX) = newNtCancelSynchronousIoFile;
	oldNtCompressKey = (NTCOMPRESSKEY)SYSTEMSERVICE(COMPRESSKEY_7_INDEX); (NTCOMPRESSKEY)SYSTEMSERVICE(COMPRESSKEY_7_INDEX) = newNtCompressKey;
	oldNtCreateEventPair = (NTCREATEEVENTPAIR)SYSTEMSERVICE(CREATEEVENTPAIR_7_INDEX); (NTCREATEEVENTPAIR)SYSTEMSERVICE(CREATEEVENTPAIR_7_INDEX) = newNtCreateEventPair;
	oldNtCreateKeyedEvent = (NTCREATEKEYEDEVENT)SYSTEMSERVICE(CREATEKEYEDEVENT_7_INDEX); (NTCREATEKEYEDEVENT)SYSTEMSERVICE(CREATEKEYEDEVENT_7_INDEX) = newNtCreateKeyedEvent;
	oldNtCreateProfile = (NTCREATEPROFILE)SYSTEMSERVICE(CREATEPROFILE_7_INDEX); (NTCREATEPROFILE)SYSTEMSERVICE(CREATEPROFILE_7_INDEX) = newNtCreateProfile;
	oldNtCreateSemaphore = (NTCREATESEMAPHORE)SYSTEMSERVICE(CREATESEMAPHORE_7_INDEX); (NTCREATESEMAPHORE)SYSTEMSERVICE(CREATESEMAPHORE_7_INDEX) = newNtCreateSemaphore;
	oldNtCreateSymbolicLinkObject = (NTCREATESYMBOLICLINKOBJECT)SYSTEMSERVICE(CREATESYMBOLICLINKOBJECT_7_INDEX); (NTCREATESYMBOLICLINKOBJECT)SYSTEMSERVICE(CREATESYMBOLICLINKOBJECT_7_INDEX) = newNtCreateSymbolicLinkObject;
	oldNtCreateTransactionManager = (NTCREATETRANSACTIONMANAGER)SYSTEMSERVICE(CREATETRANSACTIONMANAGER_7_INDEX); (NTCREATETRANSACTIONMANAGER)SYSTEMSERVICE(CREATETRANSACTIONMANAGER_7_INDEX) = newNtCreateTransactionManager;
	oldNtDebugContinue = (NTDEBUGCONTINUE)SYSTEMSERVICE(DEBUGCONTINUE_7_INDEX); (NTDEBUGCONTINUE)SYSTEMSERVICE(DEBUGCONTINUE_7_INDEX) = newNtDebugContinue;
	oldNtDeletePrivateNamespace = (NTDELETEPRIVATENAMESPACE)SYSTEMSERVICE(DELETEPRIVATENAMESPACE_7_INDEX); (NTDELETEPRIVATENAMESPACE)SYSTEMSERVICE(DELETEPRIVATENAMESPACE_7_INDEX) = newNtDeletePrivateNamespace;
	oldNtDisableLastKnownGood = (NTDISABLELASTKNOWNGOOD)SYSTEMSERVICE(DISABLELASTKNOWNGOOD_7_INDEX); (NTDISABLELASTKNOWNGOOD)SYSTEMSERVICE(DISABLELASTKNOWNGOOD_7_INDEX) = newNtDisableLastKnownGood;
	oldNtDisplayString = (NTDISPLAYSTRING)SYSTEMSERVICE(DISPLAYSTRING_7_INDEX); (NTDISPLAYSTRING)SYSTEMSERVICE(DISPLAYSTRING_7_INDEX) = newNtDisplayString;
	oldNtDrawText = (NTDRAWTEXT)SYSTEMSERVICE(DRAWTEXT_7_INDEX); (NTDRAWTEXT)SYSTEMSERVICE(DRAWTEXT_7_INDEX) = newNtDrawText;
	oldNtEnumerateDriverEntries = (NTENUMERATEDRIVERENTRIES)SYSTEMSERVICE(ENUMERATEDRIVERENTRIES_7_INDEX); (NTENUMERATEDRIVERENTRIES)SYSTEMSERVICE(ENUMERATEDRIVERENTRIES_7_INDEX) = newNtEnumerateDriverEntries;
	oldNtEnumerateTransactionObject = (NTENUMERATETRANSACTIONOBJECT)SYSTEMSERVICE(ENUMERATETRANSACTIONOBJECT_7_INDEX); (NTENUMERATETRANSACTIONOBJECT)SYSTEMSERVICE(ENUMERATETRANSACTIONOBJECT_7_INDEX) = newNtEnumerateTransactionObject;
	oldNtGetCurrentProcessorNumber = (NTGETCURRENTPROCESSORNUMBER)SYSTEMSERVICE(GETCURRENTPROCESSORNUMBER_7_INDEX); (NTGETCURRENTPROCESSORNUMBER)SYSTEMSERVICE(GETCURRENTPROCESSORNUMBER_7_INDEX) = newNtGetCurrentProcessorNumber;
	oldNtGetNlsSectionPtr = (NTGETNLSSECTIONPTR)SYSTEMSERVICE(GETNLSSECTIONPTR_7_INDEX); (NTGETNLSSECTIONPTR)SYSTEMSERVICE(GETNLSSECTIONPTR_7_INDEX) = newNtGetNlsSectionPtr;
	oldNtGetPlugPlayEvent = (NTGETPLUGPLAYEVENT)SYSTEMSERVICE(GETPLUGPLAYEVENT_7_INDEX); (NTGETPLUGPLAYEVENT)SYSTEMSERVICE(GETPLUGPLAYEVENT_7_INDEX) = newNtGetPlugPlayEvent;
	oldNtGetWriteWatch = (NTGETWRITEWATCH)SYSTEMSERVICE(GETWRITEWATCH_7_INDEX); (NTGETWRITEWATCH)SYSTEMSERVICE(GETWRITEWATCH_7_INDEX) = newNtGetWriteWatch;
	oldNtImpersonateAnonymousToken = (NTIMPERSONATEANONYMOUSTOKEN)SYSTEMSERVICE(IMPERSONATEANONYMOUSTOKEN_7_INDEX); (NTIMPERSONATEANONYMOUSTOKEN)SYSTEMSERVICE(IMPERSONATEANONYMOUSTOKEN_7_INDEX) = newNtImpersonateAnonymousToken;
	oldNtInitiatePowerAction = (NTINITIATEPOWERACTION)SYSTEMSERVICE(INITIATEPOWERACTION_7_INDEX); (NTINITIATEPOWERACTION)SYSTEMSERVICE(INITIATEPOWERACTION_7_INDEX) = newNtInitiatePowerAction;
	oldNtIsProcessInJob = (NTISPROCESSINJOB)SYSTEMSERVICE(ISPROCESSINJOB_7_INDEX); (NTISPROCESSINJOB)SYSTEMSERVICE(ISPROCESSINJOB_7_INDEX) = newNtIsProcessInJob;
	oldNtIsSystemResumeAutomatic = (NTISSYSTEMRESUMEAUTOMATIC)SYSTEMSERVICE(ISSYSTEMRESUMEAUTOMATIC_7_INDEX); (NTISSYSTEMRESUMEAUTOMATIC)SYSTEMSERVICE(ISSYSTEMRESUMEAUTOMATIC_7_INDEX) = newNtIsSystemResumeAutomatic;
	oldNtLoadKey = (NTLOADKEY)SYSTEMSERVICE(LOADKEY_7_INDEX); (NTLOADKEY)SYSTEMSERVICE(LOADKEY_7_INDEX) = newNtLoadKey;
	oldNtLoadKey2 = (NTLOADKEY2)SYSTEMSERVICE(LOADKEY2_7_INDEX); (NTLOADKEY2)SYSTEMSERVICE(LOADKEY2_7_INDEX) = newNtLoadKey2;
	oldNtMakeTemporaryObject = (NTMAKETEMPORARYOBJECT)SYSTEMSERVICE(MAKETEMPORARYOBJECT_7_INDEX); (NTMAKETEMPORARYOBJECT)SYSTEMSERVICE(MAKETEMPORARYOBJECT_7_INDEX) = newNtMakeTemporaryObject;
	oldNtMapUserPhysicalPagesScatter = (NTMAPUSERPHYSICALPAGESSCATTER)SYSTEMSERVICE(MAPUSERPHYSICALPAGESSCATTER_7_INDEX); (NTMAPUSERPHYSICALPAGESSCATTER)SYSTEMSERVICE(MAPUSERPHYSICALPAGESSCATTER_7_INDEX) = newNtMapUserPhysicalPagesScatter;
	oldNtModifyBootEntry = (NTMODIFYBOOTENTRY)SYSTEMSERVICE(MODIFYBOOTENTRY_7_INDEX); (NTMODIFYBOOTENTRY)SYSTEMSERVICE(MODIFYBOOTENTRY_7_INDEX) = newNtModifyBootEntry;
	oldNtOpenPrivateNamespace = (NTOPENPRIVATENAMESPACE)SYSTEMSERVICE(OPENPRIVATENAMESPACE_7_INDEX); (NTOPENPRIVATENAMESPACE)SYSTEMSERVICE(OPENPRIVATENAMESPACE_7_INDEX) = newNtOpenPrivateNamespace;
	oldNtOpenResourceManager = (NTOPENRESOURCEMANAGER)SYSTEMSERVICE(OPENRESOURCEMANAGER_7_INDEX); (NTOPENRESOURCEMANAGER)SYSTEMSERVICE(OPENRESOURCEMANAGER_7_INDEX) = newNtOpenResourceManager;
	oldNtOpenSemaphore = (NTOPENSEMAPHORE)SYSTEMSERVICE(OPENSEMAPHORE_7_INDEX); (NTOPENSEMAPHORE)SYSTEMSERVICE(OPENSEMAPHORE_7_INDEX) = newNtOpenSemaphore;
	oldNtOpenSession = (NTOPENSESSION)SYSTEMSERVICE(OPENSESSION_7_INDEX); (NTOPENSESSION)SYSTEMSERVICE(OPENSESSION_7_INDEX) = newNtOpenSession;
	oldNtPrePrepareEnlistment = (NTPREPREPAREENLISTMENT)SYSTEMSERVICE(PREPREPAREENLISTMENT_7_INDEX); (NTPREPREPAREENLISTMENT)SYSTEMSERVICE(PREPREPAREENLISTMENT_7_INDEX) = newNtPrePrepareEnlistment;
	oldNtQueryInformationEnlistment = (NTQUERYINFORMATIONENLISTMENT)SYSTEMSERVICE(QUERYINFORMATIONENLISTMENT_7_INDEX); (NTQUERYINFORMATIONENLISTMENT)SYSTEMSERVICE(QUERYINFORMATIONENLISTMENT_7_INDEX) = newNtQueryInformationEnlistment;
	oldNtQueryInformationResourceManager = (NTQUERYINFORMATIONRESOURCEMANAGER)SYSTEMSERVICE(QUERYINFORMATIONRESOURCEMANAGER_7_INDEX); (NTQUERYINFORMATIONRESOURCEMANAGER)SYSTEMSERVICE(QUERYINFORMATIONRESOURCEMANAGER_7_INDEX) = newNtQueryInformationResourceManager;
	oldNtQueryInformationTransaction = (NTQUERYINFORMATIONTRANSACTION)SYSTEMSERVICE(QUERYINFORMATIONTRANSACTION_7_INDEX); (NTQUERYINFORMATIONTRANSACTION)SYSTEMSERVICE(QUERYINFORMATIONTRANSACTION_7_INDEX) = newNtQueryInformationTransaction;
	oldNtQueryInformationWorkerFactory = (NTQUERYINFORMATIONWORKERFACTORY)SYSTEMSERVICE(QUERYINFORMATIONWORKERFACTORY_7_INDEX); (NTQUERYINFORMATIONWORKERFACTORY)SYSTEMSERVICE(QUERYINFORMATIONWORKERFACTORY_7_INDEX) = newNtQueryInformationWorkerFactory;
	oldNtReadOnlyEnlistment = (NTREADONLYENLISTMENT)SYSTEMSERVICE(READONLYENLISTMENT_7_INDEX); (NTREADONLYENLISTMENT)SYSTEMSERVICE(READONLYENLISTMENT_7_INDEX) = newNtReadOnlyEnlistment;
	oldNtRegisterProtocolAddressInformation = (NTREGISTERPROTOCOLADDRESSINFORMATION)SYSTEMSERVICE(REGISTERPROTOCOLADDRESSINFORMATION_7_INDEX); (NTREGISTERPROTOCOLADDRESSINFORMATION)SYSTEMSERVICE(REGISTERPROTOCOLADDRESSINFORMATION_7_INDEX) = newNtRegisterProtocolAddressInformation;
	oldNtReplacePartitionUnit = (NTREPLACEPARTITIONUNIT)SYSTEMSERVICE(REPLACEPARTITIONUNIT_7_INDEX); (NTREPLACEPARTITIONUNIT)SYSTEMSERVICE(REPLACEPARTITIONUNIT_7_INDEX) = newNtReplacePartitionUnit;
	oldNtResetWriteWatch = (NTRESETWRITEWATCH)SYSTEMSERVICE(RESETWRITEWATCH_7_INDEX); (NTRESETWRITEWATCH)SYSTEMSERVICE(RESETWRITEWATCH_7_INDEX) = newNtResetWriteWatch;
	oldNtResumeProcess = (NTRESUMEPROCESS)SYSTEMSERVICE(RESUMEPROCESS_7_INDEX); (NTRESUMEPROCESS)SYSTEMSERVICE(RESUMEPROCESS_7_INDEX) = newNtResumeProcess;
	oldNtSaveKeyEx = (NTSAVEKEYEX)SYSTEMSERVICE(SAVEKEYEX_7_INDEX); (NTSAVEKEYEX)SYSTEMSERVICE(SAVEKEYEX_7_INDEX) = newNtSaveKeyEx;
	oldNtSetDefaultLocale = (NTSETDEFAULTLOCALE)SYSTEMSERVICE(SETDEFAULTLOCALE_7_INDEX); (NTSETDEFAULTLOCALE)SYSTEMSERVICE(SETDEFAULTLOCALE_7_INDEX) = newNtSetDefaultLocale;
	oldNtSetInformationDebugObject = (NTSETINFORMATIONDEBUGOBJECT)SYSTEMSERVICE(SETINFORMATIONDEBUGOBJECT_7_INDEX); (NTSETINFORMATIONDEBUGOBJECT)SYSTEMSERVICE(SETINFORMATIONDEBUGOBJECT_7_INDEX) = newNtSetInformationDebugObject;
	oldNtSetInformationJobObject = (NTSETINFORMATIONJOBOBJECT)SYSTEMSERVICE(SETINFORMATIONJOBOBJECT_7_INDEX); (NTSETINFORMATIONJOBOBJECT)SYSTEMSERVICE(SETINFORMATIONJOBOBJECT_7_INDEX) = newNtSetInformationJobObject;
	oldNtSetInformationResourceManager = (NTSETINFORMATIONRESOURCEMANAGER)SYSTEMSERVICE(SETINFORMATIONRESOURCEMANAGER_7_INDEX); (NTSETINFORMATIONRESOURCEMANAGER)SYSTEMSERVICE(SETINFORMATIONRESOURCEMANAGER_7_INDEX) = newNtSetInformationResourceManager;
	oldNtSetInformationTransactionManager = (NTSETINFORMATIONTRANSACTIONMANAGER)SYSTEMSERVICE(SETINFORMATIONTRANSACTIONMANAGER_7_INDEX); (NTSETINFORMATIONTRANSACTIONMANAGER)SYSTEMSERVICE(SETINFORMATIONTRANSACTIONMANAGER_7_INDEX) = newNtSetInformationTransactionManager;
	oldNtSetIntervalProfile = (NTSETINTERVALPROFILE)SYSTEMSERVICE(SETINTERVALPROFILE_7_INDEX); (NTSETINTERVALPROFILE)SYSTEMSERVICE(SETINTERVALPROFILE_7_INDEX) = newNtSetIntervalProfile;
	oldNtSetSystemPowerState = (NTSETSYSTEMPOWERSTATE)SYSTEMSERVICE(SETSYSTEMPOWERSTATE_7_INDEX); (NTSETSYSTEMPOWERSTATE)SYSTEMSERVICE(SETSYSTEMPOWERSTATE_7_INDEX) = newNtSetSystemPowerState;
	oldNtSetTimer = (NTSETTIMER)SYSTEMSERVICE(SETTIMER_7_INDEX); (NTSETTIMER)SYSTEMSERVICE(SETTIMER_7_INDEX) = newNtSetTimer;
	oldNtSinglePhaseReject = (NTSINGLEPHASEREJECT)SYSTEMSERVICE(SINGLEPHASEREJECT_7_INDEX); (NTSINGLEPHASEREJECT)SYSTEMSERVICE(SINGLEPHASEREJECT_7_INDEX) = newNtSinglePhaseReject;
	oldNtVdmControl = (NTVDMCONTROL)SYSTEMSERVICE(VDMCONTROL_7_INDEX); (NTVDMCONTROL)SYSTEMSERVICE(VDMCONTROL_7_INDEX) = newNtVdmControl;
	oldNtWaitLowEventPair = (NTWAITLOWEVENTPAIR)SYSTEMSERVICE(WAITLOWEVENTPAIR_7_INDEX); (NTWAITLOWEVENTPAIR)SYSTEMSERVICE(WAITLOWEVENTPAIR_7_INDEX) = newNtWaitLowEventPair;
	*/
	enable_cr0();
}

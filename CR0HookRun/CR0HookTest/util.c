#include "util.h"

extern ULONG nwPid;
extern ULONG filterPids[FILTERPIDCNT];
extern ULONG strategyPids[FILTERPIDCNT];
extern ULONG intrusivePids[FILTERPIDCNT];

static ULONG KsecRandomSeed = 0x62b409a1;

VOID unhook_ssdt_entries_7()
{
	disable_cr0();
	
	if(oldNtCreateThread != NULL)
		(NTCREATETHREAD)SYSTEMSERVICE(CREATETHREAD_7_INDEX) = oldNtCreateThread;
		
	if(oldNtCreateThreadEx != NULL)
		(NTCREATETHREADEX)SYSTEMSERVICE(CREATETHREADEX_7_INDEX) = oldNtCreateThreadEx;
	
	if(oldNtMapViewOfSection != NULL)
		(NTMAPVIEWOFSECTION)SYSTEMSERVICE(MAPVIEWOFSECTION_7_INDEX) = oldNtMapViewOfSection;
	
	if(oldNtSetContextThread != NULL)
		(NTSETCONTEXTTHREAD)SYSTEMSERVICE(SETCONTEXTTHREAD_7_INDEX) = oldNtSetContextThread;
	
	if(oldNtCreateProcess != NULL)
		(NTCREATEPROCESS)SYSTEMSERVICE(CREATEPROCESS_7_INDEX) = oldNtCreateProcess;
	
	if(oldNtCreateProcessEx != NULL)
		(NTCREATEPROCESSEX)SYSTEMSERVICE(CREATEPROCESSEX_7_INDEX) = oldNtCreateProcessEx;
	
	if(oldNtCreateUserProcess != NULL)
		(NTCREATEUSERPROCESS)SYSTEMSERVICE(CREATEUSERPROCESS_7_INDEX) = oldNtCreateUserProcess;
		
	if(oldNtQueueApcThread != NULL)
		(NTQUEUEAPCTHREAD)SYSTEMSERVICE(QUEUEAPCTHREAD_7_INDEX) = oldNtQueueApcThread;
	
	if(oldNtSystemDebugControl != NULL)
		(NTSYSTEMDEBUGCONTROL)SYSTEMSERVICE(SYSTEMDEBUGCONTROL_7_INDEX) = oldNtSystemDebugControl;
	
	if(oldNtWriteVirtualMemory != NULL)
		(NTWRITEVIRTUALMEMORY)SYSTEMSERVICE(WRITEVIRTUALMEMORY_7_INDEX) = oldNtWriteVirtualMemory;
	
	if(oldNtDebugActiveProcess != NULL)
		(NTDEBUGACTIVEPROCESS)SYSTEMSERVICE(DEBUGACTIVEPROCESS_7_INDEX) = oldNtDebugActiveProcess;
	
	if(oldNtOpenProcess != NULL)
		(NTOPENPROCESS)SYSTEMSERVICE(OPENPROCESS_7_INDEX) = oldNtOpenProcess;
	
	if(oldNtOpenThread != NULL)
		(NTOPENTHREAD)SYSTEMSERVICE(OPENTHREAD_7_INDEX) = oldNtOpenThread;
	
	if(oldNtQuerySystemInformation != NULL)
		(NTQUERYSYSTEMINFORMATION)SYSTEMSERVICE(QUERYSYSTEMINFORMATION_7_INDEX) = oldNtQuerySystemInformation;
	
	if(oldNtCreateFile != NULL)
		(NTCREATEFILE)SYSTEMSERVICE(CREATEFILE_7_INDEX) = oldNtCreateFile;
	
	if(oldNtReadFile != NULL)
		(NTREADFILE)SYSTEMSERVICE(READFILE_7_INDEX) = oldNtReadFile;
	
	if(oldNtWriteFile != NULL)
		(NTWRITEFILE)SYSTEMSERVICE(WRITEFILE_7_INDEX) = oldNtWriteFile;
	
	if(oldNtDeleteFile != NULL)
		(NTDELETEFILE)SYSTEMSERVICE(DELETEFILE_7_INDEX) = oldNtDeleteFile;
	
	if(oldNtSetInformationFile != NULL)
		(NTSETINFORMATIONFILE)SYSTEMSERVICE(SETINFORMATIONFILE_7_INDEX) = oldNtSetInformationFile;
	
	if(oldNtQueryInformationFile != NULL)
		(NTQUERYINFORMATIONFILE)SYSTEMSERVICE(QUERYINFORMATIONFILE_7_INDEX) = oldNtQueryInformationFile;
	
	if(oldNtCreateMutant != NULL)
		(NTCREATEMUTANT)SYSTEMSERVICE(CREATEMUTANT_7_INDEX) = oldNtCreateMutant;
		
	if(oldNtDeviceIoControlFile != NULL)
		(NTDEVICEIOCONTROLFILE)SYSTEMSERVICE(DEVICEIOCONTROLFILE_7_INDEX) = oldNtDeviceIoControlFile;
		
	if(oldNtTerminateProcess != NULL)
		(NTTERMINATEPROCESS)SYSTEMSERVICE(TERMINATEPROCESS_7_INDEX) = oldNtTerminateProcess;
		
	if(oldNtDelayExecution != NULL)
		(NTDELAYEXECUTION)SYSTEMSERVICE(DELAYEXECUTION_7_INDEX) = oldNtDelayExecution;
		
	if(oldNtQueryValueKey != NULL)
		(NTQUERYVALUEKEY)SYSTEMSERVICE(QUERYVALUEKEY_7_INDEX) = oldNtQueryValueKey;
		
	if(oldNtQueryAttributesFile != NULL)
		(NTQUERYATTRIBUTESFILE)SYSTEMSERVICE(QUERYATTRIBUTESFILE_7_INDEX) = oldNtQueryAttributesFile;
		
	if(oldNtReadVirtualMemory != NULL)
		(NTREADVIRTUALMEMORY)SYSTEMSERVICE(QUERYATTRIBUTESFILE_7_INDEX) = oldNtReadVirtualMemory;
		
	if(oldNtResumeThread != NULL)
		(NTRESUMETHREAD)SYSTEMSERVICE(RESUMETHREAD_7_INDEX) = oldNtResumeThread;
	
	if(oldNtCreateSection != NULL)
		(NTCREATESECTION)SYSTEMSERVICE(CREATESECTION_7_INDEX) = oldNtCreateSection;
	
	if(oldNtCreateProcess != NULL)
		(NTCREATEPROCESS)SYSTEMSERVICE(CREATEPROCESS_7_INDEX) = oldNtCreateProcess;
	
	if(oldNtCreateProcessEx != NULL)
		(NTCREATEPROCESSEX)SYSTEMSERVICE(CREATEPROCESSEX_7_INDEX) = oldNtCreateProcessEx;
	
	if(oldNtLoadDriver != NULL)
		(NTLOADDRIVER)SYSTEMSERVICE(LOADDRIVER_7_INDEX) = oldNtLoadDriver;	
		
	if(oldNtClose != NULL)
		(NTCLOSE)SYSTEMSERVICE(CLOSE_7_INDEX) = oldNtClose;
	
	if(oldNtOpenFile != NULL)
		(NTOPENFILE)SYSTEMSERVICE(OPENFILE_7_INDEX) = oldNtOpenFile;	

	// start adding by Ruimin
	if(oldNtNotifyChangeMultipleKeys != NULL)
		(NTNOTIFYCHANGEMULTIPLEKEYS)SYSTEMSERVICE(NOTIFYCHANGEMULTIPLEKEYS_7_INDEX) = oldNtNotifyChangeMultipleKeys;

	if(oldNtQueryMultipleValueKey != NULL)
		(NTQUERYMULTIPLEVALUEKEY)SYSTEMSERVICE(QUERYMULTIPLEVALUEKEY_7_INDEX) = oldNtQueryMultipleValueKey;

	if(oldNtQueryObject != NULL)
		(NTQUERYOBJECT)SYSTEMSERVICE(QUERYOBJECT_7_INDEX) = oldNtQueryObject;

	if(oldNtQueryPerformanceCounter != NULL)
		(NTQUERYPERFORMANCECOUNTER)SYSTEMSERVICE(QUERYPERFORMANCECOUNTER_7_INDEX) = oldNtQueryPerformanceCounter;

	if(oldNtRenameKey != NULL)
		(NTRENAMEKEY)SYSTEMSERVICE(RENAMEKEY_7_INDEX) = oldNtRenameKey;

	if(oldNtSetInformationKey != NULL)
		(NTSETINFORMATIONKEY)SYSTEMSERVICE(SETINFORMATIONKEY_7_INDEX) = oldNtSetInformationKey;

	if(oldNtAllocateLocallyUniqueId != NULL)
		(NTALLOCATELOCALLYUNIQUEID)SYSTEMSERVICE(ALLOCATELOCALLYUNIQUEID_7_INDEX) = oldNtAllocateLocallyUniqueId;

	if(oldNtAllocateVirtualMemory != NULL)
		(NTALLOCATEVIRTUALMEMORY)SYSTEMSERVICE(ALLOCATEVIRTUALMEMORY_7_INDEX) = oldNtAllocateVirtualMemory;

	if(oldNtCreateDirectoryObject != NULL)
		(NTCREATEDIRECTORYOBJECT)SYSTEMSERVICE(CREATEDIRECTORYOBJECT_7_INDEX) = oldNtCreateDirectoryObject;

	if(oldNtCreateEvent != NULL)
		(NTCREATEEVENT)SYSTEMSERVICE(CREATEEVENT_7_INDEX) = oldNtCreateEvent;

	if(oldNtCreateKey != NULL)
		(NTCREATEKEY)SYSTEMSERVICE(CREATEKEY_7_INDEX) = oldNtCreateKey;

	if(oldNtCreateKeyTransacted != NULL)
		(NTCREATEKEYTRANSACTED)SYSTEMSERVICE(CREATEKEYTRANSACTED_7_INDEX) = oldNtCreateKeyTransacted;

	if(oldNtSetQuotaInformationFile != NULL)
		(NTSETQUOTAINFORMATIONFILE)SYSTEMSERVICE(SETQUOTAINFORMATIONFILE_7_INDEX) = oldNtSetQuotaInformationFile;
	
	if(oldNtSetSecurityObject != NULL)
		(NTSETSECURITYOBJECT)SYSTEMSERVICE(SETSECURITYOBJECT_7_INDEX) = oldNtSetSecurityObject;
	
	if(oldNtSetValueKey != NULL)
		(NTSETVALUEKEY)SYSTEMSERVICE(SETVALUEKEY_7_INDEX) = oldNtSetValueKey;

	if(oldNtSetVolumeInformationFile != NULL)
		(NTSETVOLUMEINFORMATIONFILE)SYSTEMSERVICE(SETVOLUMEINFORMATIONFILE_7_INDEX) = oldNtSetVolumeInformationFile;

	if(oldNtUnloadDriver != NULL)
		(NTUNLOADDRIVER)SYSTEMSERVICE(UNLOADDRIVER_7_INDEX) = oldNtUnloadDriver;

	if(oldNtUnlockFile != NULL)
		(NTUNLOCKFILE)SYSTEMSERVICE(UNLOCKFILE_7_INDEX) = oldNtUnlockFile;

	if(oldNtUnmapViewOfSection != NULL)
		(NTUNMAPVIEWOFSECTION)SYSTEMSERVICE(UNMAPVIEWOFSECTION_7_INDEX) = oldNtUnmapViewOfSection;

	if(oldNtWaitForSingleObject != NULL)
		(NTWAITFORSINGLEOBJECT)SYSTEMSERVICE(WAITFORSINGLEOBJECT_7_INDEX) = oldNtWaitForSingleObject;

	if(oldNtAllocateVirtualMemory != NULL)
		(NTALLOCATEVIRTUALMEMORY)SYSTEMSERVICE(ALLOCATEVIRTUALMEMORY_7_INDEX) = oldNtAllocateVirtualMemory;

	if(oldNtFlushVirtualMemory != NULL)
		(NTFLUSHVIRTUALMEMORY)SYSTEMSERVICE(FLUSHVIRTUALMEMORY_7_INDEX) = oldNtFlushVirtualMemory;

	if(oldNtFreeVirtualMemory != NULL)
		(NTFREEVIRTUALMEMORY)SYSTEMSERVICE(FREEVIRTUALMEMORY_7_INDEX) = oldNtFreeVirtualMemory;

	if(oldNtLockVirtualMemory != NULL)
		(NTLOCKVIRTUALMEMORY)SYSTEMSERVICE(LOCKVIRTUALMEMORY_7_INDEX) = oldNtLockVirtualMemory;

	if(oldNtProtectVirtualMemory != NULL)
		(NTPROTECTVIRTUALMEMORY)SYSTEMSERVICE(PROTECTVIRTUALMEMORY_7_INDEX) = oldNtProtectVirtualMemory;

	if(oldNtUnlockVirtualMemory != NULL)
		(NTUNLOCKVIRTUALMEMORY)SYSTEMSERVICE(UNLOCKVIRTUALMEMORY_7_INDEX) = oldNtUnlockVirtualMemory;

	if(oldNtDebugActiveProcess != NULL)
		(NTDEBUGACTIVEPROCESS)SYSTEMSERVICE(DEBUGACTIVEPROCESS_7_INDEX) = oldNtDebugActiveProcess;
	 
	if(oldNtFlushInstructionCache != NULL)
		(NTFLUSHINSTRUCTIONCACHE)SYSTEMSERVICE(FLUSHINSTRUCTIONCACHE_7_INDEX) = oldNtFlushInstructionCache;

	if(oldNtQueryInformationProcess != NULL)
		(NTQUERYINFORMATIONPROCESS)SYSTEMSERVICE(QUERYINFORMATIONPROCESS_7_INDEX) = oldNtQueryInformationProcess;

	if(oldNtSetInformationProcess != NULL)
		(NTSETINFORMATIONPROCESS)SYSTEMSERVICE(SETINFORMATIONPROCESS_7_INDEX) = oldNtSetInformationProcess;
	 
	if(oldNtAlertThread != NULL)
		(NTALERTTHREAD)SYSTEMSERVICE(ALERTTHREAD_7_INDEX) = oldNtAlertThread;

	if(oldNtCallbackReturn != NULL)
		(NTCALLBACKRETURN)SYSTEMSERVICE(CALLBACKRETURN_7_INDEX) = oldNtCallbackReturn;

	if(oldNtGetContextThread != NULL)
		(NTGETCONTEXTTHREAD)SYSTEMSERVICE(GETCONTEXTTHREAD_7_INDEX) = oldNtGetContextThread;	

	if(oldNtAlertResumeThread != NULL)
		(NTALERTRESUMETHREAD)SYSTEMSERVICE(ALERTRESUMETHREAD_7_INDEX) = oldNtAlertResumeThread;

	if(oldNtContinue != NULL)
		(NTCONTINUE)SYSTEMSERVICE(CONTINUE_7_INDEX) = oldNtContinue;

	if(oldNtImpersonateThread != NULL)
		(NTIMPERSONATETHREAD)SYSTEMSERVICE(IMPERSONATETHREAD_7_INDEX) = oldNtImpersonateThread;

	if(oldNtRegisterThreadTerminatePort != NULL)
		(NTREGISTERTHREADTERMINATEPORT)SYSTEMSERVICE(REGISTERTHREADTERMINATEPORT_7_INDEX) = oldNtRegisterThreadTerminatePort;	

	if(oldNtSuspendThread != NULL)
		(NTSUSPENDTHREAD)SYSTEMSERVICE(SUSPENDTHREAD_7_INDEX) = oldNtSuspendThread;	

	if(oldNtTerminateThread != NULL)
		(NTTERMINATETHREAD)SYSTEMSERVICE(TERMINATETHREAD_7_INDEX) = oldNtTerminateThread;	

	if(oldNtOpenMutant != NULL)
		(NTOPENMUTANT)SYSTEMSERVICE(OPENMUTANT_7_INDEX) = oldNtOpenMutant;	

	if(oldNtQueryMutant != NULL)
		(NTQUERYMUTANT)SYSTEMSERVICE(QUERYMUTANT_7_INDEX) = oldNtQueryMutant;	

	if(oldNtReleaseMutant != NULL)
		(NTRELEASEMUTANT)SYSTEMSERVICE(RELEASEMUTANT_7_INDEX) = oldNtReleaseMutant;	

	if(oldNtSetTimerResolution != NULL)
		(NTSETTIMERRESOLUTION)SYSTEMSERVICE(SETTIMERRESOLUTION_7_INDEX) = oldNtSetTimerResolution;	

	if(oldNtSetSystemTime != NULL)
		(NTSETSYSTEMTIME)SYSTEMSERVICE(SETSYSTEMTIME_7_INDEX) = oldNtSetSystemTime;	

	if(oldNtQueryTimerResolution != NULL)
		(NTQUERYTIMERRESOLUTION)SYSTEMSERVICE(QUERYTIMERRESOLUTION_7_INDEX) = oldNtQueryTimerResolution;	

	if(oldNtQuerySystemTime != NULL)
		(NTQUERYSYSTEMTIME)SYSTEMSERVICE(QUERYSYSTEMTIME_7_INDEX) = oldNtQuerySystemTime;	

	if(oldNtQueryPerformanceCounter != NULL)
		(NTQUERYPERFORMANCECOUNTER)SYSTEMSERVICE(QUERYPERFORMANCECOUNTER_7_INDEX) = oldNtQueryPerformanceCounter;	
	// end adding by ruimin
	//network system call
	if (oldNtAcceptConnectPort != NULL)
		(NTACCEPTCONNECTPORT)SYSTEMSERVICE(ACCEPTCONNECTPORT_7_INDEX) = oldNtAcceptConnectPort;

	if (oldNtCompleteConnectPort != NULL)
		(NTCOMPLETECONNECTPORT)SYSTEMSERVICE(COMPLETECONNECTPORT_7_INDEX) = oldNtCompleteConnectPort;

	if (oldNtCreatePort != NULL)
		(NTCREATEPORT)SYSTEMSERVICE(CREATEPORT_7_INDEX) = oldNtCreatePort;

	if (oldNtConnectPort != NULL)
		(NTCONNECTPORT)SYSTEMSERVICE(CONNECTPORT_7_INDEX) = oldNtConnectPort;

	if (oldNtImpersonateClientOfPort != NULL)
		(NTIMPERSONATECLIENTOFPORT)SYSTEMSERVICE(IMPERSONATECLIENTOFPORT_7_INDEX) = oldNtImpersonateClientOfPort;

	if (oldNtListenPort != NULL)
		(NTLISTENPORT)SYSTEMSERVICE(LISTENPORT_7_INDEX) = oldNtListenPort;

	if (oldNtQueryInformationPort != NULL)
		(NTQUERYINFORMATIONPORT)SYSTEMSERVICE(QUERYINFORMATIONPORT_7_INDEX) = oldNtQueryInformationPort;

	if (oldNtReadRequestData != NULL)
		(NTREADREQUESTDATA)SYSTEMSERVICE(READREQUESTDATA_7_INDEX) = oldNtReadRequestData;

	if (oldNtReplyPort != NULL)
		(NTREPLYPORT)SYSTEMSERVICE(REPLYPORT_7_INDEX) = oldNtReplyPort;

	if (oldNtReplyWaitReceivePort != NULL)
		(NTREPLYWAITRECEIVEPORT)SYSTEMSERVICE(REPLYWAITRECEIVEPORT_7_INDEX) = oldNtReplyWaitReceivePort;

	if (oldNtReplyWaitReplyPort != NULL)
		(NTREPLYWAITREPLYPORT)SYSTEMSERVICE(REPLYWAITREPLYPORT_7_INDEX) = oldNtReplyWaitReplyPort;

	if (oldNtRequestPort != NULL)
		(NTREQUESTPORT)SYSTEMSERVICE(REQUESTPORT_7_INDEX) = oldNtRequestPort;

	if (oldNtRequestWaitReplyPort != NULL)
		(NTREQUESTWAITREPLYPORT)SYSTEMSERVICE(REQUESTWAITREPLYPORT_7_INDEX) = oldNtRequestWaitReplyPort;

	if (oldNtWriteRequestData != NULL)
		(NTWRITEREQUESTDATA)SYSTEMSERVICE(WRITEREQUESTDATA_7_INDEX) = oldNtWriteRequestData;

	if (oldNtDeleteKey != NULL)
		(NTDELETEKEY)SYSTEMSERVICE(DELETEKEY_7_INDEX) = oldNtDeleteKey;

	if (oldNtDeleteValueKey != NULL)
		(NTDELETEVALUEKEY)SYSTEMSERVICE(DELETEVALUEKEY_7_INDEX) = oldNtDeleteValueKey;

	if (oldNtDuplicateObject != NULL)
		(NTDUPLICATEOBJECT)SYSTEMSERVICE(DUPLICATEOBJECT_7_INDEX) = oldNtDuplicateObject;

	if (oldNtDuplicateToken != NULL)
		(NTDUPLICATETOKEN)SYSTEMSERVICE(DUPLICATETOKEN_7_INDEX) = oldNtDuplicateToken;

	if (oldNtEnumerateKey != NULL)
		(NTENUMERATEKEY)SYSTEMSERVICE(ENUMERATEKEY_7_INDEX) = oldNtEnumerateKey;

	if (oldNtEnumerateValueKey != NULL)
		(NTENUMERATEVALUEKEY)SYSTEMSERVICE(ENUMERATEVALUEKEY_7_INDEX) = oldNtEnumerateValueKey;

	if (oldNtFlushBuffersFile != NULL)
		(NTFLUSHBUFFERSFILE)SYSTEMSERVICE(FLUSHBUFFERSFILE_7_INDEX) = oldNtFlushBuffersFile;

	if (oldNtFlushKey != NULL)
		(NTFLUSHKEY)SYSTEMSERVICE(FLUSHKEY_7_INDEX) = oldNtFlushKey;

	if (oldNtFlushVirtualMemory != NULL)
		(NTFLUSHVIRTUALMEMORY)SYSTEMSERVICE(FLUSHVIRTUALMEMORY_7_INDEX) = oldNtFlushVirtualMemory;

	if (oldNtFsControlFile != NULL)
		(NTFSCONTROLFILE)SYSTEMSERVICE(FSCONTROLFILE_7_INDEX) = oldNtFsControlFile;

	if (oldNtLockFile != NULL)
		(NTLOCKFILE)SYSTEMSERVICE(LOCKFILE_7_INDEX) = oldNtLockFile;

	if (oldNtMakeTemporaryObject != NULL)
		(NTMAKETEMPORARYOBJECT)SYSTEMSERVICE(MAKETEMPORARYOBJECT_7_INDEX) = oldNtMakeTemporaryObject;

	if (oldNtNotifyChangeKey != NULL)
		(NTNOTIFYCHANGEKEY)SYSTEMSERVICE(NOTIFYCHANGEKEY_7_INDEX) = oldNtNotifyChangeKey;

	if (oldNtOpenDirectoryObject != NULL)
		(NTOPENDIRECTORYOBJECT)SYSTEMSERVICE(OPENDIRECTORYOBJECT_7_INDEX) = oldNtOpenDirectoryObject;

	if (oldNtOpenEvent != NULL)
		(NTOPENEVENT)SYSTEMSERVICE(OPENEVENT_7_INDEX) = oldNtOpenEvent;

	if (oldNtOpenKey != NULL)
		(NTOPENKEY)SYSTEMSERVICE(OPENKEY_7_INDEX) = oldNtOpenKey;

	if (oldNtOpenKeyEx != NULL)
		(NTOPENKEYEX)SYSTEMSERVICE(OPENKEYEX_7_INDEX) = oldNtOpenKeyEx;

	if (oldNtOpenKeyTransacted != NULL)
		(NTOPENKEYTRANSACTED)SYSTEMSERVICE(OPENKEYTRANSACTED_7_INDEX) = oldNtOpenKeyTransacted;

	if (oldNtOpenKeyTransactedEx != NULL)
		(NTOPENKEYTRANSACTEDEX)SYSTEMSERVICE(OPENKEYTRANSACTEDEX_7_INDEX) = oldNtOpenKeyTransactedEx;

	if (oldNtOpenProcessTokenEx != NULL)
		(NTOPENPROCESSTOKENEX)SYSTEMSERVICE(OPENPROCESSTOKENEX_7_INDEX) = oldNtOpenProcessTokenEx;

	if (oldNtOpenSection != NULL)
		(NTOPENSECTION)SYSTEMSERVICE(OPENSECTION_7_INDEX) = oldNtOpenSection;

	if (oldNtOpenSymbolicLinkObject != NULL)
		(NTOPENSYMBOLICLINKOBJECT)SYSTEMSERVICE(OPENSYMBOLICLINKOBJECT_7_INDEX) = oldNtOpenSymbolicLinkObject;               

	if (oldNtOpenThreadTokenEx != NULL)
		(NTOPENTHREADTOKENEX)SYSTEMSERVICE(OPENTHREADTOKENEX_7_INDEX) = oldNtOpenThreadTokenEx;              

	if (oldNtPowerInformation != NULL)
		(NTPOWERINFORMATION)SYSTEMSERVICE(POWERINFORMATION_7_INDEX) = oldNtPowerInformation;             

	if (oldNtQueryInformationThread != NULL)
		(NTQUERYINFORMATIONTHREAD)SYSTEMSERVICE(QUERYINFORMATIONTHREAD_7_INDEX) = oldNtQueryInformationThread;             

	if (oldNtQueryDirectoryFile != NULL)
		(NTQUERYDIRECTORYFILE)SYSTEMSERVICE(QUERYDIRECTORYFILE_7_INDEX) = oldNtQueryDirectoryFile;              

	if (oldNtQueryEaFile != NULL)
		(NTQUERYEAFILE)SYSTEMSERVICE(QUERYEAFILE_7_INDEX) = oldNtQueryEaFile;             

	if (oldNtQueryFullAttributesFile != NULL)
		(NTQUERYFULLATTRIBUTESFILE)SYSTEMSERVICE(QUERYFULLATTRIBUTESFILE_7_INDEX) = oldNtQueryFullAttributesFile;              

	if (oldNtQueryInformationToken != NULL)
		(NTQUERYINFORMATIONTOKEN)SYSTEMSERVICE(QUERYINFORMATIONTOKEN_7_INDEX) = oldNtQueryInformationToken;              

	if (oldNtQueryKey != NULL)
		(NTQUERYKEY)SYSTEMSERVICE(QUERYKEY_7_INDEX) = oldNtQueryKey;   

	if (oldNtQueryQuotaInformationFile != NULL)
		(NTQUERYQUOTAINFORMATIONFILE)SYSTEMSERVICE(QUERYQUOTAINFORMATIONFILE_7_INDEX) = oldNtQueryQuotaInformationFile;

	if (oldNtQuerySecurityObject != NULL)
		(NTQUERYSECURITYOBJECT)SYSTEMSERVICE(QUERYSECURITYOBJECT_7_INDEX) = oldNtQuerySecurityObject;

	if (oldNtQuerySymbolicLinkObject != NULL)
		(NTQUERYSYMBOLICLINKOBJECT)SYSTEMSERVICE(QUERYSYMBOLICLINKOBJECT_7_INDEX) = oldNtQuerySymbolicLinkObject;

	if (oldNtQueryVirtualMemory != NULL)
		(NTQUERYVIRTUALMEMORY)SYSTEMSERVICE(QUERYVIRTUALMEMORY_7_INDEX) = oldNtQueryVirtualMemory;

	if (oldNtQueryVolumeInformationFile != NULL)
		(NTQUERYVOLUMEINFORMATIONFILE)SYSTEMSERVICE(QUERYVOLUMEINFORMATIONFILE_7_INDEX) = oldNtQueryVolumeInformationFile;

	if (oldNtSetEaFile != NULL)
		(NTSETEAFILE)SYSTEMSERVICE(SETEAFILE_7_INDEX) = oldNtSetEaFile;

	if (oldNtSetEvent != NULL)
		(NTSETEVENT)SYSTEMSERVICE(SETEVENT_7_INDEX) = oldNtSetEvent;

	if (oldNtSetInformationThread != NULL)
		(NTSETINFORMATIONTHREAD)SYSTEMSERVICE(SETINFORMATIONTHREAD_7_INDEX) = oldNtSetInformationThread;

	if (oldNtSetInformationToken != NULL)
		(NTSETINFORMATIONTOKEN)SYSTEMSERVICE(SETINFORMATIONTOKEN_7_INDEX) = oldNtSetInformationToken;

	if (oldNtAccessCheck != NULL)
		(NTACCESSCHECK)SYSTEMSERVICE(ACCESSCHECK_7_INDEX) = oldNtAccessCheck;

	if (oldNtAccessCheckAndAuditAlarm != NULL)
		(NTACCESSCHECKANDAUDITALARM)SYSTEMSERVICE(ACCESSCHECKANDAUDITALARM_7_INDEX) = oldNtAccessCheckAndAuditAlarm;

	if (oldNtAccessCheckByType != NULL)
		(NTACCESSCHECKBYTYPE)SYSTEMSERVICE(ACCESSCHECKBYTYPE_7_INDEX) = oldNtAccessCheckByType;

	if (oldNtAccessCheckByTypeAndAuditAlarm != NULL)
		(NTACCESSCHECKBYTYPEANDAUDITALARM)SYSTEMSERVICE(ACCESSCHECKBYTYPEANDAUDITALARM_7_INDEX) = oldNtAccessCheckByTypeAndAuditAlarm;

	if (oldNtAccessCheckByTypeResultList != NULL)
		(NTACCESSCHECKBYTYPERESULTLIST)SYSTEMSERVICE(ACCESSCHECKBYTYPERESULTLIST_7_INDEX) = oldNtAccessCheckByTypeResultList;

	if (oldNtAccessCheckByTypeResultListAndAuditAlarm != NULL)
		(NTACCESSCHECKBYTYPERESULTLISTANDAUDITALARM)SYSTEMSERVICE(ACCESSCHECKBYTYPERESULTLISTANDAUDITALARM_7_INDEX) = oldNtAccessCheckByTypeResultListAndAuditAlarm;

	if (oldNtAccessCheckByTypeResultListAndAuditAlarmByHandle != NULL)
		(NTACCESSCHECKBYTYPERESULTLISTANDAUDITALARMBYHANDLE)SYSTEMSERVICE(ACCESSCHECKBYTYPERESULTLISTANDAUDITALARMBYHANDLE_7_INDEX) = oldNtAccessCheckByTypeResultListAndAuditAlarmByHandle;

	if (oldNtAddAtom != NULL)
		(NTADDATOM)SYSTEMSERVICE(ADDATOM_7_INDEX) = oldNtAddAtom;

	if (oldNtAddBootEntry != NULL)
		(NTADDBOOTENTRY)SYSTEMSERVICE(ADDBOOTENTRY_7_INDEX) = oldNtAddBootEntry;

	if (oldNtAddDriverEntry != NULL)
		(NTADDDRIVERENTRY)SYSTEMSERVICE(ADDDRIVERENTRY_7_INDEX) = oldNtAddDriverEntry;

	if (oldNtAdjustGroupsToken != NULL)
		(NTADJUSTGROUPSTOKEN)SYSTEMSERVICE(ADJUSTGROUPSTOKEN_7_INDEX) = oldNtAdjustGroupsToken;

	if (oldNtAdjustPrivilegesToken != NULL)
		(NTADJUSTPRIVILEGESTOKEN)SYSTEMSERVICE(ADJUSTPRIVILEGESTOKEN_7_INDEX) = oldNtAdjustPrivilegesToken;

	if (oldNtAllocateReserveObject != NULL)
		(NTALLOCATERESERVEOBJECT)SYSTEMSERVICE(ALLOCATERESERVEOBJECT_7_INDEX) = oldNtAllocateReserveObject;

	if (oldNtAllocateUserPhysicalPages != NULL)
		(NTALLOCATEUSERPHYSICALPAGES)SYSTEMSERVICE(ALLOCATEUSERPHYSICALPAGES_7_INDEX) = oldNtAllocateUserPhysicalPages;

	if (oldNtAllocateUuids != NULL)
		(NTALLOCATEUUIDS)SYSTEMSERVICE(ALLOCATEUUIDS_7_INDEX) = oldNtAllocateUuids;

	if (oldNtAlpcAcceptConnectPort != NULL)
		(NTALPCACCEPTCONNECTPORT)SYSTEMSERVICE(ALPCACCEPTCONNECTPORT_7_INDEX) = oldNtAlpcAcceptConnectPort;

	if (oldNtAlpcCancelMessage != NULL)
		(NTALPCCANCELMESSAGE)SYSTEMSERVICE(ALPCCANCELMESSAGE_7_INDEX) = oldNtAlpcCancelMessage;

	if (oldNtAlpcConnectPort != NULL)
		(NTALPCCONNECTPORT)SYSTEMSERVICE(ALPCCONNECTPORT_7_INDEX) = oldNtAlpcConnectPort;

	if (oldNtAlpcCreatePort != NULL)
		(NTALPCCREATEPORT)SYSTEMSERVICE(ALPCCREATEPORT_7_INDEX) = oldNtAlpcCreatePort;

	if (oldNtAlpcCreatePortSection != NULL)
		(NTALPCCREATEPORTSECTION)SYSTEMSERVICE(ALPCCREATEPORTSECTION_7_INDEX) = oldNtAlpcCreatePortSection;

	if (oldNtAlpcCreateResourceReserve != NULL)
		(NTALPCCREATERESOURCERESERVE)SYSTEMSERVICE(ALPCCREATERESOURCERESERVE_7_INDEX) = oldNtAlpcCreateResourceReserve;

	if (oldNtAlpcCreateSectionView != NULL)
		(NTALPCCREATESECTIONVIEW)SYSTEMSERVICE(ALPCCREATESECTIONVIEW_7_INDEX) = oldNtAlpcCreateSectionView;

	if (oldNtAlpcCreateSecurityContext != NULL)
		(NTALPCCREATESECURITYCONTEXT)SYSTEMSERVICE(ALPCCREATESECURITYCONTEXT_7_INDEX) = oldNtAlpcCreateSecurityContext;

	if (oldNtAlpcDeletePortSection != NULL)
		(NTALPCDELETEPORTSECTION)SYSTEMSERVICE(ALPCDELETEPORTSECTION_7_INDEX) = oldNtAlpcDeletePortSection;

	if (oldNtAlpcDeleteResourceReserve != NULL)
		(NTALPCDELETERESOURCERESERVE)SYSTEMSERVICE(ALPCDELETERESOURCERESERVE_7_INDEX) = oldNtAlpcDeleteResourceReserve;

	if (oldNtAlpcDeleteSectionView != NULL)
		(NTALPCDELETESECTIONVIEW)SYSTEMSERVICE(ALPCDELETESECTIONVIEW_7_INDEX) = oldNtAlpcDeleteSectionView;

	if (oldNtAlpcDeleteSecurityContext != NULL)
		(NTALPCDELETESECURITYCONTEXT)SYSTEMSERVICE(ALPCDELETESECURITYCONTEXT_7_INDEX) = oldNtAlpcDeleteSecurityContext;

	if (oldNtAlpcDisconnectPort != NULL)
		(NTALPCDISCONNECTPORT)SYSTEMSERVICE(ALPCDISCONNECTPORT_7_INDEX) = oldNtAlpcDisconnectPort;

	if (oldNtAlpcImpersonateClientOfPort != NULL)
		(NTALPCIMPERSONATECLIENTOFPORT)SYSTEMSERVICE(ALPCIMPERSONATECLIENTOFPORT_7_INDEX) = oldNtAlpcImpersonateClientOfPort;

	if (oldNtAlpcOpenSenderProcess != NULL)
		(NTALPCOPENSENDERPROCESS)SYSTEMSERVICE(ALPCOPENSENDERPROCESS_7_INDEX) = oldNtAlpcOpenSenderProcess;

	if (oldNtAlpcOpenSenderThread != NULL)
		(NTALPCOPENSENDERTHREAD)SYSTEMSERVICE(ALPCOPENSENDERTHREAD_7_INDEX) = oldNtAlpcOpenSenderThread;

	if (oldNtAlpcQueryInformation != NULL)
		(NTALPCQUERYINFORMATION)SYSTEMSERVICE(ALPCQUERYINFORMATION_7_INDEX) = oldNtAlpcQueryInformation;

	if (oldNtAlpcQueryInformationMessage != NULL)
		(NTALPCQUERYINFORMATIONMESSAGE)SYSTEMSERVICE(ALPCQUERYINFORMATIONMESSAGE_7_INDEX) = oldNtAlpcQueryInformationMessage;

	if (oldNtAlpcRevokeSecurityContext != NULL)
		(NTALPCREVOKESECURITYCONTEXT)SYSTEMSERVICE(ALPCREVOKESECURITYCONTEXT_7_INDEX) = oldNtAlpcRevokeSecurityContext;

	if (oldNtAlpcSendWaitReceivePort != NULL)
		(NTALPCSENDWAITRECEIVEPORT)SYSTEMSERVICE(ALPCSENDWAITRECEIVEPORT_7_INDEX) = oldNtAlpcSendWaitReceivePort;

	if (oldNtAlpcSetInformation != NULL)
		(NTALPCSETINFORMATION)SYSTEMSERVICE(ALPCSETINFORMATION_7_INDEX) = oldNtAlpcSetInformation;

	if (oldNtApphelpCacheControl != NULL)
		(NTAPPHELPCACHECONTROL)SYSTEMSERVICE(APPHELPCACHECONTROL_7_INDEX) = oldNtApphelpCacheControl;

	if (oldNtAreMappedFilesTheSame != NULL)
		(NTAREMAPPEDFILESTHESAME)SYSTEMSERVICE(AREMAPPEDFILESTHESAME_7_INDEX) = oldNtAreMappedFilesTheSame;

	if (oldNtAssignProcessToJobObject != NULL)
		(NTASSIGNPROCESSTOJOBOBJECT)SYSTEMSERVICE(ASSIGNPROCESSTOJOBOBJECT_7_INDEX) = oldNtAssignProcessToJobObject;

	if (oldNtCancelIoFile != NULL)
		(NTCANCELIOFILE)SYSTEMSERVICE(CANCELIOFILE_7_INDEX) = oldNtCancelIoFile;

	if (oldNtCancelIoFileEx != NULL)
		(NTCANCELIOFILEEX)SYSTEMSERVICE(CANCELIOFILEEX_7_INDEX) = oldNtCancelIoFileEx;

	if (oldNtCancelSynchronousIoFile != NULL)
		(NTCANCELSYNCHRONOUSIOFILE)SYSTEMSERVICE(CANCELSYNCHRONOUSIOFILE_7_INDEX) = oldNtCancelSynchronousIoFile;

	if (oldNtCancelTimer != NULL)
		(NTCANCELTIMER)SYSTEMSERVICE(CANCELTIMER_7_INDEX) = oldNtCancelTimer;

	if (oldNtClearEvent != NULL)
		(NTCLEAREVENT)SYSTEMSERVICE(CLEAREVENT_7_INDEX) = oldNtClearEvent;

	if (oldNtCommitComplete != NULL)
		(NTCOMMITCOMPLETE)SYSTEMSERVICE(COMMITCOMPLETE_7_INDEX) = oldNtCommitComplete;

	if (oldNtCommitEnlistment != NULL)
		(NTCOMMITENLISTMENT)SYSTEMSERVICE(COMMITENLISTMENT_7_INDEX) = oldNtCommitEnlistment;

	if (oldNtCommitTransaction != NULL)
		(NTCOMMITTRANSACTION)SYSTEMSERVICE(COMMITTRANSACTION_7_INDEX) = oldNtCommitTransaction;

	if (oldNtCompactKeys != NULL)
		(NTCOMPACTKEYS)SYSTEMSERVICE(COMPACTKEYS_7_INDEX) = oldNtCompactKeys;

	if (oldNtCompareTokens != NULL)
		(NTCOMPARETOKENS)SYSTEMSERVICE(COMPARETOKENS_7_INDEX) = oldNtCompareTokens;

	if (oldNtCompressKey != NULL)
		(NTCOMPRESSKEY)SYSTEMSERVICE(COMPRESSKEY_7_INDEX) = oldNtCompressKey;

	if (oldNtCreateDebugObject != NULL)
		(NTCREATEDEBUGOBJECT)SYSTEMSERVICE(CREATEDEBUGOBJECT_7_INDEX) = oldNtCreateDebugObject;

	if (oldNtCreateEnlistment != NULL)
		(NTCREATEENLISTMENT)SYSTEMSERVICE(CREATEENLISTMENT_7_INDEX) = oldNtCreateEnlistment;

	if (oldNtCreateEventPair != NULL)
		(NTCREATEEVENTPAIR)SYSTEMSERVICE(CREATEEVENTPAIR_7_INDEX) = oldNtCreateEventPair;

	if (oldNtCreateIoCompletion != NULL)
		(NTCREATEIOCOMPLETION)SYSTEMSERVICE(CREATEIOCOMPLETION_7_INDEX) = oldNtCreateIoCompletion;

	if (oldNtCreateJobObject != NULL)
		(NTCREATEJOBOBJECT)SYSTEMSERVICE(CREATEJOBOBJECT_7_INDEX) = oldNtCreateJobObject;

	if (oldNtCreateJobSet != NULL)
		(NTCREATEJOBSET)SYSTEMSERVICE(CREATEJOBSET_7_INDEX) = oldNtCreateJobSet;

	if (oldNtCreateKeyedEvent != NULL)
		(NTCREATEKEYEDEVENT)SYSTEMSERVICE(CREATEKEYEDEVENT_7_INDEX) = oldNtCreateKeyedEvent;

	if (oldNtCreateMailslotFile != NULL)
		(NTCREATEMAILSLOTFILE)SYSTEMSERVICE(CREATEMAILSLOTFILE_7_INDEX) = oldNtCreateMailslotFile;

	if (oldNtCreateNamedPipeFile != NULL)
		(NTCREATENAMEDPIPEFILE)SYSTEMSERVICE(CREATENAMEDPIPEFILE_7_INDEX) = oldNtCreateNamedPipeFile;

	if (oldNtCreatePagingFile != NULL)
		(NTCREATEPAGINGFILE)SYSTEMSERVICE(CREATEPAGINGFILE_7_INDEX) = oldNtCreatePagingFile;

	if (oldNtCreatePrivateNamespace != NULL)
		(NTCREATEPRIVATENAMESPACE)SYSTEMSERVICE(CREATEPRIVATENAMESPACE_7_INDEX) = oldNtCreatePrivateNamespace;

	if (oldNtCreateProfile != NULL)
		(NTCREATEPROFILE)SYSTEMSERVICE(CREATEPROFILE_7_INDEX) = oldNtCreateProfile;

	if (oldNtCreateProfileEx != NULL)
		(NTCREATEPROFILEEX)SYSTEMSERVICE(CREATEPROFILEEX_7_INDEX) = oldNtCreateProfileEx;

	if (oldNtCreateResourceManager != NULL)
		(NTCREATERESOURCEMANAGER)SYSTEMSERVICE(CREATERESOURCEMANAGER_7_INDEX) = oldNtCreateResourceManager;

	if (oldNtCreateSemaphore != NULL)
		(NTCREATESEMAPHORE)SYSTEMSERVICE(CREATESEMAPHORE_7_INDEX) = oldNtCreateSemaphore;

	if (oldNtCreateSymbolicLinkObject != NULL)
		(NTCREATESYMBOLICLINKOBJECT)SYSTEMSERVICE(CREATESYMBOLICLINKOBJECT_7_INDEX) = oldNtCreateSymbolicLinkObject;

	if (oldNtCreateTimer != NULL)
		(NTCREATETIMER)SYSTEMSERVICE(CREATETIMER_7_INDEX) = oldNtCreateTimer;

	if (oldNtCreateToken != NULL)
		(NTCREATETOKEN)SYSTEMSERVICE(CREATETOKEN_7_INDEX) = oldNtCreateToken;

	if (oldNtCreateTransaction != NULL)
		(NTCREATETRANSACTION)SYSTEMSERVICE(CREATETRANSACTION_7_INDEX) = oldNtCreateTransaction;

	if (oldNtCreateTransactionManager != NULL)
		(NTCREATETRANSACTIONMANAGER)SYSTEMSERVICE(CREATETRANSACTIONMANAGER_7_INDEX) = oldNtCreateTransactionManager;

	if (oldNtCreateWaitablePort != NULL)
		(NTCREATEWAITABLEPORT)SYSTEMSERVICE(CREATEWAITABLEPORT_7_INDEX) = oldNtCreateWaitablePort;

	if (oldNtCreateWorkerFactory != NULL)
		(NTCREATEWORKERFACTORY)SYSTEMSERVICE(CREATEWORKERFACTORY_7_INDEX) = oldNtCreateWorkerFactory;

	if (oldNtDebugContinue != NULL)
		(NTDEBUGCONTINUE)SYSTEMSERVICE(DEBUGCONTINUE_7_INDEX) = oldNtDebugContinue;

	if (oldNtDeleteAtom != NULL)
		(NTDELETEATOM)SYSTEMSERVICE(DELETEATOM_7_INDEX) = oldNtDeleteAtom;

	if (oldNtDeleteBootEntry != NULL)
		(NTDELETEBOOTENTRY)SYSTEMSERVICE(DELETEBOOTENTRY_7_INDEX) = oldNtDeleteBootEntry;

	if (oldNtDeleteDriverEntry != NULL)
		(NTDELETEDRIVERENTRY)SYSTEMSERVICE(DELETEDRIVERENTRY_7_INDEX) = oldNtDeleteDriverEntry;

	if (oldNtDeleteObjectAuditAlarm != NULL)
		(NTDELETEOBJECTAUDITALARM)SYSTEMSERVICE(DELETEOBJECTAUDITALARM_7_INDEX) = oldNtDeleteObjectAuditAlarm;

	if (oldNtDeletePrivateNamespace != NULL)
		(NTDELETEPRIVATENAMESPACE)SYSTEMSERVICE(DELETEPRIVATENAMESPACE_7_INDEX) = oldNtDeletePrivateNamespace;

	if (oldNtDisableLastKnownGood != NULL)
		(NTDISABLELASTKNOWNGOOD)SYSTEMSERVICE(DISABLELASTKNOWNGOOD_7_INDEX) = oldNtDisableLastKnownGood;

	if (oldNtDisplayString != NULL)
		(NTDISPLAYSTRING)SYSTEMSERVICE(DISPLAYSTRING_7_INDEX) = oldNtDisplayString;

	if (oldNtDrawText != NULL)
		(NTDRAWTEXT)SYSTEMSERVICE(DRAWTEXT_7_INDEX) = oldNtDrawText;

	if (oldNtEnableLastKnownGood != NULL)
		(NTENABLELASTKNOWNGOOD)SYSTEMSERVICE(ENABLELASTKNOWNGOOD_7_INDEX) = oldNtEnableLastKnownGood;

	if (oldNtEnumerateBootEntries != NULL)
		(NTENUMERATEBOOTENTRIES)SYSTEMSERVICE(ENUMERATEBOOTENTRIES_7_INDEX) = oldNtEnumerateBootEntries;

	if (oldNtEnumerateDriverEntries != NULL)
		(NTENUMERATEDRIVERENTRIES)SYSTEMSERVICE(ENUMERATEDRIVERENTRIES_7_INDEX) = oldNtEnumerateDriverEntries;

	if (oldNtEnumerateSystemEnvironmentValuesEx != NULL)
		(NTENUMERATESYSTEMENVIRONMENTVALUESEX)SYSTEMSERVICE(ENUMERATESYSTEMENVIRONMENTVALUESEX_7_INDEX) = oldNtEnumerateSystemEnvironmentValuesEx;

	if (oldNtEnumerateTransactionObject != NULL)
		(NTENUMERATETRANSACTIONOBJECT)SYSTEMSERVICE(ENUMERATETRANSACTIONOBJECT_7_INDEX) = oldNtEnumerateTransactionObject;

	if (oldNtExtendSection != NULL)
		(NTEXTENDSECTION)SYSTEMSERVICE(EXTENDSECTION_7_INDEX) = oldNtExtendSection;

	if (oldNtFilterToken != NULL)
		(NTFILTERTOKEN)SYSTEMSERVICE(FILTERTOKEN_7_INDEX) = oldNtFilterToken;

	if (oldNtFindAtom != NULL)
		(NTFINDATOM)SYSTEMSERVICE(FINDATOM_7_INDEX) = oldNtFindAtom;

	if (oldNtFlushWriteBuffer != NULL)
		(NTFLUSHWRITEBUFFER)SYSTEMSERVICE(FLUSHWRITEBUFFER_7_INDEX) = oldNtFlushWriteBuffer;

	if (oldNtFreeUserPhysicalPages != NULL)
		(NTFREEUSERPHYSICALPAGES)SYSTEMSERVICE(FREEUSERPHYSICALPAGES_7_INDEX) = oldNtFreeUserPhysicalPages;

	if (oldNtFreezeRegistry != NULL)
		(NTFREEZEREGISTRY)SYSTEMSERVICE(FREEZEREGISTRY_7_INDEX) = oldNtFreezeRegistry;

	if (oldNtFreezeTransactions != NULL)
		(NTFREEZETRANSACTIONS)SYSTEMSERVICE(FREEZETRANSACTIONS_7_INDEX) = oldNtFreezeTransactions;

	if (oldNtGetCurrentProcessorNumber != NULL)
		(NTGETCURRENTPROCESSORNUMBER)SYSTEMSERVICE(GETCURRENTPROCESSORNUMBER_7_INDEX) = oldNtGetCurrentProcessorNumber;

	if (oldNtGetDevicePowerState != NULL)
		(NTGETDEVICEPOWERSTATE)SYSTEMSERVICE(GETDEVICEPOWERSTATE_7_INDEX) = oldNtGetDevicePowerState;

	if (oldNtGetNextProcess != NULL)
		(NTGETNEXTPROCESS)SYSTEMSERVICE(GETNEXTPROCESS_7_INDEX) = oldNtGetNextProcess;

	if (oldNtGetNextThread != NULL)
		(NTGETNEXTTHREAD)SYSTEMSERVICE(GETNEXTTHREAD_7_INDEX) = oldNtGetNextThread;

	if (oldNtGetNlsSectionPtr != NULL)
		(NTGETNLSSECTIONPTR)SYSTEMSERVICE(GETNLSSECTIONPTR_7_INDEX) = oldNtGetNlsSectionPtr;

	if (oldNtGetNotificationResourceManager != NULL)
		(NTGETNOTIFICATIONRESOURCEMANAGER)SYSTEMSERVICE(GETNOTIFICATIONRESOURCEMANAGER_7_INDEX) = oldNtGetNotificationResourceManager;

	if (oldNtGetPlugPlayEvent != NULL)
		(NTGETPLUGPLAYEVENT)SYSTEMSERVICE(GETPLUGPLAYEVENT_7_INDEX) = oldNtGetPlugPlayEvent;

	if (oldNtGetWriteWatch != NULL)
		(NTGETWRITEWATCH)SYSTEMSERVICE(GETWRITEWATCH_7_INDEX) = oldNtGetWriteWatch;

	if (oldNtImpersonateAnonymousToken != NULL)
		(NTIMPERSONATEANONYMOUSTOKEN)SYSTEMSERVICE(IMPERSONATEANONYMOUSTOKEN_7_INDEX) = oldNtImpersonateAnonymousToken;

	if (oldNtInitializeNlsFiles != NULL)
		(NTINITIALIZENLSFILES)SYSTEMSERVICE(INITIALIZENLSFILES_7_INDEX) = oldNtInitializeNlsFiles;

	if (oldNtInitializeRegistry != NULL)
		(NTINITIALIZEREGISTRY)SYSTEMSERVICE(INITIALIZEREGISTRY_7_INDEX) = oldNtInitializeRegistry;

	if (oldNtInitiatePowerAction != NULL)
		(NTINITIATEPOWERACTION)SYSTEMSERVICE(INITIATEPOWERACTION_7_INDEX) = oldNtInitiatePowerAction;

	if (oldNtIsProcessInJob != NULL)
		(NTISPROCESSINJOB)SYSTEMSERVICE(ISPROCESSINJOB_7_INDEX) = oldNtIsProcessInJob;

	if (oldNtIsSystemResumeAutomatic != NULL)
		(NTISSYSTEMRESUMEAUTOMATIC)SYSTEMSERVICE(ISSYSTEMRESUMEAUTOMATIC_7_INDEX) = oldNtIsSystemResumeAutomatic;

	if (oldNtLoadKey != NULL)
		(NTLOADKEY)SYSTEMSERVICE(LOADKEY_7_INDEX) = oldNtLoadKey;

	if (oldNtLoadKey2 != NULL)
		(NTLOADKEY2)SYSTEMSERVICE(LOADKEY2_7_INDEX) = oldNtLoadKey2;

	if (oldNtLoadKeyEx != NULL)
		(NTLOADKEYEX)SYSTEMSERVICE(LOADKEYEX_7_INDEX) = oldNtLoadKeyEx;

	if (oldNtLockProductActivationKeys != NULL)
		(NTLOCKPRODUCTACTIVATIONKEYS)SYSTEMSERVICE(LOCKPRODUCTACTIVATIONKEYS_7_INDEX) = oldNtLockProductActivationKeys;

	if (oldNtLockRegistryKey != NULL)
		(NTLOCKREGISTRYKEY)SYSTEMSERVICE(LOCKREGISTRYKEY_7_INDEX) = oldNtLockRegistryKey;

	if (oldNtMakePermanentObject != NULL)
		(NTMAKEPERMANENTOBJECT)SYSTEMSERVICE(MAKEPERMANENTOBJECT_7_INDEX) = oldNtMakePermanentObject;

	if (oldNtMakeTemporaryObject != NULL)
		(NTMAKETEMPORARYOBJECT)SYSTEMSERVICE(MAKETEMPORARYOBJECT_7_INDEX) = oldNtMakeTemporaryObject;

	if (oldNtMapUserPhysicalPages != NULL)
		(NTMAPUSERPHYSICALPAGES)SYSTEMSERVICE(MAPUSERPHYSICALPAGES_7_INDEX) = oldNtMapUserPhysicalPages;

	if (oldNtMapUserPhysicalPagesScatter != NULL)
		(NTMAPUSERPHYSICALPAGESSCATTER)SYSTEMSERVICE(MAPUSERPHYSICALPAGESSCATTER_7_INDEX) = oldNtMapUserPhysicalPagesScatter;

	if (oldNtModifyBootEntry != NULL)
		(NTMODIFYBOOTENTRY)SYSTEMSERVICE(MODIFYBOOTENTRY_7_INDEX) = oldNtModifyBootEntry;

	if (oldNtModifyDriverEntry != NULL)
		(NTMODIFYDRIVERENTRY)SYSTEMSERVICE(MODIFYDRIVERENTRY_7_INDEX) = oldNtModifyDriverEntry;

	if (oldNtNotifyChangeDirectoryFile != NULL)
		(NTNOTIFYCHANGEDIRECTORYFILE)SYSTEMSERVICE(NOTIFYCHANGEDIRECTORYFILE_7_INDEX) = oldNtNotifyChangeDirectoryFile;

	if (oldNtNotifyChangeSession != NULL)
		(NTNOTIFYCHANGESESSION)SYSTEMSERVICE(NOTIFYCHANGESESSION_7_INDEX) = oldNtNotifyChangeSession;

	if (oldNtOpenEnlistment != NULL)
		(NTOPENENLISTMENT)SYSTEMSERVICE(OPENENLISTMENT_7_INDEX) = oldNtOpenEnlistment;

	if (oldNtOpenEventPair != NULL)
		(NTOPENEVENTPAIR)SYSTEMSERVICE(OPENEVENTPAIR_7_INDEX) = oldNtOpenEventPair;

	if (oldNtOpenIoCompletion != NULL)
		(NTOPENIOCOMPLETION)SYSTEMSERVICE(OPENIOCOMPLETION_7_INDEX) = oldNtOpenIoCompletion;

	if (oldNtOpenJobObject != NULL)
		(NTOPENJOBOBJECT)SYSTEMSERVICE(OPENJOBOBJECT_7_INDEX) = oldNtOpenJobObject;

	if (oldNtOpenKeyedEvent != NULL)
		(NTOPENKEYEDEVENT)SYSTEMSERVICE(OPENKEYEDEVENT_7_INDEX) = oldNtOpenKeyedEvent;

	if (oldNtOpenObjectAuditAlarm != NULL)
		(NTOPENOBJECTAUDITALARM)SYSTEMSERVICE(OPENOBJECTAUDITALARM_7_INDEX) = oldNtOpenObjectAuditAlarm;

	if (oldNtOpenPrivateNamespace != NULL)
		(NTOPENPRIVATENAMESPACE)SYSTEMSERVICE(OPENPRIVATENAMESPACE_7_INDEX) = oldNtOpenPrivateNamespace;

	if (oldNtOpenProcessToken != NULL)
		(NTOPENPROCESSTOKEN)SYSTEMSERVICE(OPENPROCESSTOKEN_7_INDEX) = oldNtOpenProcessToken;

	if (oldNtOpenResourceManager != NULL)
		(NTOPENRESOURCEMANAGER)SYSTEMSERVICE(OPENRESOURCEMANAGER_7_INDEX) = oldNtOpenResourceManager;

	if (oldNtOpenSemaphore != NULL)
		(NTOPENSEMAPHORE)SYSTEMSERVICE(OPENSEMAPHORE_7_INDEX) = oldNtOpenSemaphore;

	if (oldNtOpenSession != NULL)
		(NTOPENSESSION)SYSTEMSERVICE(OPENSESSION_7_INDEX) = oldNtOpenSession;

	if (oldNtOpenThreadToken != NULL)
		(NTOPENTHREADTOKEN)SYSTEMSERVICE(OPENTHREADTOKEN_7_INDEX) = oldNtOpenThreadToken;

	if (oldNtOpenTimer != NULL)
		(NTOPENTIMER)SYSTEMSERVICE(OPENTIMER_7_INDEX) = oldNtOpenTimer;

	if (oldNtOpenTransaction != NULL)
		(NTOPENTRANSACTION)SYSTEMSERVICE(OPENTRANSACTION_7_INDEX) = oldNtOpenTransaction;

	if (oldNtOpenTransactionManager != NULL)
		(NTOPENTRANSACTIONMANAGER)SYSTEMSERVICE(OPENTRANSACTIONMANAGER_7_INDEX) = oldNtOpenTransactionManager;

	if (oldNtPlugPlayControl != NULL)
		(NTPLUGPLAYCONTROL)SYSTEMSERVICE(PLUGPLAYCONTROL_7_INDEX) = oldNtPlugPlayControl;

	if (oldNtPrePrepareComplete != NULL)
		(NTPREPREPARECOMPLETE)SYSTEMSERVICE(PREPREPARECOMPLETE_7_INDEX) = oldNtPrePrepareComplete;

	if (oldNtPrePrepareEnlistment != NULL)
		(NTPREPREPAREENLISTMENT)SYSTEMSERVICE(PREPREPAREENLISTMENT_7_INDEX) = oldNtPrePrepareEnlistment;

	if (oldNtPrepareComplete != NULL)
		(NTPREPARECOMPLETE)SYSTEMSERVICE(PREPARECOMPLETE_7_INDEX) = oldNtPrepareComplete;

	if (oldNtPrepareEnlistment != NULL)
		(NTPREPAREENLISTMENT)SYSTEMSERVICE(PREPAREENLISTMENT_7_INDEX) = oldNtPrepareEnlistment;

	if (oldNtPrivilegeCheck != NULL)
		(NTPRIVILEGECHECK)SYSTEMSERVICE(PRIVILEGECHECK_7_INDEX) = oldNtPrivilegeCheck;

	if (oldNtPrivilegeObjectAuditAlarm != NULL)
		(NTPRIVILEGEOBJECTAUDITALARM)SYSTEMSERVICE(PRIVILEGEOBJECTAUDITALARM_7_INDEX) = oldNtPrivilegeObjectAuditAlarm;

	if (oldNtPrivilegedServiceAuditAlarm != NULL)
		(NTPRIVILEGEDSERVICEAUDITALARM)SYSTEMSERVICE(PRIVILEGEDSERVICEAUDITALARM_7_INDEX) = oldNtPrivilegedServiceAuditAlarm;

	if (oldNtPropagationComplete != NULL)
		(NTPROPAGATIONCOMPLETE)SYSTEMSERVICE(PROPAGATIONCOMPLETE_7_INDEX) = oldNtPropagationComplete;

	if (oldNtPropagationFailed != NULL)
		(NTPROPAGATIONFAILED)SYSTEMSERVICE(PROPAGATIONFAILED_7_INDEX) = oldNtPropagationFailed;

	if (oldNtPulseEvent != NULL)
		(NTPULSEEVENT)SYSTEMSERVICE(PULSEEVENT_7_INDEX) = oldNtPulseEvent;

	if (oldNtQueryBootEntryOrder != NULL)
		(NTQUERYBOOTENTRYORDER)SYSTEMSERVICE(QUERYBOOTENTRYORDER_7_INDEX) = oldNtQueryBootEntryOrder;

	if (oldNtQueryBootOptions != NULL)
		(NTQUERYBOOTOPTIONS)SYSTEMSERVICE(QUERYBOOTOPTIONS_7_INDEX) = oldNtQueryBootOptions;

	if (oldNtQueryDebugFilterState != NULL)
		(NTQUERYDEBUGFILTERSTATE)SYSTEMSERVICE(QUERYDEBUGFILTERSTATE_7_INDEX) = oldNtQueryDebugFilterState;

	if (oldNtQueryDefaultLocale != NULL)
		(NTQUERYDEFAULTLOCALE)SYSTEMSERVICE(QUERYDEFAULTLOCALE_7_INDEX) = oldNtQueryDefaultLocale;

	if (oldNtQueryDefaultUILanguage != NULL)
		(NTQUERYDEFAULTUILANGUAGE)SYSTEMSERVICE(QUERYDEFAULTUILANGUAGE_7_INDEX) = oldNtQueryDefaultUILanguage;

	if (oldNtQueryDirectoryObject != NULL)
		(NTQUERYDIRECTORYOBJECT)SYSTEMSERVICE(QUERYDIRECTORYOBJECT_7_INDEX) = oldNtQueryDirectoryObject;

	if (oldNtQueryDirectoryObject != NULL)
		(NTQUERYDIRECTORYOBJECT)SYSTEMSERVICE(QUERYDIRECTORYOBJECT_7_INDEX) = oldNtQueryDirectoryObject;

	if (oldNtQueryDriverEntryOrder != NULL)
		(NTQUERYDRIVERENTRYORDER)SYSTEMSERVICE(QUERYDRIVERENTRYORDER_7_INDEX) = oldNtQueryDriverEntryOrder;

	if (oldNtQueryInformationFile != NULL)
		(NTQUERYINFORMATIONFILE)SYSTEMSERVICE(QUERYINFORMATIONFILE_7_INDEX) = oldNtQueryInformationFile;

	if (oldNtQueryInformationEnlistment != NULL)
		(NTQUERYINFORMATIONENLISTMENT)SYSTEMSERVICE(QUERYINFORMATIONENLISTMENT_7_INDEX) = oldNtQueryInformationEnlistment;

	if (oldNtQueryInformationJobObject != NULL)
		(NTQUERYINFORMATIONJOBOBJECT)SYSTEMSERVICE(QUERYINFORMATIONJOBOBJECT_7_INDEX) = oldNtQueryInformationJobObject;

	if (oldNtQueryInformationResourceManager != NULL)
		(NTQUERYINFORMATIONRESOURCEMANAGER)SYSTEMSERVICE(QUERYINFORMATIONRESOURCEMANAGER_7_INDEX) = oldNtQueryInformationResourceManager;

	if (oldNtQueryInformationTransaction != NULL)
		(NTQUERYINFORMATIONTRANSACTION)SYSTEMSERVICE(QUERYINFORMATIONTRANSACTION_7_INDEX) = oldNtQueryInformationTransaction;

	if (oldNtQueryInformationTransactionManager != NULL)
		(NTQUERYINFORMATIONTRANSACTIONMANAGER)SYSTEMSERVICE(QUERYINFORMATIONTRANSACTIONMANAGER_7_INDEX) = oldNtQueryInformationTransactionManager;

	if (oldNtQueryInformationWorkerFactory != NULL)
		(NTQUERYINFORMATIONWORKERFACTORY)SYSTEMSERVICE(QUERYINFORMATIONWORKERFACTORY_7_INDEX) = oldNtQueryInformationWorkerFactory;

	if (oldNtQueryInstallUILanguage != NULL)
		(NTQUERYINSTALLUILANGUAGE)SYSTEMSERVICE(QUERYINSTALLUILANGUAGE_7_INDEX) = oldNtQueryInstallUILanguage;

	if (oldNtQueryIntervalProfile != NULL)
		(NTQUERYINTERVALPROFILE)SYSTEMSERVICE(QUERYINTERVALPROFILE_7_INDEX) = oldNtQueryIntervalProfile;

	if (oldNtQueryIoCompletion != NULL)
		(NTQUERYIOCOMPLETION)SYSTEMSERVICE(QUERYIOCOMPLETION_7_INDEX) = oldNtQueryIoCompletion;

	if (oldNtQueryOpenSubKeys != NULL)
		(NTQUERYOPENSUBKEYS)SYSTEMSERVICE(QUERYOPENSUBKEYS_7_INDEX) = oldNtQueryOpenSubKeys;

	if (oldNtQueryOpenSubKeysEx != NULL)
		(NTQUERYOPENSUBKEYSEX)SYSTEMSERVICE(QUERYOPENSUBKEYSEX_7_INDEX) = oldNtQueryOpenSubKeysEx;

	if (oldNtQueryInformationProcess != NULL)
		(NTQUERYINFORMATIONPROCESS)SYSTEMSERVICE(QUERYINFORMATIONPROCESS_7_INDEX) = oldNtQueryInformationProcess;

	if (oldNtQuerySection != NULL)
		(NTQUERYSECTION)SYSTEMSERVICE(QUERYSECTION_7_INDEX) = oldNtQuerySection;

	if (oldNtQuerySecurityAttributesToken != NULL)
		(NTQUERYSECURITYATTRIBUTESTOKEN)SYSTEMSERVICE(QUERYSECURITYATTRIBUTESTOKEN_7_INDEX) = oldNtQuerySecurityAttributesToken;

	if (oldNtQuerySemaphore != NULL)
		(NTQUERYSEMAPHORE)SYSTEMSERVICE(QUERYSEMAPHORE_7_INDEX) = oldNtQuerySemaphore;

	if (oldNtQuerySystemEnvironmentValue != NULL)
		(NTQUERYSYSTEMENVIRONMENTVALUE)SYSTEMSERVICE(QUERYSYSTEMENVIRONMENTVALUE_7_INDEX) = oldNtQuerySystemEnvironmentValue;

	if (oldNtQuerySystemEnvironmentValueEx != NULL)
		(NTQUERYSYSTEMENVIRONMENTVALUEEX)SYSTEMSERVICE(QUERYSYSTEMENVIRONMENTVALUEEX_7_INDEX) = oldNtQuerySystemEnvironmentValueEx;

	if (oldNtQuerySystemInformationEx != NULL)
		(NTQUERYSYSTEMINFORMATIONEX)SYSTEMSERVICE(QUERYSYSTEMINFORMATIONEX_7_INDEX) = oldNtQuerySystemInformationEx;

	if (oldNtQueryTimer != NULL)
		(NTQUERYTIMER)SYSTEMSERVICE(QUERYTIMER_7_INDEX) = oldNtQueryTimer;

	if (oldNtRaiseException != NULL)
		(NTRAISEEXCEPTION)SYSTEMSERVICE(RAISEEXCEPTION_7_INDEX) = oldNtRaiseException;

	if (oldNtRaiseHardError != NULL)
		(NTRAISEHARDERROR)SYSTEMSERVICE(RAISEHARDERROR_7_INDEX) = oldNtRaiseHardError;

	if (oldNtReadFileScatter != NULL)
		(NTREADFILESCATTER)SYSTEMSERVICE(READFILESCATTER_7_INDEX) = oldNtReadFileScatter;

	if (oldNtReadOnlyEnlistment != NULL)
		(NTREADONLYENLISTMENT)SYSTEMSERVICE(READONLYENLISTMENT_7_INDEX) = oldNtReadOnlyEnlistment;

	if (oldNtRecoverEnlistment != NULL)
		(NTRECOVERENLISTMENT)SYSTEMSERVICE(RECOVERENLISTMENT_7_INDEX) = oldNtRecoverEnlistment;

	if (oldNtRecoverResourceManager != NULL)
		(NTRECOVERRESOURCEMANAGER)SYSTEMSERVICE(RECOVERRESOURCEMANAGER_7_INDEX) = oldNtRecoverResourceManager;

	if (oldNtRecoverTransactionManager != NULL)
		(NTRECOVERTRANSACTIONMANAGER)SYSTEMSERVICE(RECOVERTRANSACTIONMANAGER_7_INDEX) = oldNtRecoverTransactionManager;

	if (oldNtRegisterProtocolAddressInformation != NULL)
		(NTREGISTERPROTOCOLADDRESSINFORMATION)SYSTEMSERVICE(REGISTERPROTOCOLADDRESSINFORMATION_7_INDEX) = oldNtRegisterProtocolAddressInformation;

	if (oldNtReleaseKeyedEvent != NULL)
		(NTRELEASEKEYEDEVENT)SYSTEMSERVICE(RELEASEKEYEDEVENT_7_INDEX) = oldNtReleaseKeyedEvent;

	if (oldNtReleaseSemaphore != NULL)
		(NTRELEASESEMAPHORE)SYSTEMSERVICE(RELEASESEMAPHORE_7_INDEX) = oldNtReleaseSemaphore;

	if (oldNtRemoveIoCompletion != NULL)
		(NTREMOVEIOCOMPLETION)SYSTEMSERVICE(REMOVEIOCOMPLETION_7_INDEX) = oldNtRemoveIoCompletion;

	if (oldNtRemoveProcessDebug != NULL)
		(NTREMOVEPROCESSDEBUG)SYSTEMSERVICE(REMOVEPROCESSDEBUG_7_INDEX) = oldNtRemoveProcessDebug;

	if (oldNtRenameTransactionManager != NULL)
		(NTRENAMETRANSACTIONMANAGER)SYSTEMSERVICE(RENAMETRANSACTIONMANAGER_7_INDEX) = oldNtRenameTransactionManager;

	if (oldNtReplaceKey != NULL)
		(NTREPLACEKEY)SYSTEMSERVICE(REPLACEKEY_7_INDEX) = oldNtReplaceKey;

	if (oldNtReplacePartitionUnit != NULL)
		(NTREPLACEPARTITIONUNIT)SYSTEMSERVICE(REPLACEPARTITIONUNIT_7_INDEX) = oldNtReplacePartitionUnit;

	if (oldNtReplyWaitReceivePortEx != NULL)
		(NTREPLYWAITRECEIVEPORTEX)SYSTEMSERVICE(REPLYWAITRECEIVEPORTEX_7_INDEX) = oldNtReplyWaitReceivePortEx;

	if (oldNtResetEvent != NULL)
		(NTRESETEVENT)SYSTEMSERVICE(RESETEVENT_7_INDEX) = oldNtResetEvent;

	if (oldNtResetWriteWatch != NULL)
		(NTRESETWRITEWATCH)SYSTEMSERVICE(RESETWRITEWATCH_7_INDEX) = oldNtResetWriteWatch;

	if (oldNtRestoreKey != NULL)
		(NTRESTOREKEY)SYSTEMSERVICE(RESTOREKEY_7_INDEX) = oldNtRestoreKey;

	if (oldNtResumeProcess != NULL)
		(NTRESUMEPROCESS)SYSTEMSERVICE(RESUMEPROCESS_7_INDEX) = oldNtResumeProcess;

	if (oldNtRollbackComplete != NULL)
		(NTROLLBACKCOMPLETE)SYSTEMSERVICE(ROLLBACKCOMPLETE_7_INDEX) = oldNtRollbackComplete;

	if (oldNtRollbackEnlistment != NULL)
		(NTROLLBACKENLISTMENT)SYSTEMSERVICE(ROLLBACKENLISTMENT_7_INDEX) = oldNtRollbackEnlistment;

	if (oldNtRollbackTransaction != NULL)
		(NTROLLBACKTRANSACTION)SYSTEMSERVICE(ROLLBACKTRANSACTION_7_INDEX) = oldNtRollbackTransaction;

	if (oldNtRollforwardTransactionManager != NULL)
		(NTROLLFORWARDTRANSACTIONMANAGER)SYSTEMSERVICE(ROLLFORWARDTRANSACTIONMANAGER_7_INDEX) = oldNtRollforwardTransactionManager;

	if (oldNtSaveKey != NULL)
		(NTSAVEKEY)SYSTEMSERVICE(SAVEKEY_7_INDEX) = oldNtSaveKey;

	if (oldNtSaveKeyEx != NULL)
		(NTSAVEKEYEX)SYSTEMSERVICE(SAVEKEYEX_7_INDEX) = oldNtSaveKeyEx;

	if (oldNtSaveMergedKeys != NULL)
		(NTSAVEMERGEDKEYS)SYSTEMSERVICE(SAVEMERGEDKEYS_7_INDEX) = oldNtSaveMergedKeys;

	if (oldNtSecureConnectPort != NULL)
		(NTSECURECONNECTPORT)SYSTEMSERVICE(SECURECONNECTPORT_7_INDEX) = oldNtSecureConnectPort;

	if (oldNtSerializeBoot != NULL)
		(NTSERIALIZEBOOT)SYSTEMSERVICE(SERIALIZEBOOT_7_INDEX) = oldNtSerializeBoot;

	if (oldNtSetBootEntryOrder != NULL)
		(NTSETBOOTENTRYORDER)SYSTEMSERVICE(SETBOOTENTRYORDER_7_INDEX) = oldNtSetBootEntryOrder;

	if (oldNtSetBootOptions != NULL)
		(NTSETBOOTOPTIONS)SYSTEMSERVICE(SETBOOTOPTIONS_7_INDEX) = oldNtSetBootOptions;

	if (oldNtSetDebugFilterState != NULL)
		(NTSETDEBUGFILTERSTATE)SYSTEMSERVICE(SETDEBUGFILTERSTATE_7_INDEX) = oldNtSetDebugFilterState;

	if (oldNtSetDefaultHardErrorPort != NULL)
		(NTSETDEFAULTHARDERRORPORT)SYSTEMSERVICE(SETDEFAULTHARDERRORPORT_7_INDEX) = oldNtSetDefaultHardErrorPort;

	if (oldNtSetDefaultLocale != NULL)
		(NTSETDEFAULTLOCALE)SYSTEMSERVICE(SETDEFAULTLOCALE_7_INDEX) = oldNtSetDefaultLocale;

	if (oldNtSetDefaultUILanguage != NULL)
		(NTSETDEFAULTUILANGUAGE)SYSTEMSERVICE(SETDEFAULTUILANGUAGE_7_INDEX) = oldNtSetDefaultUILanguage;

	if (oldNtSetDriverEntryOrder != NULL)
		(NTSETDRIVERENTRYORDER)SYSTEMSERVICE(SETDRIVERENTRYORDER_7_INDEX) = oldNtSetDriverEntryOrder;

	if (oldNtSetEventBoostPriority != NULL)
		(NTSETEVENTBOOSTPRIORITY)SYSTEMSERVICE(SETEVENTBOOSTPRIORITY_7_INDEX) = oldNtSetEventBoostPriority;

	if (oldNtSetHighEventPair != NULL)
		(NTSETHIGHEVENTPAIR)SYSTEMSERVICE(SETHIGHEVENTPAIR_7_INDEX) = oldNtSetHighEventPair;

	if (oldNtSetHighWaitLowEventPair != NULL)
		(NTSETHIGHWAITLOWEVENTPAIR)SYSTEMSERVICE(SETHIGHWAITLOWEVENTPAIR_7_INDEX) = oldNtSetHighWaitLowEventPair;

	if (oldNtSetInformationDebugObject != NULL)
		(NTSETINFORMATIONDEBUGOBJECT)SYSTEMSERVICE(SETINFORMATIONDEBUGOBJECT_7_INDEX) = oldNtSetInformationDebugObject;

	if (oldNtSetInformationEnlistment != NULL)
		(NTSETINFORMATIONENLISTMENT)SYSTEMSERVICE(SETINFORMATIONENLISTMENT_7_INDEX) = oldNtSetInformationEnlistment;

	if (oldNtSetInformationJobObject != NULL)
		(NTSETINFORMATIONJOBOBJECT)SYSTEMSERVICE(SETINFORMATIONJOBOBJECT_7_INDEX) = oldNtSetInformationJobObject;

	if (oldNtSetInformationObject != NULL)
		(NTSETINFORMATIONOBJECT)SYSTEMSERVICE(SETINFORMATIONOBJECT_7_INDEX) = oldNtSetInformationObject;

	if (oldNtSetInformationResourceManager != NULL)
		(NTSETINFORMATIONRESOURCEMANAGER)SYSTEMSERVICE(SETINFORMATIONRESOURCEMANAGER_7_INDEX) = oldNtSetInformationResourceManager;

	if (oldNtSetInformationTransaction != NULL)
		(NTSETINFORMATIONTRANSACTION)SYSTEMSERVICE(SETINFORMATIONTRANSACTION_7_INDEX) = oldNtSetInformationTransaction;

	if (oldNtSetInformationTransactionManager != NULL)
		(NTSETINFORMATIONTRANSACTIONMANAGER)SYSTEMSERVICE(SETINFORMATIONTRANSACTIONMANAGER_7_INDEX) = oldNtSetInformationTransactionManager;

	if (oldNtSetInformationWorkerFactory != NULL)
		(NTSETINFORMATIONWORKERFACTORY)SYSTEMSERVICE(SETINFORMATIONWORKERFACTORY_7_INDEX) = oldNtSetInformationWorkerFactory;

	if (oldNtSetIntervalProfile != NULL)
		(NTSETINTERVALPROFILE)SYSTEMSERVICE(SETINTERVALPROFILE_7_INDEX) = oldNtSetIntervalProfile;

	if (oldNtSetIoCompletion != NULL)
		(NTSETIOCOMPLETION)SYSTEMSERVICE(SETIOCOMPLETION_7_INDEX) = oldNtSetIoCompletion;

	if (oldNtSetLdtEntries != NULL)
		(NTSETLDTENTRIES)SYSTEMSERVICE(SETLDTENTRIES_7_INDEX) = oldNtSetLdtEntries;

	if (oldNtSetLowEventPair != NULL)
		(NTSETLOWEVENTPAIR)SYSTEMSERVICE(SETLOWEVENTPAIR_7_INDEX) = oldNtSetLowEventPair;

	if (oldNtSetLowWaitHighEventPair != NULL)
		(NTSETLOWWAITHIGHEVENTPAIR)SYSTEMSERVICE(SETLOWWAITHIGHEVENTPAIR_7_INDEX) = oldNtSetLowWaitHighEventPair;

	if (oldNtSetSystemEnvironmentValue != NULL)
		(NTSETSYSTEMENVIRONMENTVALUE)SYSTEMSERVICE(SETSYSTEMENVIRONMENTVALUE_7_INDEX) = oldNtSetSystemEnvironmentValue;

	if (oldNtSetSystemEnvironmentValueEx != NULL)
		(NTSETSYSTEMENVIRONMENTVALUEEX)SYSTEMSERVICE(SETSYSTEMENVIRONMENTVALUEEX_7_INDEX) = oldNtSetSystemEnvironmentValueEx;

	if (oldNtSetSystemInformation != NULL)
		(NTSETSYSTEMINFORMATION)SYSTEMSERVICE(SETSYSTEMINFORMATION_7_INDEX) = oldNtSetSystemInformation;

	if (oldNtSetSystemPowerState != NULL)
		(NTSETSYSTEMPOWERSTATE)SYSTEMSERVICE(SETSYSTEMPOWERSTATE_7_INDEX) = oldNtSetSystemPowerState;

	if (oldNtSetThreadExecutionState != NULL)
		(NTSETTHREADEXECUTIONSTATE)SYSTEMSERVICE(SETTHREADEXECUTIONSTATE_7_INDEX) = oldNtSetThreadExecutionState;

	if (oldNtSetTimer != NULL)
		(NTSETTIMER)SYSTEMSERVICE(SETTIMER_7_INDEX) = oldNtSetTimer;

	if (oldNtSetUuidSeed != NULL)
		(NTSETUUIDSEED)SYSTEMSERVICE(SETUUIDSEED_7_INDEX) = oldNtSetUuidSeed;

	if (oldNtShutdownSystem != NULL)
		(NTSHUTDOWNSYSTEM)SYSTEMSERVICE(SHUTDOWNSYSTEM_7_INDEX) = oldNtShutdownSystem;

	if (oldNtShutdownWorkerFactory != NULL)
		(NTSHUTDOWNWORKERFACTORY)SYSTEMSERVICE(SHUTDOWNWORKERFACTORY_7_INDEX) = oldNtShutdownWorkerFactory;

	if (oldNtSignalAndWaitForSingleObject != NULL)
		(NTSIGNALANDWAITFORSINGLEOBJECT)SYSTEMSERVICE(SIGNALANDWAITFORSINGLEOBJECT_7_INDEX) = oldNtSignalAndWaitForSingleObject;

	if (oldNtSinglePhaseReject != NULL)
		(NTSINGLEPHASEREJECT)SYSTEMSERVICE(SINGLEPHASEREJECT_7_INDEX) = oldNtSinglePhaseReject;

	if (oldNtStartProfile != NULL)
		(NTSTARTPROFILE)SYSTEMSERVICE(STARTPROFILE_7_INDEX) = oldNtStartProfile;

	if (oldNtStopProfile != NULL)
		(NTSTOPPROFILE)SYSTEMSERVICE(STOPPROFILE_7_INDEX) = oldNtStopProfile;

	if (oldNtSuspendProcess != NULL)
		(NTSUSPENDPROCESS)SYSTEMSERVICE(SUSPENDPROCESS_7_INDEX) = oldNtSuspendProcess;

	if (oldNtTerminateJobObject != NULL)
		(NTTERMINATEJOBOBJECT)SYSTEMSERVICE(TERMINATEJOBOBJECT_7_INDEX) = oldNtTerminateJobObject;

	if (oldNtTestAlert != NULL)
		(NTTESTALERT)SYSTEMSERVICE(TESTALERT_7_INDEX) = oldNtTestAlert;

	if (oldNtThawRegistry != NULL)
		(NTTHAWREGISTRY)SYSTEMSERVICE(THAWREGISTRY_7_INDEX) = oldNtThawRegistry;

	if (oldNtThawTransactions != NULL)
		(NTTHAWTRANSACTIONS)SYSTEMSERVICE(THAWTRANSACTIONS_7_INDEX) = oldNtThawTransactions;

	if (oldNtTraceControl != NULL)
		(NTTRACECONTROL)SYSTEMSERVICE(TRACECONTROL_7_INDEX) = oldNtTraceControl;

	if (oldNtTraceEvent != NULL)
		(NTTRACEEVENT)SYSTEMSERVICE(TRACEEVENT_7_INDEX) = oldNtTraceEvent;

	if (oldNtTranslateFilePath != NULL)
		(NTTRANSLATEFILEPATH)SYSTEMSERVICE(TRANSLATEFILEPATH_7_INDEX) = oldNtTranslateFilePath;

	if (oldNtUmsThreadYield != NULL)
		(NTUMSTHREADYIELD)SYSTEMSERVICE(UMSTHREADYIELD_7_INDEX) = oldNtUmsThreadYield;

	if (oldNtUnloadKey != NULL)
		(NTUNLOADKEY)SYSTEMSERVICE(UNLOADKEY_7_INDEX) = oldNtUnloadKey;

	if (oldNtUnloadKey2 != NULL)
		(NTUNLOADKEY2)SYSTEMSERVICE(UNLOADKEY2_7_INDEX) = oldNtUnloadKey2;

	if (oldNtUnloadKeyEx != NULL)
		(NTUNLOADKEYEX)SYSTEMSERVICE(UNLOADKEYEX_7_INDEX) = oldNtUnloadKeyEx;

	if (oldNtVdmControl != NULL)
		(NTVDMCONTROL)SYSTEMSERVICE(VDMCONTROL_7_INDEX) = oldNtVdmControl;

	if (oldNtWaitForDebugEvent != NULL)
		(NTWAITFORDEBUGEVENT)SYSTEMSERVICE(WAITFORDEBUGEVENT_7_INDEX) = oldNtWaitForDebugEvent;

	if (oldNtWaitForKeyedEvent != NULL)
		(NTWAITFORKEYEDEVENT)SYSTEMSERVICE(WAITFORKEYEDEVENT_7_INDEX) = oldNtWaitForKeyedEvent;

	if (oldNtWaitForMultipleObjects != NULL)
		(NTWAITFORMULTIPLEOBJECTS)SYSTEMSERVICE(WAITFORMULTIPLEOBJECTS_7_INDEX) = oldNtWaitForMultipleObjects;

	if (oldNtWaitForMultipleObjects32 != NULL)
		(NTWAITFORMULTIPLEOBJECTS32)SYSTEMSERVICE(WAITFORMULTIPLEOBJECTS32_7_INDEX) = oldNtWaitForMultipleObjects32;

	if (oldNtSetLowWaitHighEventPair != NULL)
		(NTSETLOWWAITHIGHEVENTPAIR)SYSTEMSERVICE(SETLOWWAITHIGHEVENTPAIR_7_INDEX) = oldNtSetLowWaitHighEventPair;

	if (oldNtWaitLowEventPair != NULL)
		(NTWAITLOWEVENTPAIR)SYSTEMSERVICE(WAITLOWEVENTPAIR_7_INDEX) = oldNtWaitLowEventPair;

	if (oldNtWorkerFactoryWorkerReady != NULL)
		(NTWORKERFACTORYWORKERREADY)SYSTEMSERVICE(WORKERFACTORYWORKERREADY_7_INDEX) = oldNtWorkerFactoryWorkerReady;

	if (oldNtWriteFileGather != NULL)
		(NTWRITEFILEGATHER)SYSTEMSERVICE(WRITEFILEGATHER_7_INDEX) = oldNtWriteFileGather;

	if (oldNtYieldExecution != NULL)
		(NTYIELDEXECUTION)SYSTEMSERVICE(YIELDEXECUTION_7_INDEX) = oldNtYieldExecution;

	enable_cr0();
}

VOID SyscallInforPrint(ULONG SyscallNum)
{
	ULONG currentPid;
	int i = 0;
	currentPid = (ULONG)PsGetCurrentProcessId();
	for(i = 0; i<FILTERPIDCNT; i++){
		if(filterPids[i] == 0 )	break;
		if(filterPids[i] == currentPid)	return;
	}
	DbgPrint("%x \n",SyscallNum);
}

ULONG GenRandom(VOID){
    LARGE_INTEGER TickCount;
    ULONG RandomValue;
    KeQueryTickCount(&TickCount);
	KsecRandomSeed ^= _rotl(TickCount.LowPart, (KsecRandomSeed % 100));
	RandomValue = RtlRandomEx(&KsecRandomSeed) % 100;
	//DbgPrint("Random is %d\n\n", RandomValue);
    return RandomValue;
}

VOID sleepms(ULONG msecs){
	KTIMER Timer;
	LARGE_INTEGER DueTime;
	ULONG currentPid;
	int i = 0;
	currentPid = (ULONG)PsGetCurrentProcessId();
	for(i = 0; i<FILTERPIDCNT; i++){
		if(strategyPids[i] == 0){
			break;
		}
		if(strategyPids[i] == currentPid){
			if(GenRandom() <= THRESHOLD){
				DueTime.QuadPart = msecs * 10000 * (-1);
				//DbgPrint("QuadPart is %I64u \n", DueTime.QuadPart);
				KeInitializeTimer(&Timer);
				KeSetTimer(&Timer, DueTime, NULL);
				KeWaitForSingleObject(&Timer, Executive, KernelMode, FALSE, NULL);
			}
		}
	}
}

BOOLEAN silence(ULONG SyscallNum, ULONG StrategyNum){
	ULONG currentPid;
	int i = 0;
	currentPid = (ULONG)PsGetCurrentProcessId();
	for(i = 0; i<FILTERPIDCNT; i++){
		if(strategyPids[i] == 0){
			return FALSE;
		}
		if(strategyPids[i] == currentPid){
			if(GenRandom() <= THRESHOLD){
				DbgPrint("s%d \n\n", StrategyNum);
				return TRUE;
			}
		}
	}
	return FALSE;
}

//Not Used
VOID PrintHandle(ULONG FileHandle, ULONG Type){
	ULONG currentPid;
	int i = 0;
	currentPid = (ULONG)PsGetCurrentProcessId();
	for(i = 0; i<FILTERPIDCNT; i++){
		if(strategyPids[i] == 0 && FileHandle > 0){
			DbgPrint("T%d handle %d \n\n", Type, FileHandle);
			return;
		}
		if(strategyPids[i] == currentPid && FileHandle > 0){
			DbgPrint("T%d handle %d \n\n", Type, FileHandle);
			return;
		}
	}
}

PBOOLEAN PrivilegeDegrade(PBOOLEAN Result){
	ULONG currentPid;
	int i = 0;
	currentPid = (ULONG)PsGetCurrentProcessId();
	for(i = 0; i<FILTERPIDCNT; i++){
		if(strategyPids[i] == 0){
			break;
		}
		if(strategyPids[i] == currentPid){
			if(GenRandom() <= THRESHOLD){
				*Result = FALSE;
				//DbgPrint("PrivilegeCheck result %d \n\n", *Result);   // 1: true; 0: false;
			}
			break;
		}
	}
	return Result;
}

BOOLEAN SilentNonCritical(ULONG FileHandle, POBJECT_ATTRIBUTES ObjectAttributes){
	ULONG currentPid;
	int i = 0, len =0;
	PWCHAR pch;
	currentPid = (ULONG)PsGetCurrentProcessId();
	for(i = 0; i<FILTERPIDCNT; i++){
		if(strategyPids[i] == 0 || FileHandle <= 0)	
			return FALSE;
		if(strategyPids[i] == currentPid && FileHandle > 0){
			if(ObjectAttributes->ObjectName->Length > 5){
				pch = ObjectAttributes->ObjectName->Buffer;
				// the critical path here is \??\c:\Windows\ 
				if(*pch == L'\\' && (*(pch+4) == L'c' || *(pch+4) == L'C') && (*(pch+7) == L'W' || *(pch+7) == L'w')){
					if(GenRandom() <= THRESHOLD)
						DbgPrint("s0 \n\n");
						return TRUE;
				}
			}
			return FALSE;
		}
	}
	return FALSE;
}

// Not Used
VOID PrintObject(ULONG FileHandle, POBJECT_ATTRIBUTES ObjectAttributes){
	ULONG currentPid;
	int i = 0, len =0;
	PWCHAR pch;
	currentPid = (ULONG)PsGetCurrentProcessId();
	
	// the critical path here is \??\c:\Windows\ 
	for(i = 0; i<FILTERPIDCNT; i++){
		if(strategyPids[i] == 0 || FileHandle <= 0)	
			return;
		if(strategyPids[i] == currentPid && FileHandle > 0){
			//DbgPrint("%S \n\n", ObjectAttributes->ObjectName->Buffer);
			if(ObjectAttributes->ObjectName->Length > 5){
				pch = ObjectAttributes->ObjectName->Buffer;
				// the critical path here is \??\c:\Windows\ 
				if(*pch == L'\\' && (*(pch+4) == L'c' || *(pch+4) == L'C') && (*(pch+7) == L'W' || *(pch+7) == L'w')){
					//DbgPrint("%S \n\n", ObjectAttributes->ObjectName->Buffer);
					return;
				}
			}
		}else{

		}
		return;
	}
}


PLARGE_INTEGER LimitSize(ULONG size){
	LARGE_INTEGER test;
	ULONG currentPid;
	int i = 0;
	currentPid = (ULONG)PsGetCurrentProcessId();
	test.QuadPart = 0;
	for(i = 0; i<FILTERPIDCNT; i++){
		//if(intrusivePids[i] == 0){
		if(strategyPids[i] == 0){
			break;
		}
		if(strategyPids[i] == currentPid){
			if(GenRandom() <= THRESHOLD){
				test.HighPart = 65536*6666;
				test.LowPart = 65536;
				//test.QuadPart = size * 10000 * (-1);
				// DbgPrint("QuadPart is %I64u \n", test.QuadPart);
				DbgPrint("s1 \n\n");
			}
			break;
		}
	}
	return &test;

}

//Not used
ULONG ReduceSize(ULONG size){
	ULONG currentPid;
	int i = 0;
	currentPid = (ULONG)PsGetCurrentProcessId();
	for(i = 0; i<FILTERPIDCNT; i++){
		if(intrusivePids[i] == 0){
			return size;
		}
		if(intrusivePids[i] == currentPid){
			if(GenRandom() <= THRESHOLD){
				size = size /2;
				//DbgPrint("Cut size\n\n");
				return size;
			}
		}
	}
	return size;
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		get Shadow table address
//	Parameters :
//		None
////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
pServiceDescriptorTableEntry getShadowTableAddress()   
{   
	PUCHAR c;
	for(c = (PUCHAR)&KeAddSystemServiceTable; c < (PUCHAR)&KeAddSystemServiceTable + PAGE_SIZE; c++)
	{
		if(*(PUSHORT)c == 0x888d)
			return *(PVOID*)(c+2);
	}
	return NULL;
}   

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs thread opening, and hides specific processes from the monitored processes.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/bb432382(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtOpenThread(PHANDLE ThreadHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PCLIENT_ID ClientID)
{
	if(silence(OPENTHREAD_7_INDEX,3))	return STATUS_SUCCESS;
	SyscallInforPrint(OPENTHREAD_7_INDEX);
	return ((NTOPENTHREAD)(oldNtOpenThread))(ThreadHandle, DesiredAccess, ObjectAttributes, ClientID);
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process opening (mandatory for most of code injection techniques), and hides specific
//		processes from the monitored processes.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff567022(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtOpenProcess(PHANDLE ProcessHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PCLIENT_ID ClientID)
{	
	if(silence(OPENPROCESS_7_INDEX,3))	return STATUS_SUCCESS;
	SyscallInforPrint(OPENPROCESS_7_INDEX);
	return ((NTOPENPROCESS)(oldNtOpenProcess))(ProcessHandle, DesiredAccess, ObjectAttributes, ClientID);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process information retrieval, and hides specific processes from the monitored processes.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/desktop/ms725506(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtQuerySystemInformation(SYSTEM_INFORMATION_CLASS SystemInformationClass, PVOID SystemInformation, ULONG SystemInformationLength, PULONG ReturnLength)
{
	if(silence(QUERYSYSTEMINFORMATION_7_INDEX,3))		return STATUS_SUCCESS;
	SyscallInforPrint(QUERYSYSTEMINFORMATION_7_INDEX);
	return ((NTQUERYSYSTEMINFORMATION)(oldNtQuerySystemInformation))(SystemInformationClass, SystemInformation, SystemInformationLength, ReturnLength);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs virtual memory read.
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/Memory%20Management/Virtual%20Memory/NtReadVirtualMemory.html
NTSTATUS newNtReadVirtualMemory(HANDLE ProcessHandle, PVOID BaseAddress, PVOID Buffer, ULONG NumberOfBytesToRead, PULONG NumberOfBytesReaded)
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
{
	//NumberOfBytesToRead = ReduceSize(NumberOfBytesToRead);
	//DbgPrint("read virtual memory bf %s \n\n", Buffer);   // cause BSOD;
	SyscallInforPrint(READVIRTUALMEMORY_7_INDEX);
	return ((NTREADVIRTUALMEMORY)(oldNtReadVirtualMemory))(ProcessHandle, BaseAddress, Buffer, NumberOfBytesToRead, NumberOfBytesReaded);
	
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs virtual memory modification.
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/Memory%20Management/Virtual%20Memory/NtWriteVirtualMemory.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtWriteVirtualMemory(HANDLE ProcessHandle, PVOID BaseAddress, PVOID Buffer, ULONG NumberOfBytesToWrite, PULONG NumberOfBytesWritten)
{
	//NumberOfBytesToWrite = ReduceSize(NumberOfBytesToWrite);
	//DbgPrint("write virtual memory bf %s \n\n", Buffer);  // cause BSOD;
	SyscallInforPrint(WRITEVIRTUALMEMORY_7_INDEX);
	return ((NTWRITEVIRTUALMEMORY)(oldNtWriteVirtualMemory))(ProcessHandle, BaseAddress, Buffer, NumberOfBytesToWrite, NumberOfBytesWritten);
	
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process debugging (may be used for code injection).
//	Parameters :
//		See http://www.openrce.org/articles/full_view/26
// DIDN'T HOOKED
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtDebugActiveProcess(HANDLE ProcessHandle, HANDLE DebugHandle)
{
	SyscallInforPrint(DEBUGACTIVEPROCESS_7_INDEX);
	return ((NTDEBUGACTIVEPROCESS)(oldNtDebugActiveProcess))(ProcessHandle, DebugHandle);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process name creation.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff566428%28v=vs.85%29.aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateSection(PHANDLE SectionHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PLARGE_INTEGER MaximumSize, ULONG SectionPageProtection, ULONG AllocationAttributes, HANDLE FileHandle)
{
	LARGE_INTEGER test;
	SyscallInforPrint(CREATESECTION_7_INDEX);
	
	test = *LimitSize(9999);
	if(test.QuadPart == 0){
		return ((NTCREATESECTION)(oldNtCreateSection))(SectionHandle, DesiredAccess, ObjectAttributes, MaximumSize, SectionPageProtection, AllocationAttributes, FileHandle);
	}
	return ((NTCREATESECTION)(oldNtCreateSection))(SectionHandle, DesiredAccess, ObjectAttributes, MaximumSize, SectionPageProtection, AllocationAttributes, FileHandle);
	//return ((NTCREATESECTION)(oldNtCreateSection))(SectionHandle, DesiredAccess, ObjectAttributes, &test, SectionPageProtection, AllocationAttributes, FileHandle);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process creation.
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Process/NtCreateProcess.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateProcess(PHANDLE ProcessHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ParentProcess, BOOLEAN InheritObjectTable, HANDLE SectionHandle, HANDLE DebugPort, HANDLE ExceptionPort)
{
	SyscallInforPrint(CREATEPROCESS_7_INDEX);
	return ((NTCREATEPROCESS)(oldNtCreateProcess))(ProcessHandle, DesiredAccess, ObjectAttributes, ParentProcess, InheritObjectTable, SectionHandle, DebugPort, ExceptionPort);
	
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process creation.
//	Parameters :
//		See http://www.tech-archive.net/Archive/Development/microsoft.public.win32.programmer.kernel/2004-02/0195.html (lulz)
////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateProcessEx(PHANDLE ProcessHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE InheritFromProcessHandle, BOOLEAN InheritHandles, HANDLE SectionHandle, HANDLE DebugPort, HANDLE ExceptionPort, HANDLE dunno)
{
	SyscallInforPrint(CREATEPROCESSEX_7_INDEX);
	return ((NTCREATEPROCESSEX)(oldNtCreateProcessEx))(ProcessHandle, DesiredAccess, ObjectAttributes, InheritFromProcessHandle, InheritHandles, SectionHandle, DebugPort, ExceptionPort, dunno);	 
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs thread-based Asynchronous Procedure Call creation (may be used for code injection).
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/APC/NtQueueApcThread.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtQueueApcThread(HANDLE ThreadHandle, PIO_APC_ROUTINE ApcRoutine, PVOID ApcRoutineContext, PIO_STATUS_BLOCK ApcStatusBlock, ULONG ApcReserved)
{
	if(silence(QUEUEAPCTHREAD_7_INDEX,3))	return STATUS_SUCCESS;
	SyscallInforPrint(QUEUEAPCTHREAD_7_INDEX);
	return ((NTQUEUEAPCTHREAD)(oldNtQueueApcThread))(ThreadHandle, ApcRoutine, ApcRoutineContext, ApcStatusBlock, ApcReserved);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs thread creation.
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Thread/NtCreateThread.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateThread(PHANDLE ThreadHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ProcessHandle, PCLIENT_ID ClientID, PCONTEXT ThreadContext, PINITIAL_TEB InitialTeb, BOOLEAN CreateSuspended)
{
	SyscallInforPrint(CREATETHREAD_7_INDEX);
	return ((NTCREATETHREAD)(oldNtCreateThread))(ThreadHandle, DesiredAccess, ObjectAttributes, ProcessHandle, ClientID, ThreadContext, InitialTeb, CreateSuspended);
	
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs thread creation.
//	Parameters :
//		See http://securityxploded.com/ntcreatethreadex.php (lulz)
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateThreadEx(PHANDLE ThreadHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ProcessHandle, PVOID StartAddress, PVOID Parameter, BOOLEAN CreateSuspended, ULONG StackZeroBits, ULONG SizeOfStackCommit, ULONG SizeOfStackReserve, PVOID BytesBuffer)
{
	SyscallInforPrint(CREATETHREADEX_7_INDEX);
	return ((NTCREATETHREADEX)(oldNtCreateThreadEx))(ThreadHandle, DesiredAccess, ObjectAttributes, ProcessHandle, StartAddress, Parameter, CreateSuspended, StackZeroBits, SizeOfStackCommit, SizeOfStackReserve, BytesBuffer);
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs section mapping (may be used for code injection).
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff566481(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtMapViewOfSection(HANDLE SectionHandle, HANDLE ProcessHandle, PVOID *BaseAddress, ULONG_PTR ZeroBits, SIZE_T CommitSize, PLARGE_INTEGER SectionOffset, PSIZE_T ViewSize, SECTION_INHERIT InheritDisposition, ULONG AllocationType, ULONG Win32Protect)
{
	SyscallInforPrint(MAPVIEWOFSECTION_7_INDEX);
	return ((NTMAPVIEWOFSECTION)(oldNtMapViewOfSection))(SectionHandle, ProcessHandle, BaseAddress, ZeroBits, CommitSize, SectionOffset, ViewSize, InheritDisposition, AllocationType, Win32Protect);
	
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs thread context manipulation (may be used for code injection).
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Thread/Thread%20Context/NtSetContextThread.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtSetContextThread(HANDLE ThreadHandle, PCONTEXT Context)
{
	SyscallInforPrint(SETCONTEXTTHREAD_7_INDEX);
	return ((NTSETCONTEXTTHREAD)(oldNtSetContextThread))(ThreadHandle, Context);

}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process debugging operations (may be used for code injection).
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/Debug/NtSystemDebugControl.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtSystemDebugControl(SYSDBG_COMMAND Command, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, PULONG ReturnLength)
{
	SyscallInforPrint(SYSTEMDEBUGCONTROL_7_INDEX);
	//ReduceSize(OutputBufferLength);
	return ((NTSYSTEMDEBUGCONTROL)(oldNtSystemDebugControl))(Command, InputBuffer, InputBufferLength, OutputBuffer, OutputBufferLength, ReturnLength);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs file opening.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/bb432381(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtOpenFile(PHANDLE FileHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PIO_STATUS_BLOCK IoStatusBlock, ULONG ShareAccess, ULONG OpenOptions)
{
	SyscallInforPrint(OPENFILE_7_INDEX);
	if(SilentNonCritical((ULONG)*FileHandle, ObjectAttributes))	
		sleepms(SLEEPTIME);
	return ((NTOPENFILE)(oldNtOpenFile))(FileHandle, DesiredAccess, ObjectAttributes, IoStatusBlock, ShareAccess, OpenOptions);
}	

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs file creation and/or file opening.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff566424(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateFile(PHANDLE FileHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PIO_STATUS_BLOCK IoStatusBlock, PLARGE_INTEGER AllocationSize, ULONG FileAttributes, ULONG ShareAccess, ULONG CreateDisposition, ULONG CreateOptions, PVOID EaBuffer, ULONG EaLength)
{
	SyscallInforPrint(CREATEFILE_7_INDEX);
	if(SilentNonCritical((ULONG)*FileHandle, ObjectAttributes))	
		sleepms(SLEEPTIME);
	return ((NTCREATEFILE)(oldNtCreateFile))(FileHandle, DesiredAccess, ObjectAttributes, IoStatusBlock, AllocationSize, FileAttributes, ShareAccess, CreateDisposition, CreateOptions, EaBuffer, EaLength);
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs file deletion.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff566435(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtDeleteFile(POBJECT_ATTRIBUTES ObjectAttributes)
{
	SyscallInforPrint(DELETEFILE_7_INDEX);
	return ((NTDELETEFILE)(oldNtDeleteFile))(ObjectAttributes);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs file reading.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff567072(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtReadFile(HANDLE FileHandle, HANDLE Event, PIO_APC_ROUTINE ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG Length, PLARGE_INTEGER ByteOffset, PULONG Key)
{
	//if(silence(READFILE_7_INDEX))	return STATUS_SUCCESS;
	SyscallInforPrint(READFILE_7_INDEX);
	return ((NTREADFILE)(oldNtReadFile))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, Buffer, Length, ByteOffset, Key);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs file modification.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff567121(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtWriteFile(HANDLE FileHandle, HANDLE Event, PIO_APC_ROUTINE ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG Length, PLARGE_INTEGER ByteOffset, PULONG Key)
{
	//if(silence(WRITEFILE_7_INDEX))	return STATUS_SUCCESS;
	SyscallInforPrint(WRITEFILE_7_INDEX);
	return ((NTWRITEFILE)(oldNtWriteFile))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, Buffer, Length, ByteOffset, Key);
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs file deletion / rename.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff567096(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtSetInformationFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID FileInformation, ULONG Length, FILE_INFORMATION_CLASS FileInformationClass)
{
	SyscallInforPrint(SETINFORMATIONFILE_7_INDEX);
	return ((NTSETINFORMATIONFILE)(oldNtSetInformationFile))(FileHandle, IoStatusBlock, FileInformation, Length, FileInformationClass);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs file information access.
//	Parameters :
//		See http://msdn.microsoft.com/en-us/library/windows/hardware/ff567052(v=vs.85).aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtQueryInformationFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID FileInformation, ULONG Length, FILE_INFORMATION_CLASS FileInformationClass)
{
	SyscallInforPrint(QUERYINFORMATIONFILE_7_INDEX);
	return ((NTQUERYINFORMATIONFILE)(oldNtQueryInformationFile))(FileHandle, IoStatusBlock, FileInformation, Length, FileInformationClass);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs mutex creation
//	Parameters :
//		See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Mutant/NtCreateMutant.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateMutant(PHANDLE MutantHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, BOOLEAN InitialOwner)
{
	SyscallInforPrint(CREATEMUTANT_7_INDEX);
	return ((NTCREATEMUTANT)(oldNtCreateMutant))(MutantHandle, DesiredAccess, ObjectAttributes, InitialOwner);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//  	Logs IOCTLs
//  Parameters :
//  	See http://msdn.microsoft.com/en-us/library/windows/hardware/ff566441%28v=vs.85%29.aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtDeviceIoControlFile(HANDLE FileHandle, HANDLE Event, PIO_APC_ROUTINE ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, ULONG IoControlCode, PVOID InputBuffer, ULONG InputBufferLength, PVOID OuputBuffer, ULONG OutputBufferLength)
{
	SyscallInforPrint(DEVICEIOCONTROLFILE_7_INDEX);
	return ((NTDEVICEIOCONTROLFILE)(oldNtDeviceIoControlFile))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, IoControlCode, InputBuffer, InputBufferLength, OuputBuffer, OutputBufferLength);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Description :
//  	Logs process termination.
//  Parameters :
//  	See http://msdn.microsoft.com/en-us/library/windows/hardware/ff567115%28v=vs.85%29.aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtTerminateProcess(HANDLE ProcessHandle, NTSTATUS ExitStatus)
{
	SyscallInforPrint(TERMINATEPROCESS_7_INDEX);
	return ((NTTERMINATEPROCESS)(oldNtTerminateProcess))(ProcessHandle, ExitStatus);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Description :
//  	Logs resume thread
//  Parameters :
//  	See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Thread/NtResumeThread.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtResumeThread(HANDLE ThreadHandle, PULONG SuspendCount)
{
	SyscallInforPrint(RESUMETHREAD_7_INDEX);
	return ((NTRESUMETHREAD)(oldNtResumeThread))(ThreadHandle, SuspendCount);
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Description :
//  	Block driver loading.
//  Parameters :
//  	See http://msdn.microsoft.com/en-us/library/windows/hardware/ff566470%28v=vs.85%29.aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtLoadDriver(PUNICODE_STRING DriverServiceName)
{	
	SyscallInforPrint(LOADDRIVER_7_INDEX);
	return ((NTLOADDRIVER)(oldNtLoadDriver))(DriverServiceName);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Description :
//  	Logs delay execution.
//  Parameters :
//  	See http://undocumented.ntinternals.net/UserMode/Undocumented%20Functions/NT%20Objects/Thread/NtDelayExecution.html
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtDelayExecution(BOOLEAN Alertable, PLARGE_INTEGER DelayInterval)
{
	SyscallInforPrint(DELAYEXECUTION_7_INDEX);
	return ((NTDELAYEXECUTION)(oldNtDelayExecution))(Alertable, DelayInterval);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Logs process creation.
//	Parameters :
//		See http://www.rohitab.com/discuss/topic/40191-ntcreateuserprocess/ (lulz)
//	Return value :
//		See http://www.rohitab.com/discuss/topic/40191-ntcreateuserprocess/ (lulz)
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtCreateUserProcess(PHANDLE ProcessHandle, PHANDLE ThreadHandle, ACCESS_MASK ProcessDesiredAccess, ACCESS_MASK ThreadDesiredAccess, POBJECT_ATTRIBUTES ProcessObjectAttributes, POBJECT_ATTRIBUTES ThreadObjectAttributes, ULONG ProcessFlags, ULONG ThreadFlags, PRTL_USER_PROCESS_PARAMETERS ProcessParameters, PVOID CreateInfo, PVOID AttributeList)
{
	SyscallInforPrint(CREATEUSERPROCESS_7_INDEX);
	return ((NTCREATEUSERPROCESS)(oldNtCreateUserProcess))(ProcessHandle, ThreadHandle, ProcessDesiredAccess, ThreadDesiredAccess, ProcessObjectAttributes, ThreadObjectAttributes, ProcessFlags, ThreadFlags, ProcessParameters, CreateInfo, AttributeList);

}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Description :
//  	Hide VBOX keys.
//  Parameters :
//  	See http://msdn.microsoft.com/en-us/library/windows/hardware/ff567069%28v=vs.85%29.aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtQueryValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName, KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass, PVOID KeyValueInformation, ULONG Length, PULONG ResultLength)
{
	SyscallInforPrint(QUERYVALUEKEY_7_INDEX);
	return ((NTQUERYVALUEKEY)(oldNtQueryValueKey))(KeyHandle, ValueName, KeyValueInformationClass, KeyValueInformation, Length, ResultLength);
	
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Description :
//  	Hide VBOX files
//  Parameters :
//  	See http://msdn.microsoft.com/en-us/library/cc512135%28v=vs.85%29.aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtQueryAttributesFile(POBJECT_ATTRIBUTES ObjectAttributes, PFILE_BASIC_INFORMATION FileInformation)
{
	SyscallInforPrint(QUERYATTRIBUTESFILE_7_INDEX);
	return ((NTQUERYATTRIBUTESFILE)(oldNtQueryAttributesFile))(ObjectAttributes, FileInformation);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Blocks shutdown attempts through ExWindowsEx (on WinXP)
//	Parameters :
//		https://www.reactos.org/wiki/Techwiki:Win32k/NtUserCallOneParam
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
ULONG newNtUserCallOneParam(ULONG Param, ULONG Routine)
{
	//SyscallInforPrint(USERCALLNOPARAM_7_INDEX);
	return ((NTUSERCALLONEPARAM)(oldNtUserCallOneParam))(Param, Routine);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Description :
//		Blocks shutdown attempts through ExWindowsEx (on Win7)
//	Parameters :
//		https://www.reactos.org/wiki/Techwiki:Win32k/NtUserCallNoParam
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//ULONG newNtUserCallNoParam(ULONG Routine)
//{
//	SyscallInforPrint(USERCALLNOPARAM_7_INDEX);
//	return ((NTUSERCALLNOPARAM)(oldNtUserCallNoParam))(Routine);
//}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  Description :
//  	Dumps files which are about to be deleted (FILE_DELETE_ON_CLOSE)
//  Parameters :
//  	See http://msdn.microsoft.com/en-us/library/windows/hardware/ff566417%28v=vs.85%29.aspx
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
NTSTATUS newNtClose(HANDLE Handle)
{
	SyscallInforPrint(CLOSE_7_INDEX);
	return ((NTCLOSE)(oldNtClose))(Handle);
}

/////////////////////////////////////////////////
// ADDED................

NTSTATUS newNtNotifyChangeMultipleKeys(HANDLE MasterKeyHandle, ULONG Count, POBJECT_ATTRIBUTES SubordinateObjects, HANDLE Event, PIO_APC_ROUTINE ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, ULONG CompletionFilter, BOOLEAN WatchTree, PVOID Buffer, ULONG BufferSize, BOOLEAN Asynchronous){
	SyscallInforPrint(NOTIFYCHANGEMULTIPLEKEYS_7_INDEX);
	return ((NTNOTIFYCHANGEMULTIPLEKEYS)(oldNtNotifyChangeMultipleKeys))(MasterKeyHandle, Count, SubordinateObjects, Event, ApcRoutine, ApcContext, IoStatusBlock, CompletionFilter, WatchTree, Buffer, BufferSize, Asynchronous);
}

NTSTATUS newNtQueryMultipleValueKey(HANDLE KeyHandle, PKEY_VALUE_ENTRY ValueEntries, ULONG EntryCount, PVOID ValueBuffer, PULONG BufferLength, PULONG RequiredBufferLength){
	SyscallInforPrint(QUERYMULTIPLEVALUEKEY_7_INDEX);
	return ((NTQUERYMULTIPLEVALUEKEY)(oldNtQueryMultipleValueKey))(KeyHandle, ValueEntries, EntryCount, ValueBuffer, BufferLength, RequiredBufferLength);
}

NTSTATUS newNtQueryObject(HANDLE Handle, OBJECT_INFORMATION_CLASS ObjectInformationClass, PVOID ObjectInformation, ULONG ObjectInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYOBJECT_7_INDEX);
	return ((NTQUERYOBJECT)(oldNtQueryObject))(Handle, ObjectInformationClass, ObjectInformation, ObjectInformationLength, ReturnLength);
}

NTSTATUS newNtQueryPerformanceCounter(PLARGE_INTEGER PerformanceCounter, PLARGE_INTEGER PerformanceFrequency){
	SyscallInforPrint(QUERYPERFORMANCECOUNTER_7_INDEX);
	return ((NTQUERYPERFORMANCECOUNTER)(oldNtQueryPerformanceCounter))(PerformanceCounter, PerformanceFrequency);
}

NTSTATUS newNtRenameKey(HANDLE KeyHandle, PUNICODE_STRING NewName){
	SyscallInforPrint(RENAMEKEY_7_INDEX);
	return ((NTRENAMEKEY)(oldNtRenameKey))(KeyHandle, NewName);
}

NTSTATUS newNtSetInformationKey(HANDLE KeyHandle, KEY_SET_INFORMATION_CLASS KeySetInformationClass, PVOID KeySetInformation, ULONG KeySetInformationLength){
	SyscallInforPrint(SETINFORMATIONKEY_7_INDEX);
	return ((NTSETINFORMATIONKEY)(oldNtSetInformationKey))(KeyHandle, KeySetInformationClass, KeySetInformation, KeySetInformationLength);
}

NTSTATUS newNtAllocateLocallyUniqueId(PLUID LUID){
	SyscallInforPrint(ALLOCATELOCALLYUNIQUEID_7_INDEX);
	return ((NTALLOCATELOCALLYUNIQUEID)(oldNtAllocateLocallyUniqueId))(LUID);
}

NTSTATUS newNtAllocateVirtualMemory(HANDLE ProcessHandle, PVOID *BaseAddress, ULONG_PTR ZeroBits, PSIZE_T RegionSize, ULONG AllocationType, ULONG Protect){
	SyscallInforPrint(ALLOCATEVIRTUALMEMORY_7_INDEX);
	//RegionSize = (PSIZE_T)ReduceSize((ULONG)RegionSize);
	return ((NTALLOCATEVIRTUALMEMORY)(oldNtAllocateVirtualMemory))(ProcessHandle, BaseAddress, ZeroBits, RegionSize, AllocationType, Protect);
}

NTSTATUS newNtCreateDirectoryObject(PHANDLE DirectoryHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(CREATEDIRECTORYOBJECT_7_INDEX);
	return ((NTCREATEDIRECTORYOBJECT)(oldNtCreateDirectoryObject))(DirectoryHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtCreateEvent(PHANDLE EventHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, EVENT_TYPE EventType, BOOLEAN InitialState){
	SyscallInforPrint(CREATEEVENT_7_INDEX);
	return ((NTCREATEEVENT)(oldNtCreateEvent))(EventHandle, DesiredAccess, ObjectAttributes, EventType, InitialState);
}

NTSTATUS newNtCreateKey(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, _Reserved_ ULONG TitleIndex, PUNICODE_STRING Class, ULONG CreateOptions, PULONG Disposition){
	SyscallInforPrint(CREATEKEY_7_INDEX);
	return ((NTCREATEKEY)(oldNtCreateKey))(KeyHandle, DesiredAccess, ObjectAttributes, TitleIndex, Class, CreateOptions, Disposition);
}

NTSTATUS newNtCreateKeyTransacted(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, _Reserved_ ULONG TitleIndex, PUNICODE_STRING Class, ULONG CreateOptions, HANDLE TransactionHandle, PULONG Disposition){
	SyscallInforPrint(CREATEKEYTRANSACTED_7_INDEX);
	return ((NTCREATEKEYTRANSACTED)(oldNtCreateKeyTransacted))(KeyHandle, DesiredAccess, ObjectAttributes, TitleIndex, Class, CreateOptions, TransactionHandle, Disposition);
}

NTSTATUS newNtDeleteKey(HANDLE KeyHandle){
	SyscallInforPrint(DELETEKEY_7_INDEX);
	return ((NTDELETEKEY)(oldNtDeleteKey))(KeyHandle);
}

NTSTATUS newNtDeleteValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName){
	SyscallInforPrint(DELETEVALUEKEY_7_INDEX);
	return ((NTDELETEVALUEKEY)(oldNtDeleteValueKey))(KeyHandle, ValueName);
}

NTSTATUS newNtDuplicateObject(HANDLE SourceProcessHandle, HANDLE SourceHandle, HANDLE TargetProcessHandle, PHANDLE TargetHandle, ACCESS_MASK DesiredAccess, ULONG HandleAttributes, ULONG Options){
	SyscallInforPrint(DUPLICATEOBJECT_7_INDEX);
	return ((NTDUPLICATEOBJECT)(oldNtDuplicateObject))(SourceProcessHandle, SourceHandle, TargetProcessHandle, TargetHandle, DesiredAccess, HandleAttributes, Options);
}

NTSTATUS newNtDuplicateToken(HANDLE ExistingTokenHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, BOOLEAN EffectiveOnly, TOKEN_TYPE TokenType, PHANDLE NewTokenHandle){
	SyscallInforPrint(DUPLICATETOKEN_7_INDEX);
	return ((NTDUPLICATETOKEN)(oldNtDuplicateToken))(ExistingTokenHandle, DesiredAccess, ObjectAttributes, EffectiveOnly, TokenType, NewTokenHandle);
}

NTSTATUS newNtEnumerateKey(HANDLE KeyHandle, ULONG Index, KEY_INFORMATION_CLASS KeyInformationClass, PVOID KeyInformation, ULONG Length, PULONG ResultLength){
	SyscallInforPrint(ENUMERATEKEY_7_INDEX);
	return ((NTENUMERATEKEY)(oldNtEnumerateKey))(KeyHandle, Index, KeyInformationClass, KeyInformation, Length, ResultLength);
}

NTSTATUS newNtEnumerateValueKey(HANDLE KeyHandle, ULONG Index, KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass, PVOID KeyValueInformation, ULONG Length, PULONG ResultLength){
	SyscallInforPrint(ENUMERATEVALUEKEY_7_INDEX);
	return ((NTENUMERATEVALUEKEY)(oldNtEnumerateValueKey))(KeyHandle, Index, KeyValueInformationClass, KeyValueInformation, Length, ResultLength);
}

NTSTATUS newNtFlushBuffersFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock){
	SyscallInforPrint(FLUSHBUFFERSFILE_7_INDEX);
	return ((NTFLUSHBUFFERSFILE)(oldNtFlushBuffersFile))(FileHandle, IoStatusBlock);
}

NTSTATUS newNtFlushKey(HANDLE KeyHandle){
	SyscallInforPrint(FLUSHKEY_7_INDEX);
	return ((NTFLUSHKEY)(oldNtFlushKey))(KeyHandle);
}

NTSTATUS newNtFlushVirtualMemory(HANDLE ProcessHandle, PVOID *BaseAddress, PSIZE_T RegionSize, PIO_STATUS_BLOCK IoStatus){
	SyscallInforPrint(FLUSHVIRTUALMEMORY_7_INDEX);
	return ((NTFLUSHVIRTUALMEMORY)(oldNtFlushVirtualMemory))(ProcessHandle, BaseAddress, RegionSize, IoStatus);
}

NTSTATUS newNtFsControlFile(HANDLE FileHandle, HANDLE Event, PIO_APC_ROUTINE  ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, ULONG FsControlCode, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength){
	SyscallInforPrint(FSCONTROLFILE_7_INDEX);
	return ((NTFSCONTROLFILE)(oldNtFsControlFile))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, FsControlCode, InputBuffer, InputBufferLength, OutputBuffer, OutputBufferLength);
}

NTSTATUS newNtLockFile(HANDLE FileHandle, HANDLE Event, PIO_APC_ROUTINE  ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, PLARGE_INTEGER ByteOffset, PLARGE_INTEGER Length, ULONG Key, BOOLEAN FailImmediately, BOOLEAN ExclusiveLock){
	SyscallInforPrint(LOCKFILE_7_INDEX);
	return ((NTLOCKFILE)(oldNtLockFile))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, ByteOffset, Length, Key, FailImmediately, ExclusiveLock);
}

NTSTATUS newNtMakeTemporaryObject(HANDLE Handle){
	SyscallInforPrint(MAKETEMPORARYOBJECT_7_INDEX);
	return ((NTMAKETEMPORARYOBJECT)(oldNtMakeTemporaryObject))(Handle);
}

NTSTATUS newNtNotifyChangeKey(HANDLE KeyHandle,HANDLE Event, PIO_APC_ROUTINE  ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, ULONG CompletionFilter, BOOLEAN WatchTree, PVOID Buffer, ULONG BufferSize, BOOLEAN Asynchronous){
	SyscallInforPrint(NOTIFYCHANGEKEY_7_INDEX);
	return ((NTNOTIFYCHANGEKEY)(oldNtNotifyChangeKey))(KeyHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, CompletionFilter, WatchTree, Buffer, BufferSize, Asynchronous);
}

NTSTATUS newNtOpenDirectoryObject(PHANDLE DirectoryHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENDIRECTORYOBJECT_7_INDEX);
	return ((NTOPENDIRECTORYOBJECT)(oldNtOpenDirectoryObject))(DirectoryHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenEvent(PHANDLE EventHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENEVENT_7_INDEX);
	return ((NTOPENEVENT)(oldNtOpenEvent))(EventHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenKey(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENKEY_7_INDEX);
	return ((NTOPENKEY)(oldNtOpenKey))(KeyHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenKeyEx(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, ULONG OpenOptions){
	SyscallInforPrint(OPENKEYEX_7_INDEX);
	return ((NTOPENKEYEX)(oldNtOpenKeyEx))(KeyHandle, DesiredAccess, ObjectAttributes, OpenOptions);
}

NTSTATUS newNtOpenKeyTransacted(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE TransactionHandle){
	SyscallInforPrint(OPENKEYTRANSACTED_7_INDEX);
	return ((NTOPENKEYTRANSACTED)(oldNtOpenKeyTransacted))(KeyHandle, DesiredAccess, ObjectAttributes, TransactionHandle);
}

NTSTATUS newNtOpenKeyTransactedEx(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, ULONG OpenOptions, HANDLE TransactionHandle){
	SyscallInforPrint(OPENKEYTRANSACTEDEX_7_INDEX);
	return ((NTOPENKEYTRANSACTEDEX)(oldNtOpenKeyTransactedEx))(KeyHandle, DesiredAccess, ObjectAttributes, OpenOptions, TransactionHandle);
}

NTSTATUS newNtOpenProcessTokenEx(HANDLE ProcessHandle, ACCESS_MASK DesiredAccess, ULONG  HandleAttributes, PHANDLE TokenHandle){
	SyscallInforPrint(OPENPROCESSTOKENEX_7_INDEX);
	return ((NTOPENPROCESSTOKENEX)(oldNtOpenProcessTokenEx))(ProcessHandle, DesiredAccess, HandleAttributes, TokenHandle);
}

NTSTATUS newNtOpenSection(PHANDLE SectionHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENSECTION_7_INDEX);
	return ((NTOPENSECTION)(oldNtOpenSection))(SectionHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenSymbolicLinkObject(PHANDLE LinkHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENSYMBOLICLINKOBJECT_7_INDEX);
	return ((NTOPENSYMBOLICLINKOBJECT)(oldNtOpenSymbolicLinkObject))(LinkHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenThreadTokenEx(HANDLE ThreadHandle, ACCESS_MASK DesiredAccess, BOOLEAN OpenAsSelf, ULONG HandleAttributes, PHANDLE TokenHandle){
	SyscallInforPrint(OPENTHREADTOKENEX_7_INDEX);
	return ((NTOPENTHREADTOKENEX)(oldNtOpenThreadTokenEx))(ThreadHandle, DesiredAccess, OpenAsSelf, HandleAttributes, TokenHandle);
}

NTSTATUS newNtPowerInformation(POWER_INFORMATION_LEVEL InformationLevel, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength){
	SyscallInforPrint(POWERINFORMATION_7_INDEX);
	return ((NTPOWERINFORMATION)(oldNtPowerInformation))(InformationLevel, InputBuffer, InputBufferLength, OutputBuffer, OutputBufferLength);
}

NTSTATUS newNtQueryInformationThread(HANDLE ThreadHandle, THREADINFOCLASS ThreadInformationClass, PVOID ThreadInformation, ULONG ThreadInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONTHREAD_7_INDEX);
	return ((NTQUERYINFORMATIONTHREAD)(oldNtQueryInformationThread))(ThreadHandle, ThreadInformationClass, ThreadInformation, ThreadInformationLength, ReturnLength);
}

NTSTATUS newNtQueryDirectoryFile(HANDLE FileHandle, HANDLE Event, PIO_APC_ROUTINE ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, PVOID FileInformation, ULONG Length, FILE_INFORMATION_CLASS FileInformationClass, BOOLEAN ReturnSingleEntry, PUNICODE_STRING FileName, BOOLEAN RestartScan){
	SyscallInforPrint(QUERYDIRECTORYFILE_7_INDEX);
	return ((NTQUERYDIRECTORYFILE)(oldNtQueryDirectoryFile))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, FileInformation, Length, FileInformationClass, ReturnSingleEntry, FileName, RestartScan);
}

NTSTATUS newNtQueryEaFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG Length, BOOLEAN ReturnSingleEntry, PVOID EaList, ULONG EaListLength, PULONG EaIndex, BOOLEAN RestartScan){
	SyscallInforPrint(QUERYEAFILE_7_INDEX);
	return ((NTQUERYEAFILE)(oldNtQueryEaFile))(FileHandle, IoStatusBlock, Buffer, Length, ReturnSingleEntry, EaList, EaListLength, EaIndex, RestartScan);
}

NTSTATUS newNtQueryFullAttributesFile(POBJECT_ATTRIBUTES ObjectAttributes, PFILE_NETWORK_OPEN_INFORMATION FileInformation){
	SyscallInforPrint(QUERYFULLATTRIBUTESFILE_7_INDEX);
	return ((NTQUERYFULLATTRIBUTESFILE)(oldNtQueryFullAttributesFile))(ObjectAttributes, FileInformation);
}

NTSTATUS newNtQueryInformationToken(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, PVOID TokenInformation, ULONG TokenInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONTOKEN_7_INDEX);
	return ((NTQUERYINFORMATIONTOKEN)(oldNtQueryInformationToken))(TokenHandle, TokenInformationClass, TokenInformation, TokenInformationLength, ReturnLength);
}

NTSTATUS newNtQueryKey(HANDLE KeyHandle, KEY_INFORMATION_CLASS KeyInformationClass, PVOID KeyInformation, ULONG Length, PULONG ResultLength){
	SyscallInforPrint(QUERYKEY_7_INDEX);
	return ((NTQUERYKEY)(oldNtQueryKey))(KeyHandle, KeyInformationClass, KeyInformation, Length, ResultLength);
}

NTSTATUS newNtQueryQuotaInformationFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG Length, BOOLEAN ReturnSingleEntry, PVOID SidList, ULONG SidListLength, PSID StartSid, BOOLEAN RestartScan){
	SyscallInforPrint(QUERYQUOTAINFORMATIONFILE_7_INDEX);
	return ((NTQUERYQUOTAINFORMATIONFILE)(oldNtQueryQuotaInformationFile))(FileHandle, IoStatusBlock, Buffer, Length, ReturnSingleEntry, SidList, SidListLength, StartSid, RestartScan);
}

NTSTATUS newNtQuerySecurityObject(HANDLE Handle, SECURITY_INFORMATION SecurityInformation, PSECURITY_DESCRIPTOR SecurityDescriptor, ULONG Length, PULONG LengthNeeded){
	SyscallInforPrint(QUERYSECURITYOBJECT_7_INDEX);
	return ((NTQUERYSECURITYOBJECT)(oldNtQuerySecurityObject))(Handle, SecurityInformation, SecurityDescriptor, Length, LengthNeeded);
}

NTSTATUS newNtQuerySymbolicLinkObject(HANDLE LinkHandle, PUNICODE_STRING LinkTarget, PULONG ReturnedLength){
	SyscallInforPrint(QUERYSYMBOLICLINKOBJECT_7_INDEX);
	return ((NTQUERYSYMBOLICLINKOBJECT)(oldNtQuerySymbolicLinkObject))(LinkHandle, LinkTarget, ReturnedLength);
}

NTSTATUS newNtQueryVirtualMemory(HANDLE ProcessHandle, PVOID BaseAddress, MEMORY_INFORMATION_CLASS MemoryInformationClass, PVOID MemoryInformation, SIZE_T MemoryInformationLength, PSIZE_T ReturnLength){
	SyscallInforPrint(QUERYVIRTUALMEMORY_7_INDEX);
	return ((NTQUERYVIRTUALMEMORY)(oldNtQueryVirtualMemory))(ProcessHandle, BaseAddress, MemoryInformationClass, MemoryInformation, MemoryInformationLength, ReturnLength);
}

NTSTATUS newNtQueryVolumeInformationFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID FsInformation, ULONG Length, FS_INFORMATION_CLASS FsInformationClass){
	SyscallInforPrint(QUERYVOLUMEINFORMATIONFILE_7_INDEX);
	return ((NTQUERYVOLUMEINFORMATIONFILE)(oldNtQueryVolumeInformationFile))(FileHandle, IoStatusBlock, FsInformation, Length, FsInformationClass);
}

NTSTATUS newNtSetEaFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG Length){
	SyscallInforPrint(SETEAFILE_7_INDEX);
	return ((NTSETEAFILE)(oldNtSetEaFile))(FileHandle, IoStatusBlock, Buffer, Length);
}

NTSTATUS newNtSetEvent(HANDLE EventHandle, PLONG PreviousState){
	SyscallInforPrint(SETEVENT_7_INDEX);
	return ((NTSETEVENT)(oldNtSetEvent))(EventHandle, PreviousState);
}

NTSTATUS newNtSetInformationThread(HANDLE ThreadHandle, THREADINFOCLASS ThreadInformationClass, PVOID ThreadInformation, ULONG ThreadInformationLength){
	SyscallInforPrint(SETINFORMATIONTHREAD_7_INDEX);
	return ((NTSETINFORMATIONTHREAD)(oldNtSetInformationThread))(ThreadHandle, ThreadInformationClass, ThreadInformation, ThreadInformationLength );
}

NTSTATUS newNtSetInformationToken(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, PVOID TokenInformation, ULONG TokenInformationLength){
	SyscallInforPrint(SETINFORMATIONTOKEN_7_INDEX);
	return ((NTSETINFORMATIONTOKEN)(oldNtSetInformationToken))(TokenHandle, TokenInformationClass, TokenInformation, TokenInformationLength);
}

NTSTATUS newNtSetQuotaInformationFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG Length){
	SyscallInforPrint(SETQUOTAINFORMATIONFILE_7_INDEX);
	return ((NTSETQUOTAINFORMATIONFILE)(oldNtSetQuotaInformationFile))(FileHandle, IoStatusBlock, Buffer, Length );
}

NTSTATUS newNtSetSecurityObject(HANDLE Handle, SECURITY_INFORMATION SecurityInformation, PSECURITY_DESCRIPTOR SecurityDescriptor){
	SyscallInforPrint(SETSECURITYOBJECT_7_INDEX);
	return ((NTSETSECURITYOBJECT)(oldNtSetSecurityObject))(Handle, SecurityInformation, SecurityDescriptor);
}

NTSTATUS newNtSetValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName, ULONG TitleIndex, ULONG Type, PVOID Data, ULONG DataSize){
	SyscallInforPrint(SETVALUEKEY_7_INDEX);
	return ((NTSETVALUEKEY)(oldNtSetValueKey))(KeyHandle, ValueName, TitleIndex, Type, Data, DataSize);
}

NTSTATUS newNtSetVolumeInformationFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID FsInformation, ULONG Length, FS_INFORMATION_CLASS FsInformationClass){
	SyscallInforPrint(SETVOLUMEINFORMATIONFILE_7_INDEX);
	return ((NTSETVOLUMEINFORMATIONFILE)(oldNtSetVolumeInformationFile))(FileHandle, IoStatusBlock, FsInformation, Length, FsInformationClass);
}

NTSTATUS newNtUnloadDriver(PUNICODE_STRING DriverServiceName){
	SyscallInforPrint(UNLOADDRIVER_7_INDEX);
	return ((NTUNLOADDRIVER)(oldNtUnloadDriver))(DriverServiceName );
}

NTSTATUS newNtUnlockFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PLARGE_INTEGER ByteOffset, PLARGE_INTEGER Length, ULONG Key){
	SyscallInforPrint(UNLOCKFILE_7_INDEX);
	return ((NTUNLOCKFILE)(oldNtUnlockFile))(FileHandle, IoStatusBlock, ByteOffset, Length, Key);
}

NTSTATUS newNtUnmapViewOfSection(HANDLE ProcessHandle, PVOID BaseAddress){
	SyscallInforPrint(UNMAPVIEWOFSECTION_7_INDEX);
	return ((NTUNMAPVIEWOFSECTION)(oldNtUnmapViewOfSection))(ProcessHandle, BaseAddress );
}

NTSTATUS newNtWaitForSingleObject(HANDLE Handle, BOOLEAN Alertable, PLARGE_INTEGER Timeout){
	SyscallInforPrint(WAITFORSINGLEOBJECT_7_INDEX);
	return ((NTWAITFORSINGLEOBJECT)(oldNtWaitForSingleObject))(Handle, Alertable, Timeout );
}

NTSTATUS newNtFreeVirtualMemory(HANDLE ProcessHandle, PVOID *BaseAddress, PULONG RegionSize, ULONG FreeType){
	SyscallInforPrint(FREEVIRTUALMEMORY_7_INDEX);
	return ((NTFREEVIRTUALMEMORY)(oldNtFreeVirtualMemory))(ProcessHandle, BaseAddress, RegionSize, FreeType);
}

NTSTATUS newNtLockVirtualMemory(HANDLE ProcessHandle, PVOID *BaseAddress, PULONG NumberOfBytesToLock, ULONG LockOption){
	SyscallInforPrint(LOCKVIRTUALMEMORY_7_INDEX);
	return ((NTLOCKVIRTUALMEMORY)(oldNtLockVirtualMemory))(ProcessHandle, BaseAddress, NumberOfBytesToLock, LockOption);
}

NTSTATUS newNtProtectVirtualMemory(HANDLE ProcessHandle,PVOID *BaseAddress, PULONG NumberOfBytesToProtect,  ULONG NewAccessProtection, PULONG OldAccessProtection ){
	SyscallInforPrint(PROTECTVIRTUALMEMORY_7_INDEX);
	return ((NTPROTECTVIRTUALMEMORY)(oldNtProtectVirtualMemory))(ProcessHandle, BaseAddress, NumberOfBytesToProtect, NewAccessProtection, OldAccessProtection );
}

NTSTATUS newNtUnlockVirtualMemory(HANDLE ProcessHandle, PVOID *BaseAddress, PULONG NumberOfBytesToUnlock, ULONG LockType){
	SyscallInforPrint(UNLOCKVIRTUALMEMORY_7_INDEX);
	return ((NTUNLOCKVIRTUALMEMORY)(oldNtUnlockVirtualMemory))(ProcessHandle, BaseAddress, NumberOfBytesToUnlock, LockType);
}
 
NTSTATUS newNtFlushInstructionCache(HANDLE ProcessHandle, PVOID BaseAddress, ULONG NumberOfBytesToFlush){
	SyscallInforPrint(FLUSHINSTRUCTIONCACHE_7_INDEX);
	return ((NTFLUSHINSTRUCTIONCACHE)(oldNtFlushInstructionCache))(ProcessHandle, BaseAddress, NumberOfBytesToFlush );
}

NTSTATUS newNtQueryInformationProcess(HANDLE ProcessHandle, PROCESS_INFORMATION_CLASS ProcessInformationClass, PVOID ProcessInformation, ULONG ProcessInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONPROCESS_7_INDEX);
	return ((NTQUERYINFORMATIONPROCESS)(oldNtQueryInformationProcess))(ProcessHandle, ProcessInformationClass, ProcessInformation, ProcessInformationLength, ReturnLength);
}

NTSTATUS newNtSetInformationProcess(HANDLE ProcessHandle, PROCESS_INFORMATION_CLASS ProcessInformationClass, PVOID ProcessInformation, ULONG ProcessInformationLength){
	SyscallInforPrint(SETINFORMATIONPROCESS_7_INDEX);
	return ((NTSETINFORMATIONPROCESS)(oldNtSetInformationProcess))(ProcessHandle, ProcessInformationClass, ProcessInformation, ProcessInformationLength);
}
 
NTSTATUS newNtAlertThread(HANDLE ThreadHandle){
	SyscallInforPrint(ALERTTHREAD_7_INDEX);
	return ((NTALERTTHREAD)(oldNtAlertThread))(ThreadHandle);
}

NTSTATUS newNtCallbackReturn(PVOID Result, ULONG ResultLength, NTSTATUS newStatus){
	SyscallInforPrint(CALLBACKRETURN_7_INDEX);
	return ((NTCALLBACKRETURN)(oldNtCallbackReturn))(Result, ResultLength, newStatus);
}

NTSTATUS newNtGetContextThread(HANDLE ThreadHandle, PCONTEXT pContext){
	SyscallInforPrint(GETCONTEXTTHREAD_7_INDEX);
	return ((NTGETCONTEXTTHREAD)(oldNtGetContextThread))(ThreadHandle, pContext);
}

NTSTATUS newNtAlertResumeThread(HANDLE ThreadHandle, PULONG SuspendCount){
	SyscallInforPrint(ALERTRESUMETHREAD_7_INDEX);
	return ((NTALERTRESUMETHREAD)(oldNtAlertResumeThread))(ThreadHandle, SuspendCount);
}

NTSTATUS newNtContinue(PCONTEXT ThreadContext, BOOLEAN RaiseAlert){
	SyscallInforPrint(CONTINUE_7_INDEX);
	return ((NTCONTINUE)(oldNtContinue))(ThreadContext, RaiseAlert);
}

NTSTATUS newNtImpersonateThread(HANDLE ThreadHandle, HANDLE ThreadToImpersonate, PSECURITY_QUALITY_OF_SERVICE SecurityQualityOfService){
	SyscallInforPrint(IMPERSONATETHREAD_7_INDEX);
	return ((NTIMPERSONATETHREAD)(oldNtImpersonateThread))(ThreadHandle, ThreadToImpersonate, SecurityQualityOfService);
}

NTSTATUS newNtRegisterThreadTerminatePort(HANDLE PortHandle){
	SyscallInforPrint(REGISTERTHREADTERMINATEPORT_7_INDEX);
	return ((NTREGISTERTHREADTERMINATEPORT)(oldNtRegisterThreadTerminatePort))(PortHandle);
}


NTSTATUS newNtSuspendThread(HANDLE ThreadHandle, PULONG PreviousSuspendCount OPTIONAL){
	SyscallInforPrint(SUSPENDTHREAD_7_INDEX);
	return ((NTSUSPENDTHREAD)(oldNtSuspendThread))(ThreadHandle, PreviousSuspendCount);
}

NTSTATUS newNtTerminateThread(HANDLE ThreadHandle, NTSTATUS ExitStatus){
	SyscallInforPrint(TERMINATETHREAD_7_INDEX);
	return ((NTTERMINATETHREAD)(oldNtTerminateThread))(ThreadHandle, ExitStatus);
}

NTSTATUS newNtOpenMutant(PHANDLE MutantHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENMUTANT_7_INDEX);
	return ((NTOPENMUTANT)(oldNtOpenMutant))(MutantHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtQueryMutant(HANDLE MutantHandle, MUTANT_INFORMATION_CLASS MutantInformationClass, PVOID MutantInformation, ULONG MutantInformationLength, PULONG ResultLength OPTIONAL){
	SyscallInforPrint(QUERYMUTANT_7_INDEX);
	return ((NTQUERYMUTANT)(oldNtQueryMutant))(MutantHandle, MutantInformationClass, MutantInformation, MutantInformationLength, ResultLength);
}

NTSTATUS newNtReleaseMutant(HANDLE MutantHandle, PLONG PreviousCount OPTIONAL){
	SyscallInforPrint(RELEASEMUTANT_7_INDEX);
	return ((NTRELEASEMUTANT)(oldNtReleaseMutant))(MutantHandle, PreviousCount);
}

NTSTATUS newNtSetTimerResolution(ULONG DesiredResolution, BOOLEAN SetResolution, PULONG CurrentResolution){
	SyscallInforPrint(SETTIMERRESOLUTION_7_INDEX);
	return ((NTSETTIMERRESOLUTION)(oldNtSetTimerResolution))(DesiredResolution, SetResolution, CurrentResolution);
}

NTSTATUS newNtSetSystemTime(PLARGE_INTEGER SystemTime, PLARGE_INTEGER PreviousTime OPTIONAL){
	SyscallInforPrint(SETSYSTEMTIME_7_INDEX);
	return ((NTSETSYSTEMTIME)(oldNtSetSystemTime))(SystemTime, PreviousTime);
}

NTSTATUS newNtQueryTimerResolution(PULONG MinimumResolution, PULONG MaximumResolution, PULONG CurrentResolution){
	SyscallInforPrint(QUERYTIMERRESOLUTION_7_INDEX);
	return ((NTQUERYTIMERRESOLUTION)(oldNtQueryTimerResolution))(MinimumResolution, MaximumResolution, CurrentResolution);
}

NTSTATUS newNtQuerySystemTime(PLARGE_INTEGER SystemTime){
	SyscallInforPrint(QUERYSYSTEMTIME_7_INDEX);
	return ((NTQUERYSYSTEMTIME)(oldNtQuerySystemTime))(SystemTime);
}

// end adding by ruimin

//-----network syscall
NTSTATUS newNtAcceptConnectPort(PHANDLE ServerPortHandle, HANDLE AlternativeReceivePortHandle, PLPC_MESSAGE ConnectionReply, BOOLEAN AcceptConnection, PLPC_SECTION_OWNER_MEMORY ServerSharedMemory, PLPC_SECTION_MEMORY ClientSharedMemory){
	SyscallInforPrint(ACCEPTCONNECTPORT_7_INDEX);
	if(silence(ACCEPTCONNECTPORT_7_INDEX, -1)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTACCEPTCONNECTPORT)(oldNtAcceptConnectPort))(ServerPortHandle, AlternativeReceivePortHandle, ConnectionReply, AcceptConnection, ServerSharedMemory, ClientSharedMemory);
}

NTSTATUS newNtCompleteConnectPort(HANDLE PortHandle){
	SyscallInforPrint(COMPLETECONNECTPORT_7_INDEX);
	if(silence(COMPLETECONNECTPORT_7_INDEX, -1)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTCOMPLETECONNECTPORT)(oldNtCompleteConnectPort))(PortHandle);
}
// Used by server to create connection port
NTSTATUS newNtCreatePort(PHANDLE PortHandle, POBJECT_ATTRIBUTES ObjectAttributes, ULONG MaxConnectInfoLength, ULONG MaxDataLength, PULONG Reserved){
	SyscallInforPrint(CREATEPORT_7_INDEX);	
	if(silence(CREATEPORT_7_INDEX, -1)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTCREATEPORT)(oldNtCreatePort))(PortHandle, ObjectAttributes, MaxConnectInfoLength, MaxDataLength, Reserved);
}
 
// Used by client to connect a connection port 
NTSTATUS newNtConnectPort(PHANDLE ClientPortHandle, PUNICODE_STRING  ServerPortName, PSECURITY_QUALITY_OF_SERVICE SecurityQos, PLPC_SECTION_OWNER_MEMORY ClientSharedMemory, PLPC_SECTION_MEMORY ServerSharedMemory, PULONG MaximumMessageLength, PVOID ConnectionInfo, PULONG  ConnectionInfoLength){
	SyscallInforPrint(CONNECTPORT_7_INDEX);
	if(silence(CONNECTPORT_7_INDEX, -1)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTCONNECTPORT)(oldNtConnectPort))(ClientPortHandle, ServerPortName, SecurityQos, ClientSharedMemory, ServerSharedMemory, MaximumMessageLength, ConnectionInfo, ConnectionInfoLength);
}
 
NTSTATUS newNtImpersonateClientOfPort(HANDLE PortHandle, PLPC_MESSAGE Request){
	SyscallInforPrint(IMPERSONATECLIENTOFPORT_7_INDEX);
	if(silence(IMPERSONATECLIENTOFPORT_7_INDEX, -1)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTIMPERSONATECLIENTOFPORT)(oldNtImpersonateClientOfPort))(PortHandle, Request);
}
 
NTSTATUS newNtListenPort( HANDLE PortHandle, PLPC_MESSAGE ConnectionRequest){
	SyscallInforPrint(LISTENPORT_7_INDEX);
	if(silence(LISTENPORT_7_INDEX, -1)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTLISTENPORT)(oldNtListenPort))(PortHandle, ConnectionRequest);
}
 
NTSTATUS newNtQueryInformationPort(HANDLE PortHandle, PORT_INFORMATION_CLASS PortInformationClass, PVOID PortInformation, ULONG Length, PULONG ResultLength){
	SyscallInforPrint(QUERYINFORMATIONPORT_7_INDEX);	
	if(silence(QUERYINFORMATIONPORT_7_INDEX,-1)){
			DbgPrint("s4 \n\n");
			return STATUS_SUCCESS;
	}
	return ((NTQUERYINFORMATIONPORT)(oldNtQueryInformationPort))(PortHandle, PortInformationClass, PortInformation, Length, ResultLength);
}
 
NTSTATUS newNtReadRequestData(HANDLE PortHandle, PLPC_MESSAGE Request, ULONG DataIndex, PVOID Buffer, ULONG Length, PULONG ResultLength){
	SyscallInforPrint(READREQUESTDATA_7_INDEX);
	if(silence(READREQUESTDATA_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}	
	
	return ((NTREADREQUESTDATA)(newNtReadRequestData))(PortHandle, Request, DataIndex, Buffer, Length, ResultLength);
}
 
NTSTATUS newNtReplyPort(HANDLE PortHandle, PLPC_MESSAGE Reply){
	SyscallInforPrint(REPLYPORT_7_INDEX);
	if(silence(REPLYPORT_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}	
	return ((NTREPLYPORT)(oldNtReplyPort))(PortHandle, Reply);
}
 
NTSTATUS newNtReplyWaitReceivePort(HANDLE PortHandle, PHANDLE ReceivePortHandle, PLPC_MESSAGE Reply, PLPC_MESSAGE IncomingRequest ){
	SyscallInforPrint(REPLYPORT_7_INDEX);
	if(silence(REPLYPORT_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTREPLYWAITRECEIVEPORT)(oldNtReplyWaitReceivePort))(PortHandle, ReceivePortHandle, Reply, IncomingRequest);
}
 
NTSTATUS newNtReplyWaitReplyPort(HANDLE PortHandl, PLPC_MESSAGE Reply){
	SyscallInforPrint(REPLYPORT_7_INDEX);
	if(silence(REPLYPORT_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTREPLYWAITREPLYPORT)(oldNtReplyWaitReplyPort))(PortHandl, Reply);
}
 
NTSTATUS newNtRequestPort(HANDLE PortHandle, PLPC_MESSAGE Request){
	SyscallInforPrint(REPLYPORT_7_INDEX);
	if(silence(REPLYPORT_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTREQUESTPORT)(oldNtRequestPort))(PortHandle, Request);
}
 
NTSTATUS newNtRequestWaitReplyPort(HANDLE PortHandle, PLPC_MESSAGE Request, PLPC_MESSAGE IncomingReply){
	SyscallInforPrint(REQUESTWAITREPLYPORT_7_INDEX);
	if(silence(REQUESTWAITREPLYPORT_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTREQUESTWAITREPLYPORT)(oldNtRequestWaitReplyPort))(PortHandle, Request, IncomingReply);
}
 
NTSTATUS newNtWriteRequestData(HANDLE PortHandle, PLPC_MESSAGE Request, ULONG DataIndex, PVOID Buffer, ULONG Length, PULONG ResultLength){
	SyscallInforPrint(WRITEREQUESTDATA_7_INDEX);
	if(silence(WRITEREQUESTDATA_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTWRITEREQUESTDATA)(oldNtWriteRequestData))(PortHandle, Request, DataIndex, Buffer, Length, ResultLength);
}

NTSTATUS newNtAlpcSendWaitReceivePort(HANDLE PortHandle, ULONG Flags,PPORT_MESSAGE SendMessage, PALPC_MESSAGE_ATTRIBUTES SendMessageAttributes, PPORT_MESSAGE ReceiveMessage, PSIZE_T BufferLength, PALPC_MESSAGE_ATTRIBUTES ReceiveMessageAttributes, PLARGE_INTEGER Timeout){
	SyscallInforPrint(ALPCSENDWAITRECEIVEPORT_7_INDEX);
	if(silence(ALPCSENDWAITRECEIVEPORT_7_INDEX,-1)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTALPCSENDWAITRECEIVEPORT)(oldNtAlpcSendWaitReceivePort))(PortHandle, Flags, SendMessage, SendMessageAttributes, ReceiveMessage, BufferLength, ReceiveMessageAttributes, Timeout);
}

NTSTATUS newNtAlpcOpenSenderProcess(PHANDLE ProcessHandle, HANDLE PortHandle, PPORT_MESSAGE PortMessage, ULONG Flags, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	if(silence(ALPCOPENSENDERPROCESS_7_INDEX,3))	return STATUS_SUCCESS;
	SyscallInforPrint(ALPCOPENSENDERPROCESS_7_INDEX);
	return ((NTALPCOPENSENDERPROCESS)(oldNtAlpcOpenSenderProcess))(ProcessHandle, PortHandle, PortMessage, Flags, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtAlpcOpenSenderThread(PHANDLE ThreadHandle, HANDLE PortHandle, PPORT_MESSAGE PortMessage, ULONG Flags, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	if(silence(ALPCOPENSENDERTHREAD_7_INDEX,3))	return STATUS_SUCCESS;
	SyscallInforPrint(ALPCOPENSENDERTHREAD_7_INDEX);
	return ((NTALPCOPENSENDERTHREAD)(oldNtAlpcOpenSenderThread))(ThreadHandle, PortHandle, PortMessage, Flags, DesiredAccess, ObjectAttributes);
}

//more added Feb 1st
NTSTATUS newNtAccessCheck(PSECURITY_DESCRIPTOR SecurityDescriptor, HANDLE ClientToken, ACCESS_MASK DesiredAccess, PGENERIC_MAPPING GenericMapping, PPRIVILEGE_SET PrivilegeSet, PULONG ReturnLength, PULONG GrantedAccess, NTSTATUS* AccessStatus){
	SyscallInforPrint(ACCESSCHECK_7_INDEX);
	return ((NTACCESSCHECK)(oldNtAccessCheck))(SecurityDescriptor, ClientToken, DesiredAccess, GenericMapping, PrivilegeSet, ReturnLength, GrantedAccess, AccessStatus);
}

NTSTATUS newNtAccessCheckAndAuditAlarm(PUNICODE_STRING SubsystemName OPTIONAL, HANDLE ObjectHandle OPTIONAL, PUNICODE_STRING ObjectTypeName OPTIONAL, PUNICODE_STRING ObjectName OPTIONAL, PSECURITY_DESCRIPTOR SecurityDescriptor, ACCESS_MASK DesiredAccess, PGENERIC_MAPPING GenericMapping,  BOOLEAN ObjectCreation, PULONG GrantedAccess, PULONG AccessStatus, PBOOLEAN GenerateOnClose){
	SyscallInforPrint(ACCESSCHECKANDAUDITALARM_7_INDEX);
	return ((NTACCESSCHECKANDAUDITALARM)(oldNtAccessCheckAndAuditAlarm))(SubsystemName, ObjectHandle, ObjectTypeName, ObjectName, SecurityDescriptor, DesiredAccess, GenericMapping, ObjectCreation, GrantedAccess, AccessStatus, GenerateOnClose);
}

NTSTATUS newNtAccessCheckByType(PSECURITY_DESCRIPTOR SecurityDescriptor, PSID PrincipalSelfSid, HANDLE ClientToken, ACCESS_MASK DesiredAccess, POBJECT_TYPE_LIST ObjectTypeList, ULONG ObjectTypeListLength, PGENERIC_MAPPING GenericMapping,  PPRIVILEGE_SET PrivilegeSet, PULONG PrivilegeSetLength, PACCESS_MASK GrantedAccess, PNTSTATUS AccessStatus){
	SyscallInforPrint(ACCESSCHECKBYTYPE_7_INDEX);
	return ((NTACCESSCHECKBYTYPE)(oldNtAccessCheckByType))(SecurityDescriptor, PrincipalSelfSid, ClientToken, DesiredAccess, ObjectTypeList, ObjectTypeListLength, GenericMapping, PrivilegeSet, PrivilegeSetLength, GrantedAccess, AccessStatus);
} 

NTSTATUS newNtAccessCheckByTypeAndAuditAlarm(PUNICODE_STRING SubsystemName, PVOID HandleId, PUNICODE_STRING ObjectTypeName, PUNICODE_STRING ObjectName, PSECURITY_DESCRIPTOR SecurityDescriptor, PSID PrincipalSelfSid, ACCESS_MASK DesiredAccess, AUDIT_EVENT_TYPE AuditType, ULONG Flags, POBJECT_TYPE_LIST ObjectTypeList, ULONG ObjectTypeListLength, PGENERIC_MAPPING GenericMapping, BOOLEAN ObjectCreation, PACCESS_MASK GrantedAccess, PNTSTATUS AccessStatus, PBOOLEAN GenerateOnClose){
	SyscallInforPrint(ACCESSCHECKBYTYPEANDAUDITALARM_7_INDEX);
	return ((NTACCESSCHECKBYTYPEANDAUDITALARM)(oldNtAccessCheckByTypeAndAuditAlarm))(SubsystemName, HandleId, ObjectTypeName, ObjectName, SecurityDescriptor, PrincipalSelfSid, DesiredAccess, AuditType, Flags, ObjectTypeList, ObjectTypeListLength, GenericMapping, ObjectCreation, GrantedAccess, AccessStatus, GenerateOnClose);
}

NTSTATUS newNtAccessCheckByTypeResultList(PSECURITY_DESCRIPTOR SecurityDescriptor, PSID PrincipalSelfSid, HANDLE ClientToken, ACCESS_MASK DesiredAccess,   POBJECT_TYPE_LIST ObjectTypeList, ULONG ObjectTypeListLength, PGENERIC_MAPPING GenericMapping,  PPRIVILEGE_SET PrivilegeSet, PULONG PrivilegeSetLength,   PACCESS_MASK GrantedAccess,   PNTSTATUS AccessStatus){
	SyscallInforPrint(ACCESSCHECKBYTYPERESULTLIST_7_INDEX);
	return ((NTACCESSCHECKBYTYPERESULTLIST)(oldNtAccessCheckByTypeResultList))(SecurityDescriptor, PrincipalSelfSid, ClientToken, DesiredAccess,  ObjectTypeList, ObjectTypeListLength, GenericMapping, PrivilegeSet, PrivilegeSetLength,   GrantedAccess,   AccessStatus);
}

NTSTATUS newNtAccessCheckByTypeResultListAndAuditAlarm(PUNICODE_STRING SubsystemName, PVOID HandleId, PUNICODE_STRING ObjectTypeName, PUNICODE_STRING ObjectName, PSECURITY_DESCRIPTOR SecurityDescriptor, PSID PrincipalSelfSid, ACCESS_MASK DesiredAccess, AUDIT_EVENT_TYPE AuditType, ULONG Flags,   POBJECT_TYPE_LIST ObjectTypeList, ULONG ObjectTypeListLength, PGENERIC_MAPPING GenericMapping, BOOLEAN ObjectCreation,   PACCESS_MASK GrantedAccess,    PNTSTATUS AccessStatus, PBOOLEAN GenerateOnClose){
	SyscallInforPrint(ACCESSCHECKBYTYPERESULTLISTANDAUDITALARM_7_INDEX);
	return ((NTACCESSCHECKBYTYPERESULTLISTANDAUDITALARM)(oldNtAccessCheckByTypeResultListAndAuditAlarm))(SubsystemName, HandleId, ObjectTypeName, ObjectName, SecurityDescriptor, PrincipalSelfSid, DesiredAccess, AuditType, Flags, ObjectTypeList, ObjectTypeListLength, GenericMapping, ObjectCreation, GrantedAccess, AccessStatus, GenerateOnClose);
}

NTSTATUS newNtAccessCheckByTypeResultListAndAuditAlarmByHandle(PUNICODE_STRING SubsystemName, PVOID HandleId, HANDLE ClientToken, PUNICODE_STRING ObjectTypeName, PUNICODE_STRING ObjectName, PSECURITY_DESCRIPTOR SecurityDescriptor, PSID PrincipalSelfSid, ACCESS_MASK DesiredAccess, AUDIT_EVENT_TYPE AuditType, ULONG Flags,   POBJECT_TYPE_LIST ObjectTypeList, ULONG ObjectTypeListLength, PGENERIC_MAPPING GenericMapping, BOOLEAN ObjectCreation,   PACCESS_MASK GrantedAccess,   PNTSTATUS AccessStatus, PBOOLEAN GenerateOnClose){
	SyscallInforPrint(ACCESSCHECKBYTYPERESULTLISTANDAUDITALARMBYHANDLE_7_INDEX);
	return ((NTACCESSCHECKBYTYPERESULTLISTANDAUDITALARMBYHANDLE)(oldNtAccessCheckByTypeResultListAndAuditAlarmByHandle))(SubsystemName, HandleId, ClientToken, ObjectTypeName, ObjectName, SecurityDescriptor, PrincipalSelfSid, DesiredAccess, AuditType, Flags, ObjectTypeList, ObjectTypeListLength, GenericMapping, ObjectCreation, GrantedAccess, AccessStatus, GenerateOnClose);
}

NTSTATUS newNtAddAtom(PWCHAR AtomName, PRTL_ATOM Atom){
	SyscallInforPrint(ADDATOM_7_INDEX);
	return ((NTADDATOM)(oldNtAddAtom))(AtomName, Atom);
}

NTSTATUS newNtAddBootEntry(PBOOT_ENTRY Entry, ULONG Id){
	SyscallInforPrint(ADDBOOTENTRY_7_INDEX);
	return ((NTADDBOOTENTRY)(oldNtAddBootEntry))(Entry, Id);
}

NTSTATUS newNtAddDriverEntry(PEFI_DRIVER_ENTRY BootEntry, ULONG Id){
	SyscallInforPrint(ADDDRIVERENTRY_7_INDEX);
	return ((NTADDDRIVERENTRY)(oldNtAddDriverEntry))(BootEntry, Id);
}

NTSTATUS newNtAdjustGroupsToken(HANDLE TokenHandle, BOOLEAN ResetToDefault, PTOKEN_GROUPS NewState, ULONG BufferLength, PTOKEN_GROUPS PreviousState, PULONG ReturnLength){
	SyscallInforPrint(ADJUSTGROUPSTOKEN_7_INDEX);
	return ((NTADJUSTGROUPSTOKEN)(oldNtAdjustGroupsToken))(TokenHandle, ResetToDefault, NewState, BufferLength, PreviousState, ReturnLength);
}

NTSTATUS newNtAdjustPrivilegesToken(HANDLE TokenHandle, BOOLEAN DisableAllPrivileges, PTOKEN_PRIVILEGES NewState, ULONG BufferLength, PTOKEN_PRIVILEGES PreviousState, _When_(PreviousState != NULL, ) PULONG ReturnLength){
	SyscallInforPrint(ADJUSTPRIVILEGESTOKEN_7_INDEX);
	return ((NTADJUSTPRIVILEGESTOKEN)(oldNtAdjustPrivilegesToken))(TokenHandle, DisableAllPrivileges, NewState, BufferLength, PreviousState, ReturnLength);
}

NTSTATUS newNtAllocateReserveObject(PHANDLE hObject, POBJECT_ATTRIBUTES ObjectAttributes, DWORD ObjectType){
	SyscallInforPrint(ALLOCATERESERVEOBJECT_7_INDEX);
	return ((NTALLOCATERESERVEOBJECT)(oldNtAllocateReserveObject))(hObject, ObjectAttributes, ObjectType);
}

NTSTATUS newNtAllocateUserPhysicalPages(HANDLE ProcessHandle, PULONG_PTR NumberOfPages, PULONG_PTR UserPfnArray){
	SyscallInforPrint(ALLOCATEUSERPHYSICALPAGES_7_INDEX);
	return ((NTALLOCATEUSERPHYSICALPAGES)(oldNtAllocateUserPhysicalPages))(ProcessHandle, NumberOfPages, UserPfnArray);
}

NTSTATUS newNtAllocateUuids(PULARGE_INTEGER Time, PULONG Range, PULONG Sequence, PUCHAR Seed){
	SyscallInforPrint(ALLOCATEUUIDS_7_INDEX);
	return ((NTALLOCATEUUIDS)(oldNtAllocateUuids))(Time, Range, Sequence, Seed);
}

NTSTATUS newNtAlpcAcceptConnectPort(PHANDLE PortHandle, HANDLE ConnectionPortHandle, ULONG Flags, POBJECT_ATTRIBUTES ObjectAttributes, PALPC_PORT_ATTRIBUTES PortAttributes, PVOID PortContext,  PPORT_MESSAGE ConnectionRequest, PALPC_MESSAGE_ATTRIBUTES ConnectionMessageAttributes, BOOLEAN AcceptConnection){
	SyscallInforPrint(ALPCACCEPTCONNECTPORT_7_INDEX);
	if(silence(ALPCACCEPTCONNECTPORT_7_INDEX,4)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTALPCACCEPTCONNECTPORT)(oldNtAlpcAcceptConnectPort))(PortHandle, ConnectionPortHandle, Flags, ObjectAttributes, PortAttributes, PortContext, ConnectionRequest, ConnectionMessageAttributes, AcceptConnection);
}

NTSTATUS newNtAlpcCancelMessage(HANDLE PortHandle, ULONG Flags, PALPC_CONTEXT_ATTR MessageContext){
	SyscallInforPrint(ALPCCANCELMESSAGE_7_INDEX);
	return ((NTALPCCANCELMESSAGE)(oldNtAlpcCancelMessage))(PortHandle, Flags, MessageContext);
} 

NTSTATUS newNtAlpcConnectPort(PHANDLE PortHandle, PUNICODE_STRING PortName, POBJECT_ATTRIBUTES ObjectAttributes, PALPC_PORT_ATTRIBUTES PortAttributes, ULONG Flags, PSID RequiredServerSid, PPORT_MESSAGE ConnectionMessage, PULONG BufferLength, PALPC_MESSAGE_ATTRIBUTES OutMessageAttributes, PALPC_MESSAGE_ATTRIBUTES InMessageAttributes, PLARGE_INTEGER Timeout){
	SyscallInforPrint(ALPCCONNECTPORT_7_INDEX);
	return ((NTALPCCONNECTPORT)(oldNtAlpcConnectPort))(PortHandle, PortName, ObjectAttributes, PortAttributes, Flags, RequiredServerSid, ConnectionMessage, BufferLength, OutMessageAttributes, InMessageAttributes, Timeout);
}

NTSTATUS newNtAlpcDisconnectPort(HANDLE PortHandle, ULONG Flags){
	SyscallInforPrint(ALPCDISCONNECTPORT_7_INDEX);
	if(silence(ALPCDISCONNECTPORT_7_INDEX,4)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTALPCDISCONNECTPORT)(oldNtAlpcDisconnectPort))(PortHandle, Flags);
}

NTSTATUS newNtAlpcCreatePort(PHANDLE PortHandle, POBJECT_ATTRIBUTES ObjectAttributes, PALPC_PORT_ATTRIBUTES PortAttributes){
	SyscallInforPrint(ALPCCREATEPORT_7_INDEX);
	if(silence(ALPCCREATEPORT_7_INDEX,4)){
		sleepms(SLEEPTIME);
		DbgPrint("s4 \n\n");
	}
	return ((NTALPCCREATEPORT)(oldNtAlpcCreatePort))(PortHandle, ObjectAttributes, PortAttributes);
}

NTSTATUS newNtAlpcCreatePortSection(HANDLE PortHandle, ULONG Flags, HANDLE SectionHandle, SIZE_T SectionSize, PALPC_HANDLE AlpcSectionHandle, PSIZE_T ActualSectionSize){
	SyscallInforPrint(ALPCCREATEPORTSECTION_7_INDEX);
	if(silence(ALPCCREATEPORTSECTION_7_INDEX,4)){
		DbgPrint("s4 \n\n");
		return STATUS_SUCCESS;
	}
	return ((NTALPCCREATEPORTSECTION)(oldNtAlpcCreatePortSection))(PortHandle, Flags, SectionHandle, SectionSize, AlpcSectionHandle, ActualSectionSize);
}

NTSTATUS newNtAlpcCreateResourceReserve(HANDLE PortHandle, _Reserved_ ULONG Flags, SIZE_T MessageSize, PALPC_HANDLE ResourceId){
	SyscallInforPrint(ALPCCREATERESOURCERESERVE_7_INDEX);
	return ((NTALPCCREATERESOURCERESERVE)(oldNtAlpcCreateResourceReserve))(PortHandle, Flags, MessageSize, ResourceId);
}

NTSTATUS newNtAlpcCreateSectionView(HANDLE PortHandle, _Reserved_ ULONG Flags, PALPC_DATA_VIEW_ATTR ViewAttributes){
	SyscallInforPrint(ALPCCREATESECTIONVIEW_7_INDEX);
	return ((NTALPCCREATESECTIONVIEW)(oldNtAlpcCreateSectionView))(PortHandle, Flags, ViewAttributes);
} 

NTSTATUS newNtAlpcCreateSecurityContext(HANDLE PortHandle, _Reserved_ ULONG Flags, PALPC_SECURITY_ATTR SecurityAttribute){
	SyscallInforPrint(ALPCCREATESECURITYCONTEXT_7_INDEX);
	return ((NTALPCCREATESECURITYCONTEXT)(oldNtAlpcCreateSecurityContext))(PortHandle, Flags, SecurityAttribute);
}

NTSTATUS newNtAlpcDeletePortSection(HANDLE PortHandle, _Reserved_ ULONG Flags, ALPC_HANDLE SectionHandle){
	SyscallInforPrint(ALPCDELETEPORTSECTION_7_INDEX);
	return ((NTALPCDELETEPORTSECTION)(oldNtAlpcDeletePortSection))(PortHandle, Flags, SectionHandle);
}

NTSTATUS newNtAlpcDeleteResourceReserve(HANDLE PortHandle, _Reserved_ ULONG Flags, ALPC_HANDLE ResourceId){
	SyscallInforPrint(ALPCDELETERESOURCERESERVE_7_INDEX);
	return ((NTALPCDELETERESOURCERESERVE)(oldNtAlpcDeleteResourceReserve))(PortHandle, Flags, ResourceId);
}

NTSTATUS newNtAlpcDeleteSectionView(HANDLE PortHandle, _Reserved_ ULONG Flags, PVOID ViewBase){
	SyscallInforPrint(ALPCDELETESECTIONVIEW_7_INDEX);
	return ((NTALPCDELETESECTIONVIEW)(oldNtAlpcDeleteSectionView))(PortHandle, Flags, ViewBase);
} 

NTSTATUS newNtAlpcDeleteSecurityContext(HANDLE PortHandle, _Reserved_ ULONG Flags, ALPC_HANDLE ContextHandle){
	SyscallInforPrint(ALPCDELETESECURITYCONTEXT_7_INDEX);
	return ((NTALPCDELETESECURITYCONTEXT)(oldNtAlpcDeleteSecurityContext))(PortHandle, Flags, ContextHandle);
}  

NTSTATUS newNtAlpcImpersonateClientOfPort(HANDLE PortHandle, PPORT_MESSAGE Message, PVOID Flags){
	SyscallInforPrint(ALPCIMPERSONATECLIENTOFPORT_7_INDEX);
	return ((NTALPCIMPERSONATECLIENTOFPORT)(oldNtAlpcImpersonateClientOfPort))(PortHandle, Message, Flags);
}

NTSTATUS newNtAlpcQueryInformation(HANDLE PortHandle, ALPC_PORT_INFORMATION_CLASS PortInformationClass, _Inout_updates_bytes_to_(Length,*ReturnLength) PVOID PortInformation, ULONG Length,   PULONG ReturnLength){
	SyscallInforPrint(ALPCQUERYINFORMATION_7_INDEX);
	return ((NTALPCQUERYINFORMATION)(oldNtAlpcQueryInformation))(PortHandle, PortInformationClass, PortInformation, Length, ReturnLength);
}

NTSTATUS newNtAlpcQueryInformationMessage(HANDLE PortHandle, PPORT_MESSAGE PortMessage, ALPC_MESSAGE_INFORMATION_CLASS MessageInformationClass, PVOID MessageInformation, ULONG Length,   PULONG ReturnLength){
	SyscallInforPrint(ALPCQUERYINFORMATIONMESSAGE_7_INDEX);
	return ((NTALPCQUERYINFORMATIONMESSAGE)(oldNtAlpcQueryInformationMessage))(PortHandle, PortMessage, MessageInformationClass, MessageInformation, Length, ReturnLength);
}

NTSTATUS newNtAlpcRevokeSecurityContext(HANDLE PortHandle, _Reserved_ ULONG Flags, ALPC_HANDLE ContextHandle){
	SyscallInforPrint(ALPCREVOKESECURITYCONTEXT_7_INDEX);
	return ((NTALPCREVOKESECURITYCONTEXT)(oldNtAlpcRevokeSecurityContext))(PortHandle, Flags, ContextHandle);
} 

NTSTATUS newNtAlpcSetInformation(HANDLE PortHandle, ALPC_PORT_INFORMATION_CLASS PortInformationClass,    PVOID PortInformation, ULONG Length){
	SyscallInforPrint(ALPCSETINFORMATION_7_INDEX);
	return ((NTALPCSETINFORMATION)(oldNtAlpcSetInformation))(PortHandle, PortInformationClass, PortInformation, Length);
}

NTSTATUS newNtApphelpCacheControl(APPHELPCACHESERVICECLASS Service, PAPPHELP_CACHE_SERVICE_LOOKUP ServiceData){
	SyscallInforPrint(APPHELPCACHECONTROL_7_INDEX);
	return ((NTAPPHELPCACHECONTROL)(oldNtApphelpCacheControl))(Service, ServiceData);
}

NTSTATUS newNtAreMappedFilesTheSame(PVOID File1MappedAsAnImage, PVOID File2MappedAsFile){
	SyscallInforPrint(AREMAPPEDFILESTHESAME_7_INDEX);
	return ((NTAREMAPPEDFILESTHESAME)(oldNtAreMappedFilesTheSame))(File1MappedAsAnImage, File2MappedAsFile);
}

NTSTATUS newNtAssignProcessToJobObject(HANDLE JobHandle, HANDLE ProcessHandle){
	SyscallInforPrint(ASSIGNPROCESSTOJOBOBJECT_7_INDEX);
	return ((NTASSIGNPROCESSTOJOBOBJECT)(oldNtAssignProcessToJobObject))(JobHandle, ProcessHandle);
}

NTSTATUS newNtCancelIoFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock){
	SyscallInforPrint(CANCELIOFILE_7_INDEX);
	return ((NTCANCELIOFILE)(oldNtCancelIoFile))(FileHandle, IoStatusBlock);
}

NTSTATUS newNtCancelIoFileEx(HANDLE FileHandle, PIO_STATUS_BLOCK IoRequestToCancel, PIO_STATUS_BLOCK IoStatusBlock){
	SyscallInforPrint(CANCELIOFILEEX_7_INDEX);
	return ((NTCANCELIOFILEEX)(oldNtCancelIoFileEx))(FileHandle, IoRequestToCancel, IoStatusBlock);
} 

NTSTATUS newNtCancelSynchronousIoFile(HANDLE ThreadHandle, PIO_STATUS_BLOCK IoRequestToCancel, PIO_STATUS_BLOCK IoStatusBlock){
	SyscallInforPrint(CANCELSYNCHRONOUSIOFILE_7_INDEX);
	return ((NTCANCELSYNCHRONOUSIOFILE)(oldNtCancelSynchronousIoFile))(ThreadHandle, IoRequestToCancel, IoStatusBlock);
}

NTSTATUS newNtCancelTimer(HANDLE TimerHandle, PBOOLEAN CurrentState){
	SyscallInforPrint(CANCELTIMER_7_INDEX);
	return ((NTCANCELTIMER)(oldNtCancelTimer))(TimerHandle, CurrentState);
}

NTSTATUS newNtClearEvent(HANDLE EventHandle){
	SyscallInforPrint(CLEAREVENT_7_INDEX);
	return ((NTCLEAREVENT)(oldNtClearEvent))(EventHandle);
}

NTSTATUS newNtCommitComplete(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(COMMITCOMPLETE_7_INDEX);
	return ((NTCOMMITCOMPLETE)(oldNtCommitComplete))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtCommitEnlistment(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(COMMITENLISTMENT_7_INDEX);
	return ((NTCOMMITENLISTMENT)(oldNtCommitEnlistment))(EnlistmentHandle, TmVirtualClock);
} 

NTSTATUS newNtCommitTransaction(HANDLE TransactionHandle, BOOLEAN Wait){
	SyscallInforPrint(COMMITTRANSACTION_7_INDEX);
	return ((NTCOMMITTRANSACTION)(oldNtCommitTransaction))(TransactionHandle, Wait);
} 

NTSTATUS newNtCompactKeys(ULONG NrOfKeys, HANDLE KeysArray[]){
	SyscallInforPrint(COMPACTKEYS_7_INDEX);
	return ((NTCOMPACTKEYS)(oldNtCompactKeys))(NrOfKeys, KeysArray);
}

NTSTATUS newNtCompareTokens(HANDLE FirstTokenHandle, HANDLE SecondTokenHandle, PBOOLEAN Equal){
	SyscallInforPrint(COMPARETOKENS_7_INDEX);
	return ((NTCOMPARETOKENS)(oldNtCompareTokens))(FirstTokenHandle, SecondTokenHandle, Equal);
}

NTSTATUS newNtCompressKey(HANDLE Key){
	SyscallInforPrint(COMPRESSKEY_7_INDEX);
	return ((NTCOMPRESSKEY)(oldNtCompressKey))(Key);
}

NTSTATUS newNtCreateDebugObject(PHANDLE DebugObjectHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, ULONG Flags){
	SyscallInforPrint(CREATEDEBUGOBJECT_7_INDEX);
	return ((NTCREATEDEBUGOBJECT)(oldNtCreateDebugObject))(DebugObjectHandle, DesiredAccess, ObjectAttributes, Flags);
}

NTSTATUS newNtCreateEnlistment(PHANDLE EnlistmentHandle, ACCESS_MASK DesiredAccess, HANDLE ResourceManagerHandle, HANDLE TransactionHandle, POBJECT_ATTRIBUTES ObjectAttributes, ULONG CreateOptions, NOTIFICATION_MASK NotificationMask, PVOID EnlistmentKey){
	SyscallInforPrint(CREATEENLISTMENT_7_INDEX);
	return ((NTCREATEENLISTMENT)(oldNtCreateEnlistment))(EnlistmentHandle, DesiredAccess, ResourceManagerHandle, TransactionHandle, ObjectAttributes, CreateOptions, NotificationMask, EnlistmentKey);
}

NTSTATUS newNtCreateEventPair(PHANDLE EventPairHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL){
	SyscallInforPrint(CREATEEVENTPAIR_7_INDEX);
	return ((NTCREATEEVENTPAIR)(oldNtCreateEventPair))(EventPairHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtCreateIoCompletion(PHANDLE IoCompletionHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL, ULONG NumberOfConcurrentThreads){
	SyscallInforPrint(CREATEIOCOMPLETION_7_INDEX);
	return ((NTCREATEIOCOMPLETION)(oldNtCreateIoCompletion))(IoCompletionHandle, DesiredAccess, ObjectAttributes, NumberOfConcurrentThreads);
}

NTSTATUS newNtCreateJobObject(PHANDLE JobHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(CREATEJOBOBJECT_7_INDEX);
	return ((NTCREATEJOBOBJECT)(oldNtCreateJobObject))(JobHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtCreateJobSet(ULONG NumJob, PJOB_SET_ARRAY UserJobSet, ULONG Flags){
	SyscallInforPrint(CREATEJOBSET_7_INDEX);
	return ((NTCREATEJOBSET)(oldNtCreateJobSet))(NumJob, UserJobSet, Flags);
}

NTSTATUS newNtCreateKeyedEvent(PHANDLE OutHandle, ACCESS_MASK AccessMask, POBJECT_ATTRIBUTES ObjectAttributes, ULONG Flags){
	SyscallInforPrint(CREATEKEYEDEVENT_7_INDEX);
	return ((NTCREATEKEYEDEVENT)(oldNtCreateKeyedEvent))(OutHandle, AccessMask, ObjectAttributes, Flags);
}

NTSTATUS newNtCreateMailslotFile(PHANDLE pHandle, ULONG DesiredAccess, POBJECT_ATTRIBUTES attr, PIO_STATUS_BLOCK  IoStatusBlock, ULONG CreateOptions, ULONG MailslotQuota, ULONG MaxMessageSize, PLARGE_INTEGER TimeOut){
	SyscallInforPrint(CREATEMAILSLOTFILE_7_INDEX);
	return ((NTCREATEMAILSLOTFILE)(oldNtCreateMailslotFile))(pHandle, DesiredAccess, attr, IoStatusBlock, CreateOptions, MailslotQuota, MaxMessageSize, TimeOut);
}

NTSTATUS newNtCreateNamedPipeFile(PHANDLE FileHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PIO_STATUS_BLOCK IoStatusBlock, ULONG ShareAccess, ULONG CreateDisposition, ULONG CreateOptions, ULONG NamedPipeType, ULONG ReadMode, ULONG CompletionMode, ULONG MaximumInstances, ULONG InboundQuota, ULONG OutboundQuota, PLARGE_INTEGER DefaultTimeout){
	SyscallInforPrint(CREATENAMEDPIPEFILE_7_INDEX);
	return ((NTCREATENAMEDPIPEFILE)(oldNtCreateNamedPipeFile))(FileHandle, DesiredAccess, ObjectAttributes, IoStatusBlock, ShareAccess, CreateDisposition, CreateOptions, NamedPipeType, ReadMode, CompletionMode, MaximumInstances, InboundQuota, OutboundQuota, DefaultTimeout);
}

NTSTATUS newNtCreatePagingFile(PUNICODE_STRING FileName, PLARGE_INTEGER InitialSize, PLARGE_INTEGER MaximumSize, ULONG Reserved){
	SyscallInforPrint(CREATEPAGINGFILE_7_INDEX);
	return ((NTCREATEPAGINGFILE)(oldNtCreatePagingFile))(FileName, InitialSize, MaximumSize, Reserved);
}

NTSTATUS newNtCreatePrivateNamespace(PHANDLE NamespaceHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PVOID BoundaryDescriptor){
	SyscallInforPrint(CREATEPRIVATENAMESPACE_7_INDEX);
	return ((NTCREATEPRIVATENAMESPACE)(oldNtCreatePrivateNamespace))(NamespaceHandle, DesiredAccess, ObjectAttributes, BoundaryDescriptor);
}

NTSTATUS newNtCreateProfile(PHANDLE ProfileHandle, HANDLE Process OPTIONAL, PVOID ImageBase, ULONG  ImageSize, ULONG  BucketSize, PVOID  Buffer, ULONG  BufferSize, KPROFILE_SOURCE ProfileSource, KAFFINITY Affinity){
	SyscallInforPrint(CREATEPROFILE_7_INDEX);
	return ((NTCREATEPROFILE)(oldNtCreateProfile))(ProfileHandle, Process, ImageBase, ImageSize, BucketSize, Buffer, BufferSize, ProfileSource, Affinity);
}

NTSTATUS newNtCreateProfileEx(PHANDLE ProfileHandle, HANDLE ProcessHandle, PVOID ImageBase, SIZE_T ImageSize, ULONG Granularity, PVOID Buffer, ULONG ProfilingSize, KPROFILE_SOURCE Source, USHORT GroupCount,   PGROUP_AFFINITY Affinity){
	SyscallInforPrint(CREATEPROFILEEX_7_INDEX);
	return ((NTCREATEPROFILEEX)(oldNtCreateProfileEx))(ProfileHandle, ProcessHandle, ImageBase, ImageSize, Granularity, Buffer, ProfilingSize, Source, GroupCount, Affinity);
}

NTSTATUS newNtCreateResourceManager(PHANDLE ResourceManagerHandle, ACCESS_MASK  DesiredAccess, HANDLE  TmHandle, LPGUID  ResourceManagerGuid, POBJECT_ATTRIBUTES ObjectAttributes, ULONG CreateOptions, PUNICODE_STRING Description){
	SyscallInforPrint(CREATERESOURCEMANAGER_7_INDEX);
	return ((NTCREATERESOURCEMANAGER)(oldNtCreateResourceManager))(ResourceManagerHandle, DesiredAccess, TmHandle, ResourceManagerGuid, ObjectAttributes, CreateOptions, Description);
}

NTSTATUS newNtCreateSemaphore(PHANDLE SemaphoreHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL, LONG InitialCount, LONG MaximumCount){
	SyscallInforPrint(CREATESEMAPHORE_7_INDEX);
	return ((NTCREATESEMAPHORE)(oldNtCreateSemaphore))(SemaphoreHandle, DesiredAccess, ObjectAttributes, InitialCount, MaximumCount);
}

NTSTATUS newNtCreateSymbolicLinkObject(PHANDLE SymbolicLinkHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES attr, PUNICODE_STRING TargetName){
	SyscallInforPrint(CREATESYMBOLICLINKOBJECT_7_INDEX);
	return ((NTCREATESYMBOLICLINKOBJECT)(oldNtCreateSymbolicLinkObject))(SymbolicLinkHandle, DesiredAccess, attr, TargetName);
}

NTSTATUS newNtCreateTimer(PHANDLE TimerHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL, TIMER_TYPE TimerType){
	SyscallInforPrint(CREATETIMER_7_INDEX);
	return ((NTCREATETIMER)(oldNtCreateTimer))(TimerHandle, DesiredAccess, ObjectAttributes, TimerType);
}

NTSTATUS newNtCreateToken(PHANDLE TokenHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, TOKEN_TYPE TokenType, PLUID AuthenticationId, PLARGE_INTEGER ExpirationTime, PTOKEN_USER TokenUser, PTOKEN_GROUPS TokenGroups, PTOKEN_PRIVILEGES TokenPrivileges, PTOKEN_OWNER TokenOwner, PTOKEN_PRIMARY_GROUP TokenPrimaryGroup, PTOKEN_DEFAULT_DACL TokenDefaultDacl, PTOKEN_SOURCE TokenSource){
	SyscallInforPrint(CREATETOKEN_7_INDEX);
	return ((NTCREATETOKEN)(oldNtCreateToken))(TokenHandle, DesiredAccess, ObjectAttributes, TokenType, AuthenticationId, ExpirationTime, TokenUser, TokenGroups, TokenPrivileges, TokenOwner, TokenPrimaryGroup, TokenDefaultDacl, TokenSource);
}

NTSTATUS newNtCreateTransaction(PHANDLE TransactionHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, LPGUID Uow, HANDLE TmHandle, ULONG CreateOptions, ULONG IsolationLevel, ULONG IsolationFlags, PLARGE_INTEGER Timeout, PUNICODE_STRING Description){
	SyscallInforPrint(CREATETRANSACTION_7_INDEX);
	return ((NTCREATETRANSACTION)(oldNtCreateTransaction))(TransactionHandle, DesiredAccess, ObjectAttributes, Uow, TmHandle, CreateOptions, IsolationLevel, IsolationFlags, Timeout, Description);
} 

NTSTATUS newNtCreateTransactionManager(PHANDLE TmHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PUNICODE_STRING LogFileName, ULONG CreateOptions, ULONG CommitStrength){
	SyscallInforPrint(CREATETRANSACTIONMANAGER_7_INDEX);
	return ((NTCREATETRANSACTIONMANAGER)(oldNtCreateTransactionManager))(TmHandle, DesiredAccess, ObjectAttributes, LogFileName, CreateOptions, CommitStrength);
} 

NTSTATUS newNtCreateWaitablePort(PHANDLE PortHandle, POBJECT_ATTRIBUTES ObjectAttributes, ULONG MaxConnectionInfoLength, ULONG MaxMessageLength, ULONG MaxPoolUsage){
	SyscallInforPrint(CREATEWAITABLEPORT_7_INDEX);
	return ((NTCREATEWAITABLEPORT)(oldNtCreateWaitablePort))(PortHandle, ObjectAttributes, MaxConnectionInfoLength, MaxMessageLength, MaxPoolUsage);
} 

NTSTATUS newNtCreateWorkerFactory(PHANDLE WorkerFactoryHandleReturn, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE CompletionPortHandle, HANDLE WorkerProcessHandle, PVOID StartRoutine, PVOID StartParameter, ULONG MaxThreadCount, SIZE_T StackReserve, SIZE_T StackCommit){
	SyscallInforPrint(CREATEWORKERFACTORY_7_INDEX);
	return ((NTCREATEWORKERFACTORY)(oldNtCreateWorkerFactory))(WorkerFactoryHandleReturn, DesiredAccess, ObjectAttributes, CompletionPortHandle, WorkerProcessHandle, StartRoutine, StartParameter, MaxThreadCount, StackReserve, StackCommit);
}

NTSTATUS newNtDebugContinue(HANDLE DebugObjectHandle, PCLIENT_ID ClientId, NTSTATUS nt){
	SyscallInforPrint(DEBUGCONTINUE_7_INDEX);
	return ((NTDEBUGCONTINUE)(oldNtDebugContinue))(DebugObjectHandle, ClientId, nt);
}

NTSTATUS newNtDeleteAtom(RTL_ATOM Atom){
	SyscallInforPrint(DELETEATOM_7_INDEX);
	return ((NTDELETEATOM)(oldNtDeleteAtom))(Atom);
}

NTSTATUS newNtDeleteBootEntry(ULONG Id){
	SyscallInforPrint(DELETEBOOTENTRY_7_INDEX);
	return ((NTDELETEBOOTENTRY)(oldNtDeleteBootEntry))(Id);
}

NTSTATUS newNtDeleteDriverEntry(ULONG Id){
	SyscallInforPrint(DELETEDRIVERENTRY_7_INDEX);
	return ((NTDELETEDRIVERENTRY)(oldNtDeleteDriverEntry))(Id);
}

NTSTATUS newNtDeleteObjectAuditAlarm(PUNICODE_STRING SubsystemName, HANDLE ObjectHandle OPTIONAL, BOOLEAN GenerateOnClose){
	SyscallInforPrint(DELETEOBJECTAUDITALARM_7_INDEX);
	return ((NTDELETEOBJECTAUDITALARM)(oldNtDeleteObjectAuditAlarm))(SubsystemName, ObjectHandle, GenerateOnClose);
}

NTSTATUS newNtDeletePrivateNamespace(HANDLE NamespaceHandle){
	SyscallInforPrint(DELETEPRIVATENAMESPACE_7_INDEX);
	return ((NTDELETEPRIVATENAMESPACE)(oldNtDeletePrivateNamespace))(NamespaceHandle);
}

NTSTATUS newNtDisableLastKnownGood(VOID){
	SyscallInforPrint(DISABLELASTKNOWNGOOD_7_INDEX);
	return ((NTDISABLELASTKNOWNGOOD)(oldNtDisableLastKnownGood))();
}

NTSTATUS newNtDisplayString(PUNICODE_STRING String){
	SyscallInforPrint(DISPLAYSTRING_7_INDEX);
	return ((NTDISPLAYSTRING)(oldNtDisplayString))(String);
}

NTSTATUS newNtDrawText(PUNICODE_STRING Text){
	SyscallInforPrint(DRAWTEXT_7_INDEX);
	return ((NTDRAWTEXT)(oldNtDrawText))(Text);
}

NTSTATUS newNtEnableLastKnownGood(VOID){
	SyscallInforPrint(ENABLELASTKNOWNGOOD_7_INDEX);
	return ((NTENABLELASTKNOWNGOOD)(oldNtEnableLastKnownGood))();
}

NTSTATUS newNtEnumerateBootEntries(PVOID Buffer, PULONG BufferLength){
	SyscallInforPrint(ENUMERATEBOOTENTRIES_7_INDEX);
	return ((NTENUMERATEBOOTENTRIES)(oldNtEnumerateBootEntries))(Buffer, BufferLength);
}

NTSTATUS newNtEnumerateDriverEntries(PVOID Buffer, PULONG BufferLength){
	SyscallInforPrint(ENUMERATEDRIVERENTRIES_7_INDEX);
	return ((NTENUMERATEDRIVERENTRIES)(oldNtEnumerateDriverEntries))(Buffer, BufferLength);
}

NTSTATUS newNtEnumerateSystemEnvironmentValuesEx(ULONG InformationClass, PVOID Buffer, PULONG BufferLength){
	SyscallInforPrint(ENUMERATESYSTEMENVIRONMENTVALUESEX_7_INDEX);
	return ((NTENUMERATESYSTEMENVIRONMENTVALUESEX)(oldNtEnumerateSystemEnvironmentValuesEx))(InformationClass, Buffer, BufferLength);
}

NTSTATUS newNtEnumerateTransactionObject(HANDLE RootObjectHandle, KTMOBJECT_TYPE QueryType, PKTMOBJECT_CURSOR ObjectCursor, ULONG ObjectCursorLength, PULONG ReturnLength){
	SyscallInforPrint(ENUMERATETRANSACTIONOBJECT_7_INDEX);
	return ((NTENUMERATETRANSACTIONOBJECT)(oldNtEnumerateTransactionObject))(RootObjectHandle, QueryType, ObjectCursor, ObjectCursorLength, ReturnLength);
}

NTSTATUS newNtExtendSection(HANDLE SectionHandle, PLARGE_INTEGER NewSectionSize){
	SyscallInforPrint(EXTENDSECTION_7_INDEX);
	return ((NTEXTENDSECTION)(oldNtExtendSection))(SectionHandle, NewSectionSize);
}

NTSTATUS newNtFilterToken(HANDLE ExistingTokenHandle, ULONG Flags, PTOKEN_GROUPS SidsToDisable, PTOKEN_PRIVILEGES PrivilegesToDelete, PTOKEN_GROUPS RestrictedSids, PHANDLE NewTokenHandle){
	SyscallInforPrint(FILTERTOKEN_7_INDEX);
	return ((NTFILTERTOKEN)(oldNtFilterToken))(ExistingTokenHandle, Flags, SidsToDisable, PrivilegesToDelete, RestrictedSids, NewTokenHandle);
}

NTSTATUS newNtFindAtom(PWCHAR AtomName, PRTL_ATOM Atom OPTIONAL){
	SyscallInforPrint(FINDATOM_7_INDEX);
	return ((NTFINDATOM)(oldNtFindAtom))(AtomName, Atom);
}

NTSTATUS newNtFlushWriteBuffer(VOID){
	SyscallInforPrint(FLUSHWRITEBUFFER_7_INDEX);
	return ((NTFLUSHWRITEBUFFER)(oldNtFlushWriteBuffer))();
}

NTSTATUS newNtFreeUserPhysicalPages(HANDLE ProcessHandle, PULONG_PTR NumberOfPages, PULONG_PTR UserPfnArray){
	SyscallInforPrint(FREEUSERPHYSICALPAGES_7_INDEX);
	return ((NTFREEUSERPHYSICALPAGES)(oldNtFreeUserPhysicalPages))(ProcessHandle, NumberOfPages, UserPfnArray);
}

NTSTATUS newNtFreezeRegistry(ULONG TimeOutInSeconds){
	SyscallInforPrint(FREEZEREGISTRY_7_INDEX);
	return ((NTFREEZEREGISTRY)(oldNtFreezeRegistry))(TimeOutInSeconds);
}

NTSTATUS newNtFreezeTransactions(PLARGE_INTEGER FreezeTimeout, PLARGE_INTEGER ThawTimeout){
	SyscallInforPrint(FREEZETRANSACTIONS_7_INDEX);
	return ((NTFREEZETRANSACTIONS)(oldNtFreezeTransactions))(FreezeTimeout, ThawTimeout);
}

ULONG newNtGetCurrentProcessorNumber(void){
	SyscallInforPrint(GETCURRENTPROCESSORNUMBER_7_INDEX);
	return ((NTGETCURRENTPROCESSORNUMBER)(oldNtGetCurrentProcessorNumber))();
}

NTSTATUS newNtGetDevicePowerState(HANDLE Device,  PDEVICE_POWER_STATE State){
	SyscallInforPrint(GETDEVICEPOWERSTATE_7_INDEX);
	return ((NTGETDEVICEPOWERSTATE)(oldNtGetDevicePowerState))(Device, State);
}

NTSTATUS newNtGetNextProcess(HANDLE ProcessHandle, ACCESS_MASK DesiredAccess, ULONG HandleAttributes, ULONG Flags, PHANDLE NewProcessHandle){
	SyscallInforPrint(GETNEXTPROCESS_7_INDEX);
	return ((NTGETNEXTPROCESS)(oldNtGetNextProcess))(ProcessHandle, DesiredAccess, HandleAttributes, Flags, NewProcessHandle);
}

NTSTATUS newNtGetNextThread(HANDLE ProcessHandle, HANDLE ThreadHandle, ACCESS_MASK DesiredAccess, ULONG HandleAttributes, ULONG Flags, PHANDLE NewThreadHandle){
	SyscallInforPrint(GETNEXTTHREAD_7_INDEX);
	return ((NTGETNEXTTHREAD)(oldNtGetNextThread))(ProcessHandle, ThreadHandle, DesiredAccess, HandleAttributes, Flags, NewThreadHandle);
}

NTSTATUS newNtGetNlsSectionPtr(ULONG SectionType, ULONG SectionData, PVOID ContextData, PVOID *SectionPointer, PULONG SectionSize){
	SyscallInforPrint(GETNLSSECTIONPTR_7_INDEX);
	return ((NTGETNLSSECTIONPTR)(oldNtGetNlsSectionPtr))(SectionType, SectionData, ContextData, SectionPointer, SectionSize);
}

NTSTATUS newNtGetNotificationResourceManager(HANDLE ResourceManagerHandle, PTRANSACTION_NOTIFICATION TransactionNotification, ULONG NotificationLength, PLARGE_INTEGER Timeout, PULONG ReturnLength, ULONG Asynchronous, ULONG_PTR AsynchronousContext){
	SyscallInforPrint(GETNOTIFICATIONRESOURCEMANAGER_7_INDEX);
	return ((NTGETNOTIFICATIONRESOURCEMANAGER)(oldNtGetNotificationResourceManager))(ResourceManagerHandle, TransactionNotification, NotificationLength, Timeout, ReturnLength, Asynchronous, AsynchronousContext);
}

NTSTATUS newNtGetPlugPlayEvent(ULONG Reserved1, ULONG Reserved2, PPLUGPLAY_EVENT_BLOCK Buffer, ULONG BufferSize){
	SyscallInforPrint(GETPLUGPLAYEVENT_7_INDEX);
	return ((NTGETPLUGPLAYEVENT)(oldNtGetPlugPlayEvent))(Reserved1, Reserved2, Buffer, BufferSize);
}

NTSTATUS newNtGetWriteWatch(HANDLE ProcessHandle, ULONG Flags, PVOID BaseAddress, SIZE_T RegionSize, PVOID *UserAddressArray, PULONG_PTR EntriesInUserAddressArray, PULONG Granularity){
	SyscallInforPrint(GETWRITEWATCH_7_INDEX);
	return ((NTGETWRITEWATCH)(oldNtGetWriteWatch))(ProcessHandle, Flags, BaseAddress, RegionSize, UserAddressArray, EntriesInUserAddressArray, Granularity);
}

NTSTATUS newNtImpersonateAnonymousToken(HANDLE ThreadHandle){
	SyscallInforPrint(IMPERSONATEANONYMOUSTOKEN_7_INDEX);
	return ((NTIMPERSONATEANONYMOUSTOKEN)(oldNtImpersonateAnonymousToken))(ThreadHandle);
}

NTSTATUS newNtInitializeNlsFiles(PVOID *BaseAddress, PLCID DefaultLocaleId, PLARGE_INTEGER DefaultCasingTableSize){
	SyscallInforPrint(INITIALIZENLSFILES_7_INDEX);
	return ((NTINITIALIZENLSFILES)(oldNtInitializeNlsFiles))(BaseAddress, DefaultLocaleId, DefaultCasingTableSize);
}

NTSTATUS newNtInitializeRegistry(USHORT Flag){
	SyscallInforPrint(INITIALIZEREGISTRY_7_INDEX);
	return ((NTINITIALIZEREGISTRY)(oldNtInitializeRegistry))(Flag);
}

NTSTATUS newNtInitiatePowerAction(POWER_ACTION SystemAction, SYSTEM_POWER_STATE LightestSystemState, ULONG Flags, BOOLEAN Asynchronous){
	SyscallInforPrint(INITIATEPOWERACTION_7_INDEX);
	return ((NTINITIATEPOWERACTION)(oldNtInitiatePowerAction))(SystemAction, LightestSystemState, Flags, Asynchronous);
}

NTSTATUS newNtIsProcessInJob(HANDLE ProcessHandle, HANDLE JobHandle OPTIONAL){
	SyscallInforPrint(ISPROCESSINJOB_7_INDEX);
	return ((NTISPROCESSINJOB)(oldNtIsProcessInJob))(ProcessHandle, JobHandle);
}

BOOLEAN newNtIsSystemResumeAutomatic(VOID){
	SyscallInforPrint(ISSYSTEMRESUMEAUTOMATIC_7_INDEX);
	return ((NTISSYSTEMRESUMEAUTOMATIC)(oldNtIsSystemResumeAutomatic))();
}

NTSTATUS newNtLoadKey(POBJECT_ATTRIBUTES DestinationKeyName, POBJECT_ATTRIBUTES  HiveFileName){
	SyscallInforPrint(LOADKEY_7_INDEX);
	return ((NTLOADKEY)(oldNtLoadKey))(DestinationKeyName, HiveFileName);
}

NTSTATUS newNtLoadKey2(POBJECT_ATTRIBUTES KeyObjectAttributes, POBJECT_ATTRIBUTES FileObjectAttributes, ULONG Flags){
	SyscallInforPrint(LOADKEY2_7_INDEX);
	return ((NTLOADKEY2)(oldNtLoadKey2))(KeyObjectAttributes, FileObjectAttributes, Flags);
}

NTSTATUS newNtLoadKeyEx(POBJECT_ATTRIBUTES TargetKey, POBJECT_ATTRIBUTES SourceFile, ULONG Flags, HANDLE TrustClassKey){
	SyscallInforPrint(LOADKEYEX_7_INDEX);
	return ((NTLOADKEYEX)(oldNtLoadKeyEx))(TargetKey, SourceFile, Flags, TrustClassKey);
}

NTSTATUS newNtLockProductActivationKeys(PULONG pPrivateVer, PULONG pSafeMode){
	SyscallInforPrint(LOCKPRODUCTACTIVATIONKEYS_7_INDEX);
	return ((NTLOCKPRODUCTACTIVATIONKEYS)(oldNtLockProductActivationKeys))(pPrivateVer, pSafeMode);
}

NTSTATUS newNtLockRegistryKey(HANDLE KeyHandle){
	SyscallInforPrint(LOCKREGISTRYKEY_7_INDEX);
	return ((NTLOCKREGISTRYKEY)(oldNtLockRegistryKey))(KeyHandle);
}

NTSTATUS newNtMakePermanentObject(HANDLE ObjectHandle){
	SyscallInforPrint(MAKEPERMANENTOBJECT_7_INDEX);
	return ((NTMAKEPERMANENTOBJECT)(oldNtMakePermanentObject))(ObjectHandle);
}

NTSTATUS newNtMapUserPhysicalPages(PVOID VirtualAddresses, ULONG_PTR NumberOfPages, PULONG_PTR UserPfnArray){
	SyscallInforPrint(MAPUSERPHYSICALPAGES_7_INDEX);
	return ((NTMAPUSERPHYSICALPAGES)(oldNtMapUserPhysicalPages))(VirtualAddresses, NumberOfPages, UserPfnArray);
}

NTSTATUS newNtMapUserPhysicalPagesScatter(PVOID *VirtualAddresses, ULONG_PTR NumberOfPages, PULONG_PTR UserPfnArray){
	SyscallInforPrint(MAPUSERPHYSICALPAGESSCATTER_7_INDEX);
	return ((NTMAPUSERPHYSICALPAGESSCATTER)(oldNtMapUserPhysicalPagesScatter))(VirtualAddresses, NumberOfPages, UserPfnArray);
}

NTSTATUS newNtModifyBootEntry(PBOOT_ENTRY BootEntry){
	SyscallInforPrint(MODIFYBOOTENTRY_7_INDEX);
	return ((NTMODIFYBOOTENTRY)(oldNtModifyBootEntry))(BootEntry);
}

NTSTATUS newNtModifyDriverEntry(PEFI_DRIVER_ENTRY DriverEntry){
	SyscallInforPrint(MODIFYDRIVERENTRY_7_INDEX);
	return ((NTMODIFYDRIVERENTRY)(oldNtModifyDriverEntry))(DriverEntry);
}

NTSTATUS newNtNotifyChangeDirectoryFile(HANDLE FileHandle, HANDLE EventHandle OPTIONAL, PIO_APC_ROUTINE ApcRoutine OPTIONAL, PVOID ApcContext OPTIONAL, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG BufferSize, ULONG CompletionFilter, BOOLEAN WatchTree){
	SyscallInforPrint(NOTIFYCHANGEDIRECTORYFILE_7_INDEX);
	return ((NTNOTIFYCHANGEDIRECTORYFILE)(oldNtNotifyChangeDirectoryFile))(FileHandle, EventHandle, ApcRoutine, ApcContext, IoStatusBlock, Buffer, BufferSize, CompletionFilter, WatchTree);
}

NTSTATUS newNtNotifyChangeSession(HANDLE SessionHandle, ULONG ChangeSequenceNumber, PLARGE_INTEGER ChangeTimeStamp, IO_SESSION_EVENT Event, IO_SESSION_STATE NewState, IO_SESSION_STATE PreviousState, PVOID Payload, ULONG PayloadSize){
	SyscallInforPrint(NOTIFYCHANGESESSION_7_INDEX);
	return ((NTNOTIFYCHANGESESSION)(oldNtNotifyChangeSession))(SessionHandle, ChangeSequenceNumber, ChangeTimeStamp, Event, NewState, PreviousState, Payload, PayloadSize);
}

NTSTATUS newNtOpenEnlistment(PHANDLE EnlistmentHandle, ACCESS_MASK  DesiredAccess, HANDLE  RmHandle, LPGUID  EnlistmentGuid, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENENLISTMENT_7_INDEX);
	return ((NTOPENENLISTMENT)(oldNtOpenEnlistment))(EnlistmentHandle, DesiredAccess, RmHandle, EnlistmentGuid, ObjectAttributes);
}

NTSTATUS newNtOpenEventPair(PHANDLE EventPairHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENEVENTPAIR_7_INDEX);
	return ((NTOPENEVENTPAIR)(oldNtOpenEventPair))(EventPairHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenIoCompletion(PHANDLE IoCompletionHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENIOCOMPLETION_7_INDEX);
	return ((NTOPENIOCOMPLETION)(oldNtOpenIoCompletion))(IoCompletionHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenJobObject(PHANDLE JobHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENJOBOBJECT_7_INDEX);
	return ((NTOPENJOBOBJECT)(oldNtOpenJobObject))(JobHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenKeyedEvent(PHANDLE OutHandle, ACCESS_MASK AccessMask, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENKEYEDEVENT_7_INDEX);
	return ((NTOPENKEYEDEVENT)(oldNtOpenKeyedEvent))(OutHandle, AccessMask, ObjectAttributes);
}

NTSTATUS newNtOpenObjectAuditAlarm(PUNICODE_STRING SubsystemName OPTIONAL, PHANDLE ObjectHandle OPTIONAL, PUNICODE_STRING ObjectTypeName OPTIONAL, PUNICODE_STRING ObjectName OPTIONAL, PSECURITY_DESCRIPTOR SecurityDescriptor OPTIONAL, HANDLE ClientToken, ACCESS_MASK DesiredAccess, ACCESS_MASK GrantedAccess, PPRIVILEGE_SET Privileges OPTIONAL, BOOLEAN ObjectCreation, BOOLEAN AccessGranted, PBOOLEAN GenerateOnClose OPTIONAL){
	SyscallInforPrint(OPENOBJECTAUDITALARM_7_INDEX);
	return ((NTOPENOBJECTAUDITALARM)(oldNtOpenObjectAuditAlarm))(SubsystemName, ObjectHandle, ObjectTypeName, ObjectName, SecurityDescriptor, ClientToken, DesiredAccess, GrantedAccess, Privileges, ObjectCreation, AccessGranted, GenerateOnClose);
}

NTSTATUS newNtOpenPrivateNamespace(PHANDLE NamespaceHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PVOID BoundaryDescriptor){
	SyscallInforPrint(OPENPRIVATENAMESPACE_7_INDEX);
	return ((NTOPENPRIVATENAMESPACE)(oldNtOpenPrivateNamespace))(NamespaceHandle, DesiredAccess, ObjectAttributes, BoundaryDescriptor);
}

NTSTATUS newNtOpenProcessToken(HANDLE ProcessHandle, ACCESS_MASK DesiredAccess, PHANDLE TokenHandle){
	SyscallInforPrint(OPENPROCESSTOKEN_7_INDEX);
	return ((NTOPENPROCESSTOKEN)(oldNtOpenProcessToken))(ProcessHandle, DesiredAccess, TokenHandle);
} 

NTSTATUS newNtOpenResourceManager(PHANDLE ResourceManagerHandle, ACCESS_MASK DesiredAccess, HANDLE TmHandle, LPGUID ResourceManagerGuid, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENRESOURCEMANAGER_7_INDEX);
	return ((NTOPENRESOURCEMANAGER)(oldNtOpenResourceManager))(ResourceManagerHandle, DesiredAccess, TmHandle, ResourceManagerGuid, ObjectAttributes);
} 

NTSTATUS newNtOpenSemaphore(PHANDLE SemaphoreHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENSEMAPHORE_7_INDEX);
	return ((NTOPENSEMAPHORE)(oldNtOpenSemaphore))(SemaphoreHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenSession(PHANDLE SessionHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENSESSION_7_INDEX);
	return ((NTOPENSESSION)(oldNtOpenSession))(SessionHandle, DesiredAccess, ObjectAttributes);
} 

NTSTATUS newNtOpenThreadToken(HANDLE ThreadHandle, ACCESS_MASK DesiredAccess, BOOLEAN OpenAsSelf, PHANDLE TokenHandle){
	SyscallInforPrint(OPENTHREADTOKEN_7_INDEX);
	return ((NTOPENTHREADTOKEN)(oldNtOpenThreadToken))(ThreadHandle, DesiredAccess, OpenAsSelf, TokenHandle);
}

NTSTATUS newNtOpenTimer(PHANDLE TimerHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes){
	SyscallInforPrint(OPENTIMER_7_INDEX);
	return ((NTOPENTIMER)(oldNtOpenTimer))(TimerHandle, DesiredAccess, ObjectAttributes);
}

NTSTATUS newNtOpenTransaction(PHANDLE TransactionHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, LPGUID Uow, HANDLE TmHandle){
	SyscallInforPrint(OPENTRANSACTION_7_INDEX);
	return ((NTOPENTRANSACTION)(oldNtOpenTransaction))(TransactionHandle, DesiredAccess, ObjectAttributes, Uow, TmHandle);
}

NTSTATUS newNtOpenTransactionManager(PHANDLE TmHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PUNICODE_STRING LogFileName, LPGUID TmIdentity, ULONG OpenOptions){
	SyscallInforPrint(OPENTRANSACTIONMANAGER_7_INDEX);
	return ((NTOPENTRANSACTIONMANAGER)(oldNtOpenTransactionManager))(TmHandle, DesiredAccess, ObjectAttributes, LogFileName, TmIdentity, OpenOptions);
}

NTSTATUS newNtPlugPlayControl(PLUGPLAY_CONTROL_CLASS PlugPlayControlClass, PVOID Buffer, ULONG BufferLength){
	SyscallInforPrint(PLUGPLAYCONTROL_7_INDEX);
	return ((NTPLUGPLAYCONTROL)(oldNtPlugPlayControl))(PlugPlayControlClass, Buffer, BufferLength);
}

NTSTATUS newNtPrePrepareComplete(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(PREPREPARECOMPLETE_7_INDEX);
	return ((NTPREPREPARECOMPLETE)(oldNtPrePrepareComplete))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtPrePrepareEnlistment(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(PREPREPAREENLISTMENT_7_INDEX);
	return ((NTPREPREPAREENLISTMENT)(oldNtPrePrepareEnlistment))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtPrepareComplete(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(PREPARECOMPLETE_7_INDEX);
	return ((NTPREPARECOMPLETE)(oldNtPrepareComplete))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtPrepareEnlistment(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(PREPAREENLISTMENT_7_INDEX);
	return ((NTPREPAREENLISTMENT)(oldNtPrepareEnlistment))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtPrivilegeCheck(HANDLE TokenHandle, PPRIVILEGE_SET RequiredPrivileges, PBOOLEAN Result){
	Result = PrivilegeDegrade(Result);
	SyscallInforPrint(PRIVILEGECHECK_7_INDEX);
	return ((NTPRIVILEGECHECK)(oldNtPrivilegeCheck))(TokenHandle, RequiredPrivileges, Result);
}

// not in hook.c
NTSTATUS newNtPrivilegeObjectAuditAlarm(PUNICODE_STRING SubsystemName OPTIONAL, HANDLE ObjectHandle OPTIONAL, HANDLE ClientToken, ULONG DesiredAccess, PPRIVILEGE_SET ClientPrivileges, BOOLEAN AccessGranted){
	DbgPrint("PrivilegeObjectAudit result %d \n\n", AccessGranted);
	SyscallInforPrint(PRIVILEGEOBJECTAUDITALARM_7_INDEX);
	return ((NTPRIVILEGEOBJECTAUDITALARM)(oldNtPrivilegeObjectAuditAlarm))(SubsystemName, ObjectHandle, ClientToken, DesiredAccess, ClientPrivileges, AccessGranted);
}
// not in hook.c
NTSTATUS newNtPrivilegedServiceAuditAlarm(PUNICODE_STRING SubsystemName OPTIONAL, PUNICODE_STRING ServiceName OPTIONAL, HANDLE ClientToken, PPRIVILEGE_SET ClientPrivileges, BOOLEAN AccessGranted){
	DbgPrint("PrivilegeServiceAudit result %d \n\n ", AccessGranted);
	SyscallInforPrint(PRIVILEGEDSERVICEAUDITALARM_7_INDEX);
	return ((NTPRIVILEGEDSERVICEAUDITALARM)(oldNtPrivilegedServiceAuditAlarm))(SubsystemName, ServiceName, ClientToken, ClientPrivileges, AccessGranted);
}

NTSTATUS newNtPropagationComplete(HANDLE ResourceManagerHandle, ULONG RequestCookie, ULONG BufferLength, PVOID Buffer){
	SyscallInforPrint(PROPAGATIONCOMPLETE_7_INDEX);
	return ((NTPROPAGATIONCOMPLETE)(oldNtPropagationComplete))(ResourceManagerHandle, RequestCookie, BufferLength, Buffer);
}

NTSTATUS newNtPropagationFailed(HANDLE ResourceManagerHandle, ULONG RequestCookie, NTSTATUS PropStatus){
	SyscallInforPrint(PROPAGATIONFAILED_7_INDEX);
	return ((NTPROPAGATIONFAILED)(oldNtPropagationFailed))(ResourceManagerHandle, RequestCookie, PropStatus);
}

NTSTATUS newNtPulseEvent(HANDLE EventHandle, PLONG PreviousState OPTIONAL){
	SyscallInforPrint(PULSEEVENT_7_INDEX);
	return ((NTPULSEEVENT)(oldNtPulseEvent))(EventHandle, PreviousState);
}

NTSTATUS newNtQueryBootEntryOrder(PULONG Ids, PULONG Count){
	SyscallInforPrint(QUERYBOOTENTRYORDER_7_INDEX);
	return ((NTQUERYBOOTENTRYORDER)(oldNtQueryBootEntryOrder))(Ids, Count);
}

NTSTATUS newNtQueryBootOptions(PBOOT_OPTIONS BootOptions, PULONG BootOptionsLength){
	SyscallInforPrint(QUERYBOOTOPTIONS_7_INDEX);
	return ((NTQUERYBOOTOPTIONS)(oldNtQueryBootOptions))(BootOptions, BootOptionsLength);
}

NTSTATUS newNtQueryDebugFilterState(ULONG ComponentId, ULONG Level){
	SyscallInforPrint(QUERYDEBUGFILTERSTATE_7_INDEX);
	return ((NTQUERYDEBUGFILTERSTATE)(oldNtQueryDebugFilterState))(ComponentId, Level);
}

NTSTATUS newNtQueryDefaultLocale(BOOLEAN UserProfile, PLCID DefaultLocaleId){
	SyscallInforPrint(QUERYDEFAULTLOCALE_7_INDEX);
	return ((NTQUERYDEFAULTLOCALE)(oldNtQueryDefaultLocale))(UserProfile, DefaultLocaleId);
}

NTSTATUS newNtQueryDefaultUILanguage(LANGID* LanguageId){
	SyscallInforPrint(QUERYDEFAULTUILANGUAGE_7_INDEX);
	return ((NTQUERYDEFAULTUILANGUAGE)(oldNtQueryDefaultUILanguage))(LanguageId);
}

NTSTATUS newNtQueryDirectoryObject(HANDLE DirectoryHandle, PVOID Buffer, ULONG Length, BOOLEAN ReturnSingleEntry, BOOLEAN RestartScan, PULONG Context, PULONG ReturnLength){
	SyscallInforPrint(QUERYDIRECTORYOBJECT_7_INDEX);
	return ((NTQUERYDIRECTORYOBJECT)(oldNtQueryDirectoryObject))(DirectoryHandle, Buffer, Length, ReturnSingleEntry, RestartScan, Context, ReturnLength);
}

NTSTATUS newNtQueryDriverEntryOrder(PULONG Ids, PULONG Count){
	SyscallInforPrint(QUERYDRIVERENTRYORDER_7_INDEX);
	return ((NTQUERYDRIVERENTRYORDER)(oldNtQueryDriverEntryOrder))(Ids, Count);
}

NTSTATUS newNtQueryInformationEnlistment(HANDLE EnlistmentHandle, ENLISTMENT_INFORMATION_CLASS EnlistmentInformationClass, PVOID EnlistmentInformation, ULONG EnlistmentInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONENLISTMENT_7_INDEX);
	return ((NTQUERYINFORMATIONENLISTMENT)(oldNtQueryInformationEnlistment))(EnlistmentHandle, EnlistmentInformationClass, EnlistmentInformation, EnlistmentInformationLength, ReturnLength);
}

NTSTATUS newNtQueryInformationJobObject(HANDLE JobHandle, JOBOBJECTINFOCLASS JobInformationClass, PVOID JobInformation, ULONG JobInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONJOBOBJECT_7_INDEX);
	return ((NTQUERYINFORMATIONJOBOBJECT)(oldNtQueryInformationJobObject))(JobHandle, JobInformationClass, JobInformation, JobInformationLength, ReturnLength);
}

NTSTATUS newNtQueryInformationResourceManager(HANDLE ResourceManagerHandle, RESOURCEMANAGER_INFORMATION_CLASS ResourceManagerInformationClass, PVOID ResourceManagerInformation, ULONG ResourceManagerInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONRESOURCEMANAGER_7_INDEX);
	return ((NTQUERYINFORMATIONRESOURCEMANAGER)(oldNtQueryInformationResourceManager))(ResourceManagerHandle, ResourceManagerInformationClass, ResourceManagerInformation, ResourceManagerInformationLength, ReturnLength);
}

NTSTATUS newNtQueryInformationTransaction(HANDLE TransactionHandle, TRANSACTION_INFORMATION_CLASS TransactionInformationClass, PVOID TransactionInformation, ULONG TransactionInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONTRANSACTION_7_INDEX);
	return ((NTQUERYINFORMATIONTRANSACTION)(oldNtQueryInformationTransaction))(TransactionHandle, TransactionInformationClass, TransactionInformation, TransactionInformationLength, ReturnLength);
}

NTSTATUS newNtQueryInformationTransactionManager(HANDLE TransactionManagerHandle, TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass, PVOID TransactionManagerInformation, ULONG TransactionManagerInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONTRANSACTIONMANAGER_7_INDEX);
	return ((NTQUERYINFORMATIONTRANSACTIONMANAGER)(oldNtQueryInformationTransactionManager))(TransactionManagerHandle, TransactionManagerInformationClass, TransactionManagerInformation, TransactionManagerInformationLength, ReturnLength);
}

NTSTATUS newNtQueryInformationWorkerFactory(HANDLE WorkerFactoryHandle, WORKERFACTORYINFOCLASS WorkerFactoryInformationClass, PVOID WorkerFactoryInformation, ULONG WorkerFactoryInformationLength, PULONG ReturnLength){
	SyscallInforPrint(QUERYINFORMATIONWORKERFACTORY_7_INDEX);
	return ((NTQUERYINFORMATIONWORKERFACTORY)(oldNtQueryInformationWorkerFactory))(WorkerFactoryHandle, WorkerFactoryInformationClass, WorkerFactoryInformation, WorkerFactoryInformationLength, ReturnLength);
}

NTSTATUS newNtQueryInstallUILanguage(LANGID* LanguageId){
	SyscallInforPrint(QUERYINSTALLUILANGUAGE_7_INDEX);
	return ((NTQUERYINSTALLUILANGUAGE)(oldNtQueryInstallUILanguage))(LanguageId);
}

NTSTATUS newNtQueryIntervalProfile(KPROFILE_SOURCE ProfileSource, PULONG Interval){
	SyscallInforPrint(QUERYINTERVALPROFILE_7_INDEX);
	return ((NTQUERYINTERVALPROFILE)(oldNtQueryIntervalProfile))(ProfileSource, Interval);
}

NTSTATUS newNtQueryIoCompletion(HANDLE IoCompletionHandle, IO_COMPLETION_INFORMATION_CLASS InformationClass, PVOID IoCompletionInformation, ULONG InformationBufferLength, PULONG RequiredLength OPTIONAL){
	SyscallInforPrint(QUERYIOCOMPLETION_7_INDEX);
	return ((NTQUERYIOCOMPLETION)(oldNtQueryIoCompletion))(IoCompletionHandle, InformationClass, IoCompletionInformation, InformationBufferLength, RequiredLength);
}

NTSTATUS newNtQueryOpenSubKeys(POBJECT_ATTRIBUTES TargetKey, PULONG HandleCount){
	SyscallInforPrint(QUERYOPENSUBKEYS_7_INDEX);
	return ((NTQUERYOPENSUBKEYS)(oldNtQueryOpenSubKeys))(TargetKey, HandleCount);
}

NTSTATUS newNtQueryOpenSubKeysEx(POBJECT_ATTRIBUTES TargetKey, ULONG BufferLength,   PVOID Buffer, PULONG RequiredSize){
	SyscallInforPrint(QUERYOPENSUBKEYSEX_7_INDEX);
	return ((NTQUERYOPENSUBKEYSEX)(oldNtQueryOpenSubKeysEx))(TargetKey, BufferLength, Buffer, RequiredSize);
}

NTSTATUS newNtQuerySection(HANDLE SectionHandle, SECTION_INFORMATION_CLASS InformationClass, PVOID InformationBuffer, ULONG InformationBufferSize, PULONG ResultLength OPTIONAL){
	SyscallInforPrint(QUERYSECTION_7_INDEX);
	return ((NTQUERYSECTION)(oldNtQuerySection))(SectionHandle, InformationClass, InformationBuffer, InformationBufferSize, ResultLength);
}

NTSTATUS newNtQuerySecurityAttributesToken(HANDLE TokenHandle,   PUNICODE_STRING Attributes, ULONG NumberOfAttributes,   PVOID Buffer, ULONG Length, PULONG ReturnLength){
	SyscallInforPrint(QUERYSECURITYATTRIBUTESTOKEN_7_INDEX);
	return ((NTQUERYSECURITYATTRIBUTESTOKEN)(oldNtQuerySecurityAttributesToken))(TokenHandle, Attributes, NumberOfAttributes, Buffer, Length, ReturnLength);
} 

NTSTATUS newNtQuerySemaphore(HANDLE SemaphoreHandle, SEMAPHORE_INFORMATION_CLASS SemaphoreInformationClass, PVOID SemaphoreInformation, ULONG  SemaphoreInformationLength, PULONG ReturnLength OPTIONAL){
	SyscallInforPrint(QUERYSEMAPHORE_7_INDEX);
	return ((NTQUERYSEMAPHORE)(oldNtQuerySemaphore))(SemaphoreHandle, SemaphoreInformationClass, SemaphoreInformation, SemaphoreInformationLength, ReturnLength);
}

NTSTATUS newNtQuerySystemEnvironmentValue(PUNICODE_STRING VariableName, PWCHAR Value, ULONG  ValueBufferLength, PULONG RequiredLength){
	SyscallInforPrint(QUERYSYSTEMENVIRONMENTVALUE_7_INDEX);
	return ((NTQUERYSYSTEMENVIRONMENTVALUE)(oldNtQuerySystemEnvironmentValue))(VariableName, Value, ValueBufferLength, RequiredLength);
}

NTSTATUS newNtQuerySystemEnvironmentValueEx(PUNICODE_STRING VariableName, LPGUID VendorGuid, PVOID Value, PULONG ReturnLength, PULONG Attributes){
	SyscallInforPrint(QUERYSYSTEMENVIRONMENTVALUEEX_7_INDEX);
	return ((NTQUERYSYSTEMENVIRONMENTVALUEEX)(oldNtQuerySystemEnvironmentValueEx))(VariableName, VendorGuid, Value, ReturnLength, Attributes);
}

NTSTATUS newNtQuerySystemInformationEx(SYSTEM_INFORMATION_CLASS SystemInformationClass, PVOID InputBuffer, ULONG InputBufferLength,    PVOID SystemInformation, ULONG SystemInformationLength,   PULONG ReturnLength){
	SyscallInforPrint(QUERYSYSTEMINFORMATIONEX_7_INDEX);
	return ((NTQUERYSYSTEMINFORMATIONEX)(oldNtQuerySystemInformationEx))(SystemInformationClass, InputBuffer, InputBufferLength, SystemInformation, SystemInformationLength, ReturnLength);
}

NTSTATUS newNtQueryTimer(HANDLE TimerHandle, TIMER_INFORMATION_CLASS TimerInformationClass, PVOID TimerInformation, ULONG Length, PULONG  ReturnLength){
	SyscallInforPrint(QUERYTIMER_7_INDEX);
	return ((NTQUERYTIMER)(oldNtQueryTimer))(TimerHandle, TimerInformationClass, TimerInformation, Length, ReturnLength);
}

NTSTATUS newNtRaiseException(PEXCEPTION_RECORD ExceptionRecord, PCONTEXT Context, BOOLEAN FirstChance){
	SyscallInforPrint(RAISEEXCEPTION_7_INDEX);
	return ((NTRAISEEXCEPTION)(oldNtRaiseException))(ExceptionRecord, Context, FirstChance);
}

NTSTATUS newNtRaiseHardError(NTSTATUS ErrorStatus, ULONG  NumberOfParameters, PUNICODE_STRING UnicodeStringParameterMask OPTIONAL, PVOID *Parameters, HARDERROR_RESPONSE_OPTION ResponseOption, PHARDERROR_RESPONSE Response){
	SyscallInforPrint(RAISEHARDERROR_7_INDEX);
	return ((NTRAISEHARDERROR)(oldNtRaiseHardError))(ErrorStatus, NumberOfParameters, UnicodeStringParameterMask, Parameters, ResponseOption, Response);
}

NTSTATUS newNtReadFileScatter(HANDLE FileHandle, HANDLE Event OPTIONAL, PIO_APC_ROUTINE ApcRoutine OPTIONAL, PVOID ApcContext OPTIONAL, PIO_STATUS_BLOCK IoStatusBlock, FILE_SEGMENT_ELEMENT SegmentArray, ULONG  Length, PLARGE_INTEGER ByteOffset, PULONG Key OPTIONAL){
	SyscallInforPrint(READFILESCATTER_7_INDEX);
	return ((NTREADFILESCATTER)(oldNtReadFileScatter))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, SegmentArray, Length, ByteOffset, Key);
}

NTSTATUS newNtReadOnlyEnlistment(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(READONLYENLISTMENT_7_INDEX);
	return ((NTREADONLYENLISTMENT)(oldNtReadOnlyEnlistment))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtRecoverEnlistment(HANDLE EnlistmentHandle, PVOID EnlistmentKey){
	SyscallInforPrint(RECOVERENLISTMENT_7_INDEX);
	return ((NTRECOVERENLISTMENT)(oldNtRecoverEnlistment))(EnlistmentHandle, EnlistmentKey);
}

NTSTATUS newNtRecoverResourceManager(HANDLE ResourceManagerHandle){
	SyscallInforPrint(RECOVERRESOURCEMANAGER_7_INDEX);
	return ((NTRECOVERRESOURCEMANAGER)(oldNtRecoverResourceManager))(ResourceManagerHandle);
}

NTSTATUS newNtRecoverTransactionManager(HANDLE TransactionManagerHandle){
	SyscallInforPrint(RECOVERTRANSACTIONMANAGER_7_INDEX);
	return ((NTRECOVERTRANSACTIONMANAGER)(oldNtRecoverTransactionManager))(TransactionManagerHandle);
}

NTSTATUS newNtRegisterProtocolAddressInformation(HANDLE ResourceManager, PCRM_PROTOCOL_ID ProtocolId, ULONG ProtocolInformationSize, PVOID ProtocolInformation, ULONG CreateOptions){
	SyscallInforPrint(REGISTERPROTOCOLADDRESSINFORMATION_7_INDEX);
	return ((NTREGISTERPROTOCOLADDRESSINFORMATION)(oldNtRegisterProtocolAddressInformation))(ResourceManager, ProtocolId, ProtocolInformationSize, ProtocolInformation, CreateOptions);
}

NTSTATUS newNtReleaseKeyedEvent(HANDLE Handle, PVOID Key, BOOLEAN Alertable, PLARGE_INTEGER Timeout){
	SyscallInforPrint(RELEASEKEYEDEVENT_7_INDEX);
	return ((NTRELEASEKEYEDEVENT)(oldNtReleaseKeyedEvent))(Handle, Key, Alertable, Timeout);
}

NTSTATUS newNtReleaseSemaphore(HANDLE SemaphoreHandle, ULONG ReleaseCount, PULONG PreviousCount OPTIONAL){
	SyscallInforPrint(RELEASESEMAPHORE_7_INDEX);
	return ((NTRELEASESEMAPHORE)(oldNtReleaseSemaphore))(SemaphoreHandle, ReleaseCount, PreviousCount);
}

NTSTATUS newNtRemoveIoCompletion(HANDLE IoCompletionHandle, PULONG CompletionKey, PULONG CompletionValue, PIO_STATUS_BLOCK IoStatusBlock, PLARGE_INTEGER Timeout){
	SyscallInforPrint(REMOVEIOCOMPLETION_7_INDEX);
	return ((NTREMOVEIOCOMPLETION)(oldNtRemoveIoCompletion))(IoCompletionHandle, CompletionKey, CompletionValue, IoStatusBlock, Timeout);
}

NTSTATUS newNtRemoveProcessDebug(HANDLE ProcessHandle, HANDLE DebugObjectHandle){
	SyscallInforPrint(REMOVEPROCESSDEBUG_7_INDEX);
	return ((NTREMOVEPROCESSDEBUG)(oldNtRemoveProcessDebug))(ProcessHandle, DebugObjectHandle);
} 

NTSTATUS newNtRenameTransactionManager(PUNICODE_STRING LogFileName, LPGUID ExistingTransactionManagerGuid){
	SyscallInforPrint(RENAMETRANSACTIONMANAGER_7_INDEX);
	return ((NTRENAMETRANSACTIONMANAGER)(oldNtRenameTransactionManager))(LogFileName, ExistingTransactionManagerGuid);
}

NTSTATUS newNtReplaceKey(POBJECT_ATTRIBUTES NewHiveFileName, HANDLE KeyHandle, POBJECT_ATTRIBUTES  BackupHiveFileName){
	SyscallInforPrint(REPLACEKEY_7_INDEX);
	return ((NTREPLACEKEY)(oldNtReplaceKey))(NewHiveFileName, KeyHandle, BackupHiveFileName);
}

NTSTATUS newNtReplacePartitionUnit(PUNICODE_STRING TargetInstancePath, PUNICODE_STRING SpareInstancePath, ULONG Flags){
	SyscallInforPrint(REPLACEPARTITIONUNIT_7_INDEX);
	return ((NTREPLACEPARTITIONUNIT)(oldNtReplacePartitionUnit))(TargetInstancePath, SpareInstancePath, Flags);
}

NTSTATUS newNtReplyWaitReceivePortEx(HANDLE PortHandle, PVOID *PortContext, PPORT_MESSAGE ReplyMessage, PPORT_MESSAGE ReceiveMessage, PLARGE_INTEGER Timeout){
	SyscallInforPrint(REPLYWAITRECEIVEPORTEX_7_INDEX);
	return ((NTREPLYWAITRECEIVEPORTEX)(oldNtReplyWaitReceivePortEx))(PortHandle, PortContext, ReplyMessage, ReceiveMessage, Timeout);
}

NTSTATUS newNtResetEvent(HANDLE EventHandle, PLONG PreviousState OPTIONAL){
	SyscallInforPrint(RESETEVENT_7_INDEX);
	return ((NTRESETEVENT)(oldNtResetEvent))(EventHandle, PreviousState);
}

NTSTATUS newNtResetWriteWatch(HANDLE ProcessHandle, PVOID BaseAddress, SIZE_T RegionSize){
	SyscallInforPrint(RESETWRITEWATCH_7_INDEX);
	return ((NTRESETWRITEWATCH)(oldNtResetWriteWatch))(ProcessHandle, BaseAddress, RegionSize);
}

NTSTATUS newNtRestoreKey(HANDLE KeyHandle, HANDLE FileHandle, ULONG RestoreOption){
	SyscallInforPrint(RESTOREKEY_7_INDEX);
	return ((NTRESTOREKEY)(oldNtRestoreKey))(KeyHandle, FileHandle, RestoreOption);
}

NTSTATUS newNtResumeProcess(HANDLE ProcessHandle){
	SyscallInforPrint(RESUMEPROCESS_7_INDEX);
	return ((NTRESUMEPROCESS)(oldNtResumeProcess))(ProcessHandle);
}

NTSTATUS newNtRollbackComplete(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(ROLLBACKCOMPLETE_7_INDEX);
	return ((NTROLLBACKCOMPLETE)(oldNtRollbackComplete))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtRollbackEnlistment(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(ROLLBACKENLISTMENT_7_INDEX);
	return ((NTROLLBACKENLISTMENT)(oldNtRollbackEnlistment))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtRollbackTransaction(HANDLE TransactionHandle, BOOLEAN Wait){
	SyscallInforPrint(ROLLBACKTRANSACTION_7_INDEX);
	return ((NTROLLBACKTRANSACTION)(oldNtRollbackTransaction))(TransactionHandle, Wait);
}

NTSTATUS newNtRollforwardTransactionManager(HANDLE TransactionManagerHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(ROLLFORWARDTRANSACTIONMANAGER_7_INDEX);
	return ((NTROLLFORWARDTRANSACTIONMANAGER)(oldNtRollforwardTransactionManager))(TransactionManagerHandle, TmVirtualClock);
}

NTSTATUS newNtSaveKey(HANDLE KeyHandle, HANDLE FileHandle){
	SyscallInforPrint(SAVEKEY_7_INDEX);
	return ((NTSAVEKEY)(oldNtSaveKey))(KeyHandle, FileHandle);
}

NTSTATUS newNtSaveKeyEx(HANDLE KeyHandle, HANDLE FileHandle, ULONG Flags){
	SyscallInforPrint(SAVEKEYEX_7_INDEX);
	return ((NTSAVEKEYEX)(oldNtSaveKeyEx))(KeyHandle, FileHandle, Flags);
} 

NTSTATUS newNtSaveMergedKeys(HANDLE HighPrecedenceKeyHandle, HANDLE LowPrecedenceKeyHandle, HANDLE FileHandle){
	SyscallInforPrint(SAVEMERGEDKEYS_7_INDEX);
	return ((NTSAVEMERGEDKEYS)(oldNtSaveMergedKeys))(HighPrecedenceKeyHandle, LowPrecedenceKeyHandle, FileHandle);
}

NTSTATUS newNtSecureConnectPort(PHANDLE PortHandle, PUNICODE_STRING PortName, PSECURITY_QUALITY_OF_SERVICE SecurityQos, PPORT_VIEW ClientView, PSID RequiredServerSid, PREMOTE_PORT_VIEW ServerView,   PULONG MaxMessageLength,   PVOID ConnectionInformation, PULONG ConnectionInformationLength){
	SyscallInforPrint(SECURECONNECTPORT_7_INDEX);
	return ((NTSECURECONNECTPORT)(oldNtSecureConnectPort))(PortHandle, PortName, SecurityQos, ClientView, RequiredServerSid, ServerView, MaxMessageLength, ConnectionInformation, ConnectionInformationLength);
}

NTSTATUS newNtSerializeBoot(VOID){
	SyscallInforPrint(SERIALIZEBOOT_7_INDEX);
	return ((NTSERIALIZEBOOT)(oldNtSerializeBoot))();
}

NTSTATUS newNtSetBootEntryOrder(PULONG Ids, PULONG Count){
	SyscallInforPrint(SETBOOTENTRYORDER_7_INDEX);
	return ((NTSETBOOTENTRYORDER)(oldNtSetBootEntryOrder))(Ids, Count);
}

NTSTATUS newNtSetBootOptions(PBOOT_OPTIONS BootOptions, ULONG FieldsToChange){
	SyscallInforPrint(SETBOOTOPTIONS_7_INDEX);
	return ((NTSETBOOTOPTIONS)(oldNtSetBootOptions))(BootOptions, FieldsToChange);
}

NTSTATUS newNtSetDebugFilterState(ULONG ComponentId, ULONG Level, BOOLEAN State){
	SyscallInforPrint(SETDEBUGFILTERSTATE_7_INDEX);
	return ((NTSETDEBUGFILTERSTATE)(oldNtSetDebugFilterState))(ComponentId, Level, State);
}

NTSTATUS newNtSetDefaultHardErrorPort(HANDLE PortHandle){
	SyscallInforPrint(SETDEFAULTHARDERRORPORT_7_INDEX);
	return ((NTSETDEFAULTHARDERRORPORT)(oldNtSetDefaultHardErrorPort))(PortHandle);
}

NTSTATUS newNtSetDefaultLocale(BOOLEAN UserProfile, LCID DefaultLocaleId){
	SyscallInforPrint(SETDEFAULTLOCALE_7_INDEX);
	return ((NTSETDEFAULTLOCALE)(oldNtSetDefaultLocale))(UserProfile, DefaultLocaleId);
}

NTSTATUS newNtSetDefaultUILanguage(LANGID LanguageId){
	SyscallInforPrint(SETDEFAULTUILANGUAGE_7_INDEX);
	return ((NTSETDEFAULTUILANGUAGE)(oldNtSetDefaultUILanguage))(LanguageId);
}

NTSTATUS newNtSetDriverEntryOrder(PULONG Ids, PULONG Count){
	SyscallInforPrint(SETDRIVERENTRYORDER_7_INDEX);
	return ((NTSETDRIVERENTRYORDER)(oldNtSetDriverEntryOrder))(Ids, Count);
}

NTSTATUS newNtSetEventBoostPriority(HANDLE EventHandle){
	SyscallInforPrint(SETEVENTBOOSTPRIORITY_7_INDEX);
	return ((NTSETEVENTBOOSTPRIORITY)(oldNtSetEventBoostPriority))(EventHandle);
}

NTSTATUS newNtSetHighEventPair(HANDLE EventPairHandle){
	SyscallInforPrint(SETHIGHEVENTPAIR_7_INDEX);
	return ((NTSETHIGHEVENTPAIR)(oldNtSetHighEventPair))(EventPairHandle);
}

NTSTATUS newNtSetHighWaitLowEventPair(HANDLE EventPairHandle){
	SyscallInforPrint(SETHIGHWAITLOWEVENTPAIR_7_INDEX);
	return ((NTSETHIGHWAITLOWEVENTPAIR)(oldNtSetHighWaitLowEventPair))(EventPairHandle);
}

NTSTATUS newNtSetInformationDebugObject(HANDLE DebugObjectHandle, DEBUGOBJECTINFOCLASS DebugObjectInformationClass, PVOID DebugInformation, ULONG DebugInformationLength, PULONG ReturnLength){
	SyscallInforPrint(SETINFORMATIONDEBUGOBJECT_7_INDEX);
	return ((NTSETINFORMATIONDEBUGOBJECT)(oldNtSetInformationDebugObject))(DebugObjectHandle, DebugObjectInformationClass, DebugInformation, DebugInformationLength, ReturnLength);
}

NTSTATUS newNtSetInformationEnlistment(HANDLE EnlistmentHandle, ENLISTMENT_INFORMATION_CLASS EnlistmentInformationClass, PVOID EnlistmentInformation, ULONG EnlistmentInformationLength){
	SyscallInforPrint(SETINFORMATIONENLISTMENT_7_INDEX);
	return ((NTSETINFORMATIONENLISTMENT)(oldNtSetInformationEnlistment))(EnlistmentHandle, EnlistmentInformationClass, EnlistmentInformation, EnlistmentInformationLength);
}

NTSTATUS newNtSetInformationJobObject(HANDLE JobHandle, JOBOBJECTINFOCLASS JobInformationClass, PVOID JobInformation, ULONG JobInformationLength){
	SyscallInforPrint(SETINFORMATIONJOBOBJECT_7_INDEX);
	return ((NTSETINFORMATIONJOBOBJECT)(oldNtSetInformationJobObject))(JobHandle, JobInformationClass, JobInformation, JobInformationLength);
}

NTSTATUS newNtSetInformationObject(HANDLE ObjectHandle, OBJECT_INFORMATION_CLASS ObjectInformationClass, PVOID ObjectInformation, ULONG Length){
	SyscallInforPrint(SETINFORMATIONOBJECT_7_INDEX);
	return ((NTSETINFORMATIONOBJECT)(oldNtSetInformationObject))(ObjectHandle, ObjectInformationClass, ObjectInformation, Length);
}

NTSTATUS newNtSetInformationResourceManager(HANDLE ResourceManagerHandle, RESOURCEMANAGER_INFORMATION_CLASS ResourceManagerInformationClass, PVOID ResourceManagerInformation, ULONG ResourceManagerInformationLength){
	SyscallInforPrint(SETINFORMATIONRESOURCEMANAGER_7_INDEX);
	return ((NTSETINFORMATIONRESOURCEMANAGER)(oldNtSetInformationResourceManager))(ResourceManagerHandle, ResourceManagerInformationClass, ResourceManagerInformation, ResourceManagerInformationLength);
}

NTSTATUS newNtSetInformationTransaction(HANDLE TransactionHandle, TRANSACTION_INFORMATION_CLASS TransactionInformationClass, PVOID TransactionInformation, ULONG TransactionInformationLength){
	SyscallInforPrint(SETINFORMATIONTRANSACTION_7_INDEX);
	return ((NTSETINFORMATIONTRANSACTION)(oldNtSetInformationTransaction))(TransactionHandle, TransactionInformationClass, TransactionInformation, TransactionInformationLength);
}

NTSTATUS newNtSetInformationTransactionManager(HANDLE TmHandle, TRANSACTIONMANAGER_INFORMATION_CLASS TransactionManagerInformationClass,  PVOID TransactionManagerInformation, ULONG TransactionManagerInformationLength){
	SyscallInforPrint(SETINFORMATIONTRANSACTIONMANAGER_7_INDEX);
	return ((NTSETINFORMATIONTRANSACTIONMANAGER)(oldNtSetInformationTransactionManager))(TmHandle, TransactionManagerInformationClass, TransactionManagerInformation, TransactionManagerInformationLength);
} 

NTSTATUS newNtSetInformationWorkerFactory(HANDLE WorkerFactoryHandle, WORKERFACTORYINFOCLASS WorkerFactoryInformationClass, PVOID WorkerFactoryInformation, ULONG WorkerFactoryInformationLength){
	SyscallInforPrint(SETINFORMATIONWORKERFACTORY_7_INDEX);
	return ((NTSETINFORMATIONWORKERFACTORY)(oldNtSetInformationWorkerFactory))(WorkerFactoryHandle, WorkerFactoryInformationClass, WorkerFactoryInformation, WorkerFactoryInformationLength);
}

NTSTATUS newNtSetIntervalProfile(ULONG Interval, KPROFILE_SOURCE Source){
	SyscallInforPrint(SETINTERVALPROFILE_7_INDEX);
	return ((NTSETINTERVALPROFILE)(oldNtSetIntervalProfile))(Interval, Source);
}

NTSTATUS newNtSetIoCompletion(HANDLE IoCompletionHandle, ULONG  CompletionKey, PIO_STATUS_BLOCK IoStatusBlock, NTSTATUS  CompletionStatus, ULONG  NumberOfBytesTransfered){
	SyscallInforPrint(SETIOCOMPLETION_7_INDEX);
	return ((NTSETIOCOMPLETION)(oldNtSetIoCompletion))(IoCompletionHandle, CompletionKey, IoStatusBlock, CompletionStatus, NumberOfBytesTransfered);
}

NTSTATUS newNtSetLdtEntries(ULONG Selector1, LDT_ENTRY LdtEntry1, ULONG Selector2, LDT_ENTRY LdtEntry2){
	SyscallInforPrint(SETLDTENTRIES_7_INDEX);
	return ((NTSETLDTENTRIES)(oldNtSetLdtEntries))(Selector1, LdtEntry1, Selector2, LdtEntry2);
}

NTSTATUS newNtSetLowEventPair(HANDLE EventPairHandle){
	SyscallInforPrint(SETLOWEVENTPAIR_7_INDEX);
	return ((NTSETLOWEVENTPAIR)(oldNtSetLowEventPair))(EventPairHandle);
}

NTSTATUS newNtSetLowWaitHighEventPair(HANDLE EventPairHandle){
	SyscallInforPrint(SETLOWWAITHIGHEVENTPAIR_7_INDEX);
	return ((NTSETLOWWAITHIGHEVENTPAIR)(oldNtSetLowWaitHighEventPair))(EventPairHandle);
}

NTSTATUS newNtSetSystemEnvironmentValue(PUNICODE_STRING VariableName, PUNICODE_STRING Value){
	SyscallInforPrint(SETSYSTEMENVIRONMENTVALUE_7_INDEX);
	return ((NTSETSYSTEMENVIRONMENTVALUE)(oldNtSetSystemEnvironmentValue))(VariableName, Value);
}

NTSTATUS newNtSetSystemEnvironmentValueEx(PUNICODE_STRING VariableName, LPGUID VendorGuid, PVOID Value, PULONG ReturnLength, PULONG Attributes){
	SyscallInforPrint(SETSYSTEMENVIRONMENTVALUEEX_7_INDEX);
	return ((NTSETSYSTEMENVIRONMENTVALUEEX)(oldNtSetSystemEnvironmentValueEx))(VariableName, VendorGuid, Value, ReturnLength, Attributes);
}

NTSTATUS newNtSetSystemInformation(SYSTEM_INFORMATION_CLASS SystemInformationClass, PVOID SystemInformation, ULONG SystemInformationLength){
	SyscallInforPrint(SETSYSTEMINFORMATION_7_INDEX);
	return ((NTSETSYSTEMINFORMATION)(oldNtSetSystemInformation))(SystemInformationClass, SystemInformation, SystemInformationLength);
}

NTSTATUS newNtSetSystemPowerState(POWER_ACTION SystemAction, SYSTEM_POWER_STATE LightestSystemState, ULONG Flags){
	SyscallInforPrint(SETSYSTEMPOWERSTATE_7_INDEX);
	return ((NTSETSYSTEMPOWERSTATE)(oldNtSetSystemPowerState))(SystemAction, LightestSystemState, Flags);
}

NTSTATUS newNtSetThreadExecutionState(EXECUTION_STATE NewFlags, EXECUTION_STATE * PreviousFlags){
	SyscallInforPrint(SETTHREADEXECUTIONSTATE_7_INDEX);
	return ((NTSETTHREADEXECUTIONSTATE)(oldNtSetThreadExecutionState))(NewFlags, PreviousFlags);
}

NTSTATUS newNtSetTimer(HANDLE TimerHandle, PLARGE_INTEGER DueTime, PTIMER_APC_ROUTINE TimerApcRoutine OPTIONAL, PVOID TimerContext OPTIONAL, BOOLEAN ResumeTimer, LONG Period OPTIONAL, PBOOLEAN PreviousState OPTIONAL){
	SyscallInforPrint(SETTIMER_7_INDEX);
	return ((NTSETTIMER)(oldNtSetTimer))(TimerHandle, DueTime, TimerApcRoutine, TimerContext, ResumeTimer, Period, PreviousState);
}

NTSTATUS newNtSetUuidSeed(PUCHAR Seed){
	SyscallInforPrint(SETUUIDSEED_7_INDEX);
	return ((NTSETUUIDSEED)(oldNtSetUuidSeed))(Seed);
}

NTSTATUS newNtShutdownSystem(SHUTDOWN_ACTION Action){
	SyscallInforPrint(SHUTDOWNSYSTEM_7_INDEX);
	return ((NTSHUTDOWNSYSTEM)(oldNtShutdownSystem))(Action);
}

NTSTATUS newNtShutdownWorkerFactory(HANDLE WorkerFactoryHandle, volatile LONG *PendingWorkerCount){
	SyscallInforPrint(SHUTDOWNWORKERFACTORY_7_INDEX);
	return ((NTSHUTDOWNWORKERFACTORY)(oldNtShutdownWorkerFactory))(WorkerFactoryHandle, PendingWorkerCount);
}

NTSTATUS newNtSignalAndWaitForSingleObject(HANDLE ObjectToSignal, HANDLE WaitableObject, BOOLEAN Alertable, PLARGE_INTEGER Time OPTIONAL){
	SyscallInforPrint(SIGNALANDWAITFORSINGLEOBJECT_7_INDEX);
	return ((NTSIGNALANDWAITFORSINGLEOBJECT)(oldNtSignalAndWaitForSingleObject))(ObjectToSignal, WaitableObject, Alertable, Time);
}

NTSTATUS newNtSinglePhaseReject(HANDLE EnlistmentHandle, PLARGE_INTEGER TmVirtualClock){
	SyscallInforPrint(SINGLEPHASEREJECT_7_INDEX);
	return ((NTSINGLEPHASEREJECT)(oldNtSinglePhaseReject))(EnlistmentHandle, TmVirtualClock);
}

NTSTATUS newNtStartProfile(HANDLE ProfileHandle){
	SyscallInforPrint(STARTPROFILE_7_INDEX);
	return ((NTSTARTPROFILE)(oldNtStartProfile))(ProfileHandle);
}

NTSTATUS newNtStopProfile(HANDLE ProfileHandle){
	SyscallInforPrint(STOPPROFILE_7_INDEX);
	return ((NTSTOPPROFILE)(oldNtStopProfile))(ProfileHandle);
}

NTSTATUS newNtSuspendProcess(HANDLE ProcessHandle){
	SyscallInforPrint(SUSPENDPROCESS_7_INDEX);
	return ((NTSUSPENDPROCESS)(oldNtSuspendProcess))(ProcessHandle);
}

NTSTATUS newNtTerminateJobObject(HANDLE JobHandle, NTSTATUS ExitStatus){
	SyscallInforPrint(TERMINATEJOBOBJECT_7_INDEX);
	return ((NTTERMINATEJOBOBJECT)(oldNtTerminateJobObject))(JobHandle, ExitStatus);
}

NTSTATUS newNtTestAlert(VOID){
	SyscallInforPrint(TESTALERT_7_INDEX);
	return ((NTTESTALERT)(oldNtTestAlert))();
}

NTSTATUS newNtThawRegistry(VOID){
	SyscallInforPrint(THAWREGISTRY_7_INDEX);
	return ((NTTHAWREGISTRY)(oldNtThawRegistry))();
}

NTSTATUS newNtThawTransactions(VOID){
	SyscallInforPrint(THAWTRANSACTIONS_7_INDEX);
	return ((NTTHAWTRANSACTIONS)(oldNtThawTransactions))();
}

NTSTATUS newNtTraceControl(ULONG FunctionCode, PVOID InBuffer, ULONG InBufferLen,  PVOID OutBuffer, ULONG OutBufferLen, PULONG ReturnLength){
	SyscallInforPrint(TRACECONTROL_7_INDEX);
	return ((NTTRACECONTROL)(oldNtTraceControl))(FunctionCode, InBuffer, InBufferLen, OutBuffer, OutBufferLen, ReturnLength);
}

NTSTATUS newNtTraceEvent(HANDLE TraceHandle, ULONG Flags, ULONG FieldSize, PVOID Fields){
	SyscallInforPrint(TRACEEVENT_7_INDEX);
	return ((NTTRACEEVENT)(oldNtTraceEvent))(TraceHandle, Flags, FieldSize, Fields);
}

NTSTATUS newNtTranslateFilePath(PFILE_PATH InputFilePath, ULONG OutputType, PFILE_PATH OutputFilePath, ULONG OutputFilePathLength){
	SyscallInforPrint(TRANSLATEFILEPATH_7_INDEX);
	return ((NTTRANSLATEFILEPATH)(oldNtTranslateFilePath))(InputFilePath, OutputType, OutputFilePath, OutputFilePathLength);
}

NTSTATUS newNtUmsThreadYield(PVOID SchedulerParam){
	SyscallInforPrint(UMSTHREADYIELD_7_INDEX);
	return ((NTUMSTHREADYIELD)(oldNtUmsThreadYield))(SchedulerParam);
}

NTSTATUS newNtUnloadKey(POBJECT_ATTRIBUTES DestinationKeyName){
	SyscallInforPrint(UNLOADKEY_7_INDEX);
	return ((NTUNLOADKEY)(oldNtUnloadKey))(DestinationKeyName);
}

NTSTATUS newNtUnloadKey2(POBJECT_ATTRIBUTES TargetKey, ULONG Flags){
	SyscallInforPrint(UNLOADKEY2_7_INDEX);
	return ((NTUNLOADKEY2)(oldNtUnloadKey2))(TargetKey, Flags);
}

NTSTATUS newNtUnloadKeyEx(POBJECT_ATTRIBUTES TargetKey, HANDLE Event){
	SyscallInforPrint(UNLOADKEYEX_7_INDEX);
	return ((NTUNLOADKEYEX)(oldNtUnloadKeyEx))(TargetKey, Event);
}

NTSTATUS newNtVdmControl(VDMSERVICECLASS Service, PVOID ServiceData){
	SyscallInforPrint(VDMCONTROL_7_INDEX);
	return ((NTVDMCONTROL)(oldNtVdmControl))(Service, ServiceData);
}

NTSTATUS newNtWaitForDebugEvent(HANDLE DebugObjectHandle, BOOLEAN Alertable, PLARGE_INTEGER Timeout, PVOID WaitStateChange){
	SyscallInforPrint(WAITFORDEBUGEVENT_7_INDEX);
	return ((NTWAITFORDEBUGEVENT)(oldNtWaitForDebugEvent))(DebugObjectHandle, Alertable, Timeout, WaitStateChange);
}

NTSTATUS newNtWaitForKeyedEvent(HANDLE KeyedEvent, const void* NextEvent, BOOLEAN Recursive, const LARGE_INTEGER* TimeOut){
	SyscallInforPrint(WAITFORKEYEDEVENT_7_INDEX);
	return ((NTWAITFORKEYEDEVENT)(oldNtWaitForKeyedEvent))(KeyedEvent, NextEvent, Recursive, TimeOut);
}

NTSTATUS newNtWaitForMultipleObjects(ULONG ObjectCount, PHANDLE HandleArray, WAIT_TYPE WaitType, BOOLEAN Alertable, PLARGE_INTEGER TimeOut OPTIONAL){
	SyscallInforPrint(WAITFORMULTIPLEOBJECTS_7_INDEX);
	return ((NTWAITFORMULTIPLEOBJECTS)(oldNtWaitForMultipleObjects))(ObjectCount, HandleArray, WaitType, Alertable, TimeOut);
}

NTSTATUS newNtWaitForMultipleObjects32(ULONG ObjectCount, PLONG Handles, WAIT_TYPE WaitType, BOOLEAN Alertable, PLARGE_INTEGER TimeOut OPTIONAL){
	SyscallInforPrint(WAITFORMULTIPLEOBJECTS32_7_INDEX);
	return ((NTWAITFORMULTIPLEOBJECTS32)(oldNtWaitForMultipleObjects32))(ObjectCount, Handles, WaitType, Alertable, TimeOut);
}

NTSTATUS newNtWaitLowEventPair(HANDLE EventPairHandle){
	SyscallInforPrint(WAITLOWEVENTPAIR_7_INDEX);
	return ((NTWAITLOWEVENTPAIR)(oldNtWaitLowEventPair))(EventPairHandle);
}

NTSTATUS newNtWorkerFactoryWorkerReady(HANDLE WorkerFactoryHandle){
	SyscallInforPrint(WORKERFACTORYWORKERREADY_7_INDEX);
	return ((NTWORKERFACTORYWORKERREADY)(oldNtWorkerFactoryWorkerReady))(WorkerFactoryHandle);
}

NTSTATUS newNtWriteFileGather(HANDLE FileHandle, HANDLE Event OPTIONAL, PIO_APC_ROUTINE ApcRoutine OPTIONAL, PVOID ApcContext OPTIONAL, PIO_STATUS_BLOCK IoStatusBlock, FILE_SEGMENT_ELEMENT SegmentArray, ULONG Length, PLARGE_INTEGER ByteOffset, PULONG Key OPTIONAL){
	SyscallInforPrint(WRITEFILEGATHER_7_INDEX);
	return ((NTWRITEFILEGATHER)(oldNtWriteFileGather))(FileHandle, Event, ApcRoutine, ApcContext, IoStatusBlock, SegmentArray, Length, ByteOffset, Key);
}

NTSTATUS newNtYieldExecution(VOID){
	SyscallInforPrint(YIELDEXECUTION_7_INDEX);
	return ((NTYIELDEXECUTION)(oldNtYieldExecution))();
}


// disable WP bit of CR0 register : http://en.wikipedia.org/wiki/Control_register#CR0
void disable_cr0()
{
	__asm
	{
		push eax
		mov eax, CR0
		and eax, 0FFFEFFFFh
		mov CR0, eax
		pop eax
	}

}

// enable WP bit of CR0 register
void enable_cr0()
{
	__asm
	{
		push eax
		mov eax, CR0
		or eax, NOT 0FFFEFFFFh
		mov CR0, eax
		pop eax
	}
}


